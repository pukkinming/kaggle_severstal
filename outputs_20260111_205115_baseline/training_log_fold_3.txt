================================================================================
CONFIGURATION
================================================================================
Data root: /home/frank/Dropbox/Project/kaggle_severstal/input/
Output dir: outputs_20260112_125941
Model: unet with resnet18 encoder
Num classes: 4
Num folds: 5
Num epochs: 25
Batch size: 4 (effective: 4)
Learning rate: 0.0005
Optimizer: adam
Loss: bce_with_logits
Scheduler: reduce_on_plateau
Seed: 69
================================================================================

Using device: cuda:0
Fold 3: Train samples = 10055, Val samples = 2513

################################################################################
# Starting training for Fold 3
# Output directory: outputs_20260112_125941/fold_3
################################################################################


================================================================================
Fold 3 | Epoch 1/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.4127
  Batch [100/2514] | Loss: 0.2786
  Batch [150/2514] | Loss: 0.2128
  Batch [200/2514] | Loss: 0.1736
  Batch [250/2514] | Loss: 0.1465
  Batch [300/2514] | Loss: 0.1288
  Batch [350/2514] | Loss: 0.1151
  Batch [400/2514] | Loss: 0.1048
  Batch [450/2514] | Loss: 0.0980
  Batch [500/2514] | Loss: 0.0908
  Batch [550/2514] | Loss: 0.0855
  Batch [600/2514] | Loss: 0.0815
  Batch [650/2514] | Loss: 0.0777
  Batch [700/2514] | Loss: 0.0740
  Batch [750/2514] | Loss: 0.0714
  Batch [800/2514] | Loss: 0.0686
  Batch [850/2514] | Loss: 0.0658
  Batch [900/2514] | Loss: 0.0638
  Batch [950/2514] | Loss: 0.0617
  Batch [1000/2514] | Loss: 0.0598
  Batch [1050/2514] | Loss: 0.0586
  Batch [1100/2514] | Loss: 0.0575
  Batch [1150/2514] | Loss: 0.0564
  Batch [1200/2514] | Loss: 0.0552
  Batch [1250/2514] | Loss: 0.0541
  Batch [1300/2514] | Loss: 0.0534
  Batch [1350/2514] | Loss: 0.0525
  Batch [1400/2514] | Loss: 0.0518
  Batch [1450/2514] | Loss: 0.0512
  Batch [1500/2514] | Loss: 0.0504
  Batch [1550/2514] | Loss: 0.0497
  Batch [1600/2514] | Loss: 0.0491
  Batch [1650/2514] | Loss: 0.0484
  Batch [1700/2514] | Loss: 0.0480
  Batch [1750/2514] | Loss: 0.0474
  Batch [1800/2514] | Loss: 0.0468
  Batch [1850/2514] | Loss: 0.0463
  Batch [1900/2514] | Loss: 0.0457
  Batch [1950/2514] | Loss: 0.0453
  Batch [2000/2514] | Loss: 0.0447
  Batch [2050/2514] | Loss: 0.0441
  Batch [2100/2514] | Loss: 0.0436
  Batch [2150/2514] | Loss: 0.0431
  Batch [2200/2514] | Loss: 0.0426
  Batch [2250/2514] | Loss: 0.0420
  Batch [2300/2514] | Loss: 0.0418
  Batch [2350/2514] | Loss: 0.0416
  Batch [2400/2514] | Loss: 0.0413
  Batch [2450/2514] | Loss: 0.0409
  Batch [2500/2514] | Loss: 0.0407

Train Results:
  Loss: 0.0406 | Dice: 0.4176 | Dice_pos: 0.0902 | Dice_neg: 0.7874 | IoU: 0.0690
  Per-Class Metrics:
    Class 1: Dice=0.9149, IoU=0.9149, Prec=0.9860, Recall=0.9283, ClsAcc=0.9155, ClsF1=0.7293
    Class 2: Dice=0.9534, IoU=0.9534, Prec=0.9721, Recall=0.9809, ClsAcc=0.9538, ClsF1=0.8935
    Class 3: Dice=0.5097, IoU=0.4947, Prec=0.8306, Recall=0.6305, ClsAcc=0.6332, ClsF1=0.4065
    Class 4: Dice=0.9032, IoU=0.9032, Prec=0.9640, Recall=0.9378, ClsAcc=0.9050, ClsF1=0.7248
  Time: 454.8s

================================================================================
Fold 3 | Epoch 1/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0255
  Batch [100/629] | Loss: 0.0264
  Batch [150/629] | Loss: 0.0261
  Batch [200/629] | Loss: 0.0259
  Batch [250/629] | Loss: 0.0254
  Batch [300/629] | Loss: 0.0251
  Batch [350/629] | Loss: 0.0254
  Batch [400/629] | Loss: 0.0249
  Batch [450/629] | Loss: 0.0250
  Batch [500/629] | Loss: 0.0256
  Batch [550/629] | Loss: 0.0256
  Batch [600/629] | Loss: 0.0255

Validation Results:
  Loss: 0.0254 | Dice: 0.5241 | Dice_pos: 0.1470 | Dice_neg: 0.9500 | IoU: 0.1036
  Per-Class Metrics:
    Class 1: Dice=0.9300, IoU=0.9300, Prec=1.0000, Recall=0.9300, ClsAcc=0.9300, ClsF1=0.7488
    Class 2: Dice=0.9781, IoU=0.9781, Prec=1.0000, Recall=0.9781, ClsAcc=0.9781, ClsF1=0.9141
    Class 3: Dice=0.6350, IoU=0.6099, Prec=0.9416, Recall=0.6508, ClsAcc=0.7893, ClsF1=0.6198
    Class 4: Dice=0.9320, IoU=0.9320, Prec=1.0000, Recall=0.9320, ClsAcc=0.9320, ClsF1=0.7583
  Time: 89.6s
  Saved checkpoint: outputs_20260112_125941/fold_3/checkpoint_epoch_1.pth
  *** New best model saved: outputs_20260112_125941/fold_3/best_model.pth ***

  Current LR: 5.00e-04 | Best Dice: 0.5241 | Best Loss: 0.0254

================================================================================
Fold 3 | Epoch 2/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0289
  Batch [100/2514] | Loss: 0.0281
  Batch [150/2514] | Loss: 0.0286
  Batch [200/2514] | Loss: 0.0289
  Batch [250/2514] | Loss: 0.0298
  Batch [300/2514] | Loss: 0.0280
  Batch [350/2514] | Loss: 0.0267
  Batch [400/2514] | Loss: 0.0266
  Batch [450/2514] | Loss: 0.0271
  Batch [500/2514] | Loss: 0.0269
  Batch [550/2514] | Loss: 0.0272
  Batch [600/2514] | Loss: 0.0273
  Batch [650/2514] | Loss: 0.0270
  Batch [700/2514] | Loss: 0.0270
  Batch [750/2514] | Loss: 0.0266
  Batch [800/2514] | Loss: 0.0266
  Batch [850/2514] | Loss: 0.0264
  Batch [900/2514] | Loss: 0.0265
  Batch [950/2514] | Loss: 0.0267
  Batch [1000/2514] | Loss: 0.0265
  Batch [1050/2514] | Loss: 0.0263
  Batch [1100/2514] | Loss: 0.0263
  Batch [1150/2514] | Loss: 0.0260
  Batch [1200/2514] | Loss: 0.0260
  Batch [1250/2514] | Loss: 0.0261
  Batch [1300/2514] | Loss: 0.0262
  Batch [1350/2514] | Loss: 0.0259
  Batch [1400/2514] | Loss: 0.0258
  Batch [1450/2514] | Loss: 0.0256
  Batch [1500/2514] | Loss: 0.0256
  Batch [1550/2514] | Loss: 0.0256
  Batch [1600/2514] | Loss: 0.0255
  Batch [1650/2514] | Loss: 0.0256
  Batch [1700/2514] | Loss: 0.0255
  Batch [1750/2514] | Loss: 0.0254
  Batch [1800/2514] | Loss: 0.0253
  Batch [1850/2514] | Loss: 0.0251
  Batch [1900/2514] | Loss: 0.0251
  Batch [1950/2514] | Loss: 0.0250
  Batch [2000/2514] | Loss: 0.0249
  Batch [2050/2514] | Loss: 0.0248
  Batch [2100/2514] | Loss: 0.0248
  Batch [2150/2514] | Loss: 0.0247
  Batch [2200/2514] | Loss: 0.0249
  Batch [2250/2514] | Loss: 0.0248
  Batch [2300/2514] | Loss: 0.0247
  Batch [2350/2514] | Loss: 0.0247
  Batch [2400/2514] | Loss: 0.0247
  Batch [2450/2514] | Loss: 0.0245
  Batch [2500/2514] | Loss: 0.0245

Train Results:
  Loss: 0.0245 | Dice: 0.4508 | Dice_pos: 0.2826 | Dice_neg: 0.6408 | IoU: 0.2172
  Per-Class Metrics:
    Class 1: Dice=0.9283, IoU=0.9283, Prec=1.0000, Recall=0.9283, ClsAcc=0.9283, ClsF1=0.7430
    Class 2: Dice=0.9809, IoU=0.9809, Prec=1.0000, Recall=0.9809, ClsAcc=0.9809, ClsF1=0.9264
    Class 3: Dice=0.5024, IoU=0.4609, Prec=0.6867, Recall=0.7289, ClsAcc=0.6929, ClsF1=0.6490
    Class 4: Dice=0.9369, IoU=0.9369, Prec=0.9996, Recall=0.9373, ClsAcc=0.9370, ClsF1=0.7721
  Time: 433.2s

================================================================================
Fold 3 | Epoch 2/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0202
  Batch [100/629] | Loss: 0.0219
  Batch [150/629] | Loss: 0.0213
  Batch [200/629] | Loss: 0.0210
  Batch [250/629] | Loss: 0.0205
  Batch [300/629] | Loss: 0.0201
  Batch [350/629] | Loss: 0.0205
  Batch [400/629] | Loss: 0.0200
  Batch [450/629] | Loss: 0.0202
  Batch [500/629] | Loss: 0.0209
  Batch [550/629] | Loss: 0.0209
  Batch [600/629] | Loss: 0.0208

Validation Results:
  Loss: 0.0207 | Dice: 0.5667 | Dice_pos: 0.3428 | Dice_neg: 0.8195 | IoU: 0.2693
  Per-Class Metrics:
    Class 1: Dice=0.9300, IoU=0.9300, Prec=1.0000, Recall=0.9300, ClsAcc=0.9300, ClsF1=0.7488
    Class 2: Dice=0.9781, IoU=0.9781, Prec=1.0000, Recall=0.9781, ClsAcc=0.9781, ClsF1=0.9141
    Class 3: Dice=0.6440, IoU=0.6019, Prec=0.7831, Recall=0.7737, ClsAcc=0.7925, ClsF1=0.7184
    Class 4: Dice=0.9316, IoU=0.9316, Prec=0.9996, Recall=0.9320, ClsAcc=0.9316, ClsF1=0.7583
  Time: 86.4s
  Saved checkpoint: outputs_20260112_125941/fold_3/checkpoint_epoch_2.pth
  *** New best model saved: outputs_20260112_125941/fold_3/best_model.pth ***

  Current LR: 5.00e-04 | Best Dice: 0.5667 | Best Loss: 0.0207

================================================================================
Fold 3 | Epoch 3/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0146
  Batch [100/2514] | Loss: 0.0177
  Batch [150/2514] | Loss: 0.0208
  Batch [200/2514] | Loss: 0.0202
  Batch [250/2514] | Loss: 0.0209
  Batch [300/2514] | Loss: 0.0198
  Batch [350/2514] | Loss: 0.0202
  Batch [400/2514] | Loss: 0.0201
  Batch [450/2514] | Loss: 0.0200
  Batch [500/2514] | Loss: 0.0200
  Batch [550/2514] | Loss: 0.0201
  Batch [600/2514] | Loss: 0.0207
  Batch [650/2514] | Loss: 0.0207
  Batch [700/2514] | Loss: 0.0211
  Batch [750/2514] | Loss: 0.0214
  Batch [800/2514] | Loss: 0.0215
  Batch [850/2514] | Loss: 0.0216
  Batch [900/2514] | Loss: 0.0215
  Batch [950/2514] | Loss: 0.0213
  Batch [1000/2514] | Loss: 0.0214
  Batch [1050/2514] | Loss: 0.0216
  Batch [1100/2514] | Loss: 0.0220
  Batch [1150/2514] | Loss: 0.0221
  Batch [1200/2514] | Loss: 0.0221
  Batch [1250/2514] | Loss: 0.0221
  Batch [1300/2514] | Loss: 0.0221
  Batch [1350/2514] | Loss: 0.0219
  Batch [1400/2514] | Loss: 0.0219
  Batch [1450/2514] | Loss: 0.0218
  Batch [1500/2514] | Loss: 0.0217
  Batch [1550/2514] | Loss: 0.0215
  Batch [1600/2514] | Loss: 0.0217
  Batch [1650/2514] | Loss: 0.0216
  Batch [1700/2514] | Loss: 0.0214
  Batch [1750/2514] | Loss: 0.0215
  Batch [1800/2514] | Loss: 0.0215
  Batch [1850/2514] | Loss: 0.0216
  Batch [1900/2514] | Loss: 0.0217
  Batch [1950/2514] | Loss: 0.0217
  Batch [2000/2514] | Loss: 0.0216
  Batch [2050/2514] | Loss: 0.0216
  Batch [2100/2514] | Loss: 0.0214
  Batch [2150/2514] | Loss: 0.0214
  Batch [2200/2514] | Loss: 0.0213
  Batch [2250/2514] | Loss: 0.0212
  Batch [2300/2514] | Loss: 0.0211
  Batch [2350/2514] | Loss: 0.0210
  Batch [2400/2514] | Loss: 0.0209
  Batch [2450/2514] | Loss: 0.0208
  Batch [2500/2514] | Loss: 0.0209

Train Results:
  Loss: 0.0209 | Dice: 0.5193 | Dice_pos: 0.3601 | Dice_neg: 0.6991 | IoU: 0.2753
  Per-Class Metrics:
    Class 1: Dice=0.9283, IoU=0.9283, Prec=1.0000, Recall=0.9283, ClsAcc=0.9283, ClsF1=0.7454
    Class 2: Dice=0.9809, IoU=0.9809, Prec=1.0000, Recall=0.9809, ClsAcc=0.9809, ClsF1=0.9264
    Class 3: Dice=0.5721, IoU=0.5240, Prec=0.7146, Recall=0.7649, ClsAcc=0.7464, ClsF1=0.6941
    Class 4: Dice=0.9144, IoU=0.9128, Prec=0.9709, Recall=0.9406, ClsAcc=0.9287, ClsF1=0.7535
  Time: 421.8s

================================================================================
Fold 3 | Epoch 3/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0185
  Batch [100/629] | Loss: 0.0194
  Batch [150/629] | Loss: 0.0199
  Batch [200/629] | Loss: 0.0197
  Batch [250/629] | Loss: 0.0195
  Batch [300/629] | Loss: 0.0190
  Batch [350/629] | Loss: 0.0194
  Batch [400/629] | Loss: 0.0190
  Batch [450/629] | Loss: 0.0192
  Batch [500/629] | Loss: 0.0198
  Batch [550/629] | Loss: 0.0197
  Batch [600/629] | Loss: 0.0197

Validation Results:
  Loss: 0.0196 | Dice: 0.5746 | Dice_pos: 0.4486 | Dice_neg: 0.7169 | IoU: 0.3505
  Per-Class Metrics:
    Class 1: Dice=0.9300, IoU=0.9300, Prec=1.0000, Recall=0.9300, ClsAcc=0.9300, ClsF1=0.7488
    Class 2: Dice=0.9781, IoU=0.9781, Prec=1.0000, Recall=0.9781, ClsAcc=0.9781, ClsF1=0.9141
    Class 3: Dice=0.6370, IoU=0.5875, Prec=0.7030, Recall=0.8376, ClsAcc=0.7834, ClsF1=0.7289
    Class 4: Dice=0.8988, IoU=0.8920, Prec=0.9370, Recall=0.9492, ClsAcc=0.9320, ClsF1=0.7711
  Time: 152.8s
  Saved checkpoint: outputs_20260112_125941/fold_3/checkpoint_epoch_3.pth
  *** New best model saved: outputs_20260112_125941/fold_3/best_model.pth ***

  Current LR: 5.00e-04 | Best Dice: 0.5746 | Best Loss: 0.0196

================================================================================
Fold 3 | Epoch 4/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0158
  Batch [100/2514] | Loss: 0.0171
  Batch [150/2514] | Loss: 0.0190
  Batch [200/2514] | Loss: 0.0186
  Batch [250/2514] | Loss: 0.0189
  Batch [300/2514] | Loss: 0.0188
  Batch [350/2514] | Loss: 0.0198
  Batch [400/2514] | Loss: 0.0193
  Batch [450/2514] | Loss: 0.0198
  Batch [500/2514] | Loss: 0.0200
  Batch [550/2514] | Loss: 0.0201
  Batch [600/2514] | Loss: 0.0200
  Batch [650/2514] | Loss: 0.0199
  Batch [700/2514] | Loss: 0.0201
  Batch [750/2514] | Loss: 0.0202
  Batch [800/2514] | Loss: 0.0200
  Batch [850/2514] | Loss: 0.0203
  Batch [900/2514] | Loss: 0.0200
  Batch [950/2514] | Loss: 0.0199
  Batch [1000/2514] | Loss: 0.0197
  Batch [1050/2514] | Loss: 0.0194
  Batch [1100/2514] | Loss: 0.0193
  Batch [1150/2514] | Loss: 0.0192
  Batch [1200/2514] | Loss: 0.0192
  Batch [1250/2514] | Loss: 0.0193
  Batch [1300/2514] | Loss: 0.0193
  Batch [1350/2514] | Loss: 0.0193
  Batch [1400/2514] | Loss: 0.0194
  Batch [1450/2514] | Loss: 0.0194
  Batch [1500/2514] | Loss: 0.0193
  Batch [1550/2514] | Loss: 0.0194
  Batch [1600/2514] | Loss: 0.0193
  Batch [1650/2514] | Loss: 0.0191
  Batch [1700/2514] | Loss: 0.0191
  Batch [1750/2514] | Loss: 0.0190
  Batch [1800/2514] | Loss: 0.0190
  Batch [1850/2514] | Loss: 0.0188
  Batch [1900/2514] | Loss: 0.0187
  Batch [1950/2514] | Loss: 0.0187
  Batch [2000/2514] | Loss: 0.0186
  Batch [2050/2514] | Loss: 0.0185
  Batch [2100/2514] | Loss: 0.0187
  Batch [2150/2514] | Loss: 0.0187
  Batch [2200/2514] | Loss: 0.0187
  Batch [2250/2514] | Loss: 0.0186
  Batch [2300/2514] | Loss: 0.0186
  Batch [2350/2514] | Loss: 0.0185
  Batch [2400/2514] | Loss: 0.0185
  Batch [2450/2514] | Loss: 0.0185
  Batch [2500/2514] | Loss: 0.0184

Train Results:
  Loss: 0.0184 | Dice: 0.5571 | Dice_pos: 0.3937 | Dice_neg: 0.7416 | IoU: 0.2971
  Per-Class Metrics:
    Class 1: Dice=0.9283, IoU=0.9283, Prec=1.0000, Recall=0.9283, ClsAcc=0.9283, ClsF1=0.7403
    Class 2: Dice=0.9809, IoU=0.9809, Prec=1.0000, Recall=0.9809, ClsAcc=0.9809, ClsF1=0.9252
    Class 3: Dice=0.6221, IoU=0.5748, Prec=0.7570, Recall=0.7770, ClsAcc=0.7856, ClsF1=0.7138
    Class 4: Dice=0.8995, IoU=0.8957, Prec=0.9456, Recall=0.9471, ClsAcc=0.9230, ClsF1=0.7475
  Time: 430.9s

================================================================================
Fold 3 | Epoch 4/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0189
  Batch [100/629] | Loss: 0.0187
  Batch [150/629] | Loss: 0.0194
  Batch [200/629] | Loss: 0.0187
  Batch [250/629] | Loss: 0.0185
  Batch [300/629] | Loss: 0.0182
  Batch [350/629] | Loss: 0.0186
  Batch [400/629] | Loss: 0.0180
  Batch [450/629] | Loss: 0.0184
  Batch [500/629] | Loss: 0.0186
  Batch [550/629] | Loss: 0.0186
  Batch [600/629] | Loss: 0.0185

Validation Results:
  Loss: 0.0184 | Dice: 0.5815 | Dice_pos: 0.3618 | Dice_neg: 0.8297 | IoU: 0.2719
  Per-Class Metrics:
    Class 1: Dice=0.9300, IoU=0.9300, Prec=1.0000, Recall=0.9300, ClsAcc=0.9300, ClsF1=0.7488
    Class 2: Dice=0.9781, IoU=0.9781, Prec=1.0000, Recall=0.9781, ClsAcc=0.9781, ClsF1=0.9141
    Class 3: Dice=0.6848, IoU=0.6414, Prec=0.8865, Recall=0.7264, ClsAcc=0.8541, ClsF1=0.7864
    Class 4: Dice=0.8785, IoU=0.8705, Prec=0.9046, Recall=0.9599, ClsAcc=0.9066, ClsF1=0.7040
  Time: 169.0s
  Saved checkpoint: outputs_20260112_125941/fold_3/checkpoint_epoch_4.pth
  *** New best model saved: outputs_20260112_125941/fold_3/best_model.pth ***

  Current LR: 5.00e-04 | Best Dice: 0.5815 | Best Loss: 0.0184

================================================================================
Fold 3 | Epoch 5/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0131
  Batch [100/2514] | Loss: 0.0142
  Batch [150/2514] | Loss: 0.0154
  Batch [200/2514] | Loss: 0.0160
  Batch [250/2514] | Loss: 0.0170
  Batch [300/2514] | Loss: 0.0174
  Batch [350/2514] | Loss: 0.0175
  Batch [400/2514] | Loss: 0.0177
  Batch [450/2514] | Loss: 0.0175
  Batch [500/2514] | Loss: 0.0173
  Batch [550/2514] | Loss: 0.0169
  Batch [600/2514] | Loss: 0.0170
  Batch [650/2514] | Loss: 0.0169
  Batch [700/2514] | Loss: 0.0169
  Batch [750/2514] | Loss: 0.0167
  Batch [800/2514] | Loss: 0.0169
  Batch [850/2514] | Loss: 0.0172
  Batch [900/2514] | Loss: 0.0172
  Batch [950/2514] | Loss: 0.0172
  Batch [1000/2514] | Loss: 0.0172
  Batch [1050/2514] | Loss: 0.0170
  Batch [1100/2514] | Loss: 0.0168
  Batch [1150/2514] | Loss: 0.0168
  Batch [1200/2514] | Loss: 0.0168
  Batch [1250/2514] | Loss: 0.0167
  Batch [1300/2514] | Loss: 0.0167
  Batch [1350/2514] | Loss: 0.0167
  Batch [1400/2514] | Loss: 0.0165
  Batch [1450/2514] | Loss: 0.0166
  Batch [1500/2514] | Loss: 0.0166
  Batch [1550/2514] | Loss: 0.0167
  Batch [1600/2514] | Loss: 0.0168
  Batch [1650/2514] | Loss: 0.0170
  Batch [1700/2514] | Loss: 0.0171
  Batch [1750/2514] | Loss: 0.0171
  Batch [1800/2514] | Loss: 0.0171
  Batch [1850/2514] | Loss: 0.0171
  Batch [1900/2514] | Loss: 0.0169
  Batch [1950/2514] | Loss: 0.0170
  Batch [2000/2514] | Loss: 0.0170
  Batch [2050/2514] | Loss: 0.0170
  Batch [2100/2514] | Loss: 0.0170
  Batch [2150/2514] | Loss: 0.0170
  Batch [2200/2514] | Loss: 0.0169
  Batch [2250/2514] | Loss: 0.0171
  Batch [2300/2514] | Loss: 0.0171
  Batch [2350/2514] | Loss: 0.0170
  Batch [2400/2514] | Loss: 0.0170
  Batch [2450/2514] | Loss: 0.0169
  Batch [2500/2514] | Loss: 0.0169

Train Results:
  Loss: 0.0169 | Dice: 0.5864 | Dice_pos: 0.4171 | Dice_neg: 0.7776 | IoU: 0.3153
  Per-Class Metrics:
    Class 1: Dice=0.9283, IoU=0.9283, Prec=1.0000, Recall=0.9283, ClsAcc=0.9283, ClsF1=0.7422
    Class 2: Dice=0.9809, IoU=0.9809, Prec=1.0000, Recall=0.9809, ClsAcc=0.9809, ClsF1=0.9256
    Class 3: Dice=0.6528, IoU=0.6056, Prec=0.7815, Recall=0.7861, ClsAcc=0.8097, ClsF1=0.7340
    Class 4: Dice=0.9006, IoU=0.8950, Prec=0.9376, Recall=0.9534, ClsAcc=0.9280, ClsF1=0.7681
  Time: 441.5s

================================================================================
Fold 3 | Epoch 5/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0165
  Batch [100/629] | Loss: 0.0170
  Batch [150/629] | Loss: 0.0173
  Batch [200/629] | Loss: 0.0165
  Batch [250/629] | Loss: 0.0161
  Batch [300/629] | Loss: 0.0158
  Batch [350/629] | Loss: 0.0162
  Batch [400/629] | Loss: 0.0156
  Batch [450/629] | Loss: 0.0160
  Batch [500/629] | Loss: 0.0163
  Batch [550/629] | Loss: 0.0162
  Batch [600/629] | Loss: 0.0161

Validation Results:
  Loss: 0.0161 | Dice: 0.6370 | Dice_pos: 0.4552 | Dice_neg: 0.8424 | IoU: 0.3612
  Per-Class Metrics:
    Class 1: Dice=0.9300, IoU=0.9300, Prec=1.0000, Recall=0.9300, ClsAcc=0.9300, ClsF1=0.7488
    Class 2: Dice=0.9781, IoU=0.9781, Prec=1.0000, Recall=0.9781, ClsAcc=0.9781, ClsF1=0.9141
    Class 3: Dice=0.7141, IoU=0.6676, Prec=0.8239, Recall=0.8086, ClsAcc=0.8521, ClsF1=0.8054
    Class 4: Dice=0.9205, IoU=0.9132, Prec=0.9552, Recall=0.9539, ClsAcc=0.9511, ClsF1=0.8258
  Time: 132.1s
  Saved checkpoint: outputs_20260112_125941/fold_3/checkpoint_epoch_5.pth
  *** New best model saved: outputs_20260112_125941/fold_3/best_model.pth ***

  Current LR: 5.00e-04 | Best Dice: 0.6370 | Best Loss: 0.0161

================================================================================
Fold 3 | Epoch 6/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0155
  Batch [100/2514] | Loss: 0.0143
  Batch [150/2514] | Loss: 0.0131
  Batch [200/2514] | Loss: 0.0144
  Batch [250/2514] | Loss: 0.0146
  Batch [300/2514] | Loss: 0.0154
  Batch [350/2514] | Loss: 0.0149
  Batch [400/2514] | Loss: 0.0157
  Batch [450/2514] | Loss: 0.0157
  Batch [500/2514] | Loss: 0.0159
  Batch [550/2514] | Loss: 0.0155
  Batch [600/2514] | Loss: 0.0156
  Batch [650/2514] | Loss: 0.0157
  Batch [700/2514] | Loss: 0.0155
  Batch [750/2514] | Loss: 0.0154
  Batch [800/2514] | Loss: 0.0157
  Batch [850/2514] | Loss: 0.0157
  Batch [900/2514] | Loss: 0.0156
  Batch [950/2514] | Loss: 0.0155
  Batch [1000/2514] | Loss: 0.0154
  Batch [1050/2514] | Loss: 0.0154
  Batch [1100/2514] | Loss: 0.0155
  Batch [1150/2514] | Loss: 0.0156
  Batch [1200/2514] | Loss: 0.0159
  Batch [1250/2514] | Loss: 0.0159
  Batch [1300/2514] | Loss: 0.0160
  Batch [1350/2514] | Loss: 0.0158
  Batch [1400/2514] | Loss: 0.0160
  Batch [1450/2514] | Loss: 0.0160
  Batch [1500/2514] | Loss: 0.0160
  Batch [1550/2514] | Loss: 0.0160
  Batch [1600/2514] | Loss: 0.0161
  Batch [1650/2514] | Loss: 0.0162
  Batch [1700/2514] | Loss: 0.0163
  Batch [1750/2514] | Loss: 0.0163
  Batch [1800/2514] | Loss: 0.0164
  Batch [1850/2514] | Loss: 0.0164
  Batch [1900/2514] | Loss: 0.0164
  Batch [1950/2514] | Loss: 0.0163
  Batch [2000/2514] | Loss: 0.0162
  Batch [2050/2514] | Loss: 0.0162
  Batch [2100/2514] | Loss: 0.0163
  Batch [2150/2514] | Loss: 0.0163
  Batch [2200/2514] | Loss: 0.0163
  Batch [2250/2514] | Loss: 0.0163
  Batch [2300/2514] | Loss: 0.0162
  Batch [2350/2514] | Loss: 0.0162
  Batch [2400/2514] | Loss: 0.0162
  Batch [2450/2514] | Loss: 0.0162
  Batch [2500/2514] | Loss: 0.0161

Train Results:
  Loss: 0.0161 | Dice: 0.6017 | Dice_pos: 0.4289 | Dice_neg: 0.7969 | IoU: 0.3303
  Per-Class Metrics:
    Class 1: Dice=0.9283, IoU=0.9283, Prec=1.0000, Recall=0.9283, ClsAcc=0.9283, ClsF1=0.7450
    Class 2: Dice=0.9809, IoU=0.9809, Prec=1.0000, Recall=0.9809, ClsAcc=0.9809, ClsF1=0.9256
    Class 3: Dice=0.6697, IoU=0.6233, Prec=0.7977, Recall=0.7887, ClsAcc=0.8232, ClsF1=0.7464
    Class 4: Dice=0.9045, IoU=0.8979, Prec=0.9352, Recall=0.9582, ClsAcc=0.9317, ClsF1=0.7789
  Time: 432.0s

================================================================================
Fold 3 | Epoch 6/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0155
  Batch [100/629] | Loss: 0.0169
  Batch [150/629] | Loss: 0.0174
  Batch [200/629] | Loss: 0.0167
  Batch [250/629] | Loss: 0.0163
  Batch [300/629] | Loss: 0.0157
  Batch [350/629] | Loss: 0.0159
  Batch [400/629] | Loss: 0.0155
  Batch [450/629] | Loss: 0.0158
  Batch [500/629] | Loss: 0.0164
  Batch [550/629] | Loss: 0.0164
  Batch [600/629] | Loss: 0.0163

Validation Results:
  Loss: 0.0163 | Dice: 0.6460 | Dice_pos: 0.3762 | Dice_neg: 0.9508 | IoU: 0.2940
  Per-Class Metrics:
    Class 1: Dice=0.9300, IoU=0.9300, Prec=1.0000, Recall=0.9300, ClsAcc=0.9300, ClsF1=0.7488
    Class 2: Dice=0.9781, IoU=0.9781, Prec=1.0000, Recall=0.9781, ClsAcc=0.9781, ClsF1=0.9141
    Class 3: Dice=0.7314, IoU=0.6890, Prec=0.8955, Recall=0.7629, ClsAcc=0.8760, ClsF1=0.8099
    Class 4: Dice=0.9402, IoU=0.9365, Prec=0.9973, Recall=0.9386, ClsAcc=0.9674, ClsF1=0.8844
  Time: 148.3s
  Saved checkpoint: outputs_20260112_125941/fold_3/checkpoint_epoch_6.pth
  *** New best model saved: outputs_20260112_125941/fold_3/best_model.pth ***

  Current LR: 5.00e-04 | Best Dice: 0.6460 | Best Loss: 0.0163

================================================================================
Fold 3 | Epoch 7/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0144
  Batch [100/2514] | Loss: 0.0151
  Batch [150/2514] | Loss: 0.0155
  Batch [200/2514] | Loss: 0.0158
  Batch [250/2514] | Loss: 0.0156
  Batch [300/2514] | Loss: 0.0154
  Batch [350/2514] | Loss: 0.0151
  Batch [400/2514] | Loss: 0.0154
  Batch [450/2514] | Loss: 0.0154
  Batch [500/2514] | Loss: 0.0151
  Batch [550/2514] | Loss: 0.0150
  Batch [600/2514] | Loss: 0.0150
  Batch [650/2514] | Loss: 0.0150
  Batch [700/2514] | Loss: 0.0151
  Batch [750/2514] | Loss: 0.0152
  Batch [800/2514] | Loss: 0.0156
  Batch [850/2514] | Loss: 0.0157
  Batch [900/2514] | Loss: 0.0157
  Batch [950/2514] | Loss: 0.0153
  Batch [1000/2514] | Loss: 0.0153
  Batch [1050/2514] | Loss: 0.0153
  Batch [1100/2514] | Loss: 0.0152
  Batch [1150/2514] | Loss: 0.0151
  Batch [1200/2514] | Loss: 0.0150
  Batch [1250/2514] | Loss: 0.0152
  Batch [1300/2514] | Loss: 0.0151
  Batch [1350/2514] | Loss: 0.0150
  Batch [1400/2514] | Loss: 0.0151
  Batch [1450/2514] | Loss: 0.0151
  Batch [1500/2514] | Loss: 0.0150
  Batch [1550/2514] | Loss: 0.0150
  Batch [1600/2514] | Loss: 0.0150
  Batch [1650/2514] | Loss: 0.0151
  Batch [1700/2514] | Loss: 0.0149
  Batch [1750/2514] | Loss: 0.0150
  Batch [1800/2514] | Loss: 0.0150
  Batch [1850/2514] | Loss: 0.0150
  Batch [1900/2514] | Loss: 0.0151
  Batch [1950/2514] | Loss: 0.0151
  Batch [2000/2514] | Loss: 0.0151
  Batch [2050/2514] | Loss: 0.0150
  Batch [2100/2514] | Loss: 0.0150
  Batch [2150/2514] | Loss: 0.0149
  Batch [2200/2514] | Loss: 0.0149
  Batch [2250/2514] | Loss: 0.0150
  Batch [2300/2514] | Loss: 0.0151
  Batch [2350/2514] | Loss: 0.0153
  Batch [2400/2514] | Loss: 0.0153
  Batch [2450/2514] | Loss: 0.0153
  Batch [2500/2514] | Loss: 0.0153

Train Results:
  Loss: 0.0153 | Dice: 0.6176 | Dice_pos: 0.4465 | Dice_neg: 0.8109 | IoU: 0.3432
  Per-Class Metrics:
    Class 1: Dice=0.9283, IoU=0.9283, Prec=1.0000, Recall=0.9283, ClsAcc=0.9283, ClsF1=0.7418
    Class 2: Dice=0.9809, IoU=0.9809, Prec=1.0000, Recall=0.9809, ClsAcc=0.9809, ClsF1=0.9240
    Class 3: Dice=0.6846, IoU=0.6377, Prec=0.8084, Recall=0.7946, ClsAcc=0.8334, ClsF1=0.7525
    Class 4: Dice=0.9137, IoU=0.9067, Prec=0.9386, Recall=0.9633, ClsAcc=0.9388, ClsF1=0.8106
  Time: 449.4s

================================================================================
Fold 3 | Epoch 7/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0143
  Batch [100/629] | Loss: 0.0152
  Batch [150/629] | Loss: 0.0156
  Batch [200/629] | Loss: 0.0150
  Batch [250/629] | Loss: 0.0148
  Batch [300/629] | Loss: 0.0144
  Batch [350/629] | Loss: 0.0147
  Batch [400/629] | Loss: 0.0144
  Batch [450/629] | Loss: 0.0147
  Batch [500/629] | Loss: 0.0151
  Batch [550/629] | Loss: 0.0150
  Batch [600/629] | Loss: 0.0149

Validation Results:
  Loss: 0.0149 | Dice: 0.6493 | Dice_pos: 0.4777 | Dice_neg: 0.8432 | IoU: 0.3804
  Per-Class Metrics:
    Class 1: Dice=0.9300, IoU=0.9300, Prec=1.0000, Recall=0.9300, ClsAcc=0.9300, ClsF1=0.7488
    Class 2: Dice=0.9781, IoU=0.9781, Prec=1.0000, Recall=0.9781, ClsAcc=0.9781, ClsF1=0.9141
    Class 3: Dice=0.7184, IoU=0.6693, Prec=0.8207, Recall=0.8144, ClsAcc=0.8637, ClsF1=0.8138
    Class 4: Dice=0.9302, IoU=0.9223, Prec=0.9584, Recall=0.9593, ClsAcc=0.9595, ClsF1=0.8526
  Time: 122.6s
  Saved checkpoint: outputs_20260112_125941/fold_3/checkpoint_epoch_7.pth
  *** New best model saved: outputs_20260112_125941/fold_3/best_model.pth ***

  Current LR: 5.00e-04 | Best Dice: 0.6493 | Best Loss: 0.0149

================================================================================
Fold 3 | Epoch 8/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0195
  Batch [100/2514] | Loss: 0.0165
  Batch [150/2514] | Loss: 0.0160
  Batch [200/2514] | Loss: 0.0152
  Batch [250/2514] | Loss: 0.0148
  Batch [300/2514] | Loss: 0.0149
  Batch [350/2514] | Loss: 0.0146
  Batch [400/2514] | Loss: 0.0143
  Batch [450/2514] | Loss: 0.0143
  Batch [500/2514] | Loss: 0.0140
  Batch [550/2514] | Loss: 0.0140
  Batch [600/2514] | Loss: 0.0141
  Batch [650/2514] | Loss: 0.0141
  Batch [700/2514] | Loss: 0.0140
  Batch [750/2514] | Loss: 0.0142
  Batch [800/2514] | Loss: 0.0140
  Batch [850/2514] | Loss: 0.0139
  Batch [900/2514] | Loss: 0.0143
  Batch [950/2514] | Loss: 0.0143
  Batch [1000/2514] | Loss: 0.0144
  Batch [1050/2514] | Loss: 0.0146
  Batch [1100/2514] | Loss: 0.0146
  Batch [1150/2514] | Loss: 0.0146
  Batch [1200/2514] | Loss: 0.0145
  Batch [1250/2514] | Loss: 0.0143
  Batch [1300/2514] | Loss: 0.0144
  Batch [1350/2514] | Loss: 0.0145
  Batch [1400/2514] | Loss: 0.0145
  Batch [1450/2514] | Loss: 0.0145
  Batch [1500/2514] | Loss: 0.0145
  Batch [1550/2514] | Loss: 0.0144
  Batch [1600/2514] | Loss: 0.0144
  Batch [1650/2514] | Loss: 0.0144
  Batch [1700/2514] | Loss: 0.0144
  Batch [1750/2514] | Loss: 0.0144
  Batch [1800/2514] | Loss: 0.0144
  Batch [1850/2514] | Loss: 0.0143
  Batch [1900/2514] | Loss: 0.0143
  Batch [1950/2514] | Loss: 0.0143
  Batch [2000/2514] | Loss: 0.0143
  Batch [2050/2514] | Loss: 0.0142
  Batch [2100/2514] | Loss: 0.0141
  Batch [2150/2514] | Loss: 0.0141
  Batch [2200/2514] | Loss: 0.0141
  Batch [2250/2514] | Loss: 0.0141
  Batch [2300/2514] | Loss: 0.0141
  Batch [2350/2514] | Loss: 0.0142
  Batch [2400/2514] | Loss: 0.0142
  Batch [2450/2514] | Loss: 0.0142
  Batch [2500/2514] | Loss: 0.0142

Train Results:
  Loss: 0.0141 | Dice: 0.6364 | Dice_pos: 0.4632 | Dice_neg: 0.8321 | IoU: 0.3623
  Per-Class Metrics:
    Class 1: Dice=0.9283, IoU=0.9283, Prec=1.0000, Recall=0.9283, ClsAcc=0.9283, ClsF1=0.7430
    Class 2: Dice=0.9809, IoU=0.9809, Prec=1.0000, Recall=0.9809, ClsAcc=0.9809, ClsF1=0.9244
    Class 3: Dice=0.6997, IoU=0.6532, Prec=0.8189, Recall=0.7998, ClsAcc=0.8457, ClsF1=0.7723
    Class 4: Dice=0.9327, IoU=0.9252, Prec=0.9511, Recall=0.9692, ClsAcc=0.9547, ClsF1=0.8582
  Time: 454.1s

================================================================================
Fold 3 | Epoch 8/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0132
  Batch [100/629] | Loss: 0.0141
  Batch [150/629] | Loss: 0.0147
  Batch [200/629] | Loss: 0.0141
  Batch [250/629] | Loss: 0.0138
  Batch [300/629] | Loss: 0.0134
  Batch [350/629] | Loss: 0.0138
  Batch [400/629] | Loss: 0.0133
  Batch [450/629] | Loss: 0.0137
  Batch [500/629] | Loss: 0.0141
  Batch [550/629] | Loss: 0.0141
  Batch [600/629] | Loss: 0.0140

Validation Results:
  Loss: 0.0139 | Dice: 0.6765 | Dice_pos: 0.4600 | Dice_neg: 0.9212 | IoU: 0.3683
  Per-Class Metrics:
    Class 1: Dice=0.9300, IoU=0.9300, Prec=1.0000, Recall=0.9300, ClsAcc=0.9300, ClsF1=0.7488
    Class 2: Dice=0.9781, IoU=0.9781, Prec=1.0000, Recall=0.9781, ClsAcc=0.9781, ClsF1=0.9141
    Class 3: Dice=0.7479, IoU=0.7028, Prec=0.8758, Recall=0.7968, ClsAcc=0.8843, ClsF1=0.8333
    Class 4: Dice=0.9462, IoU=0.9382, Prec=0.9748, Recall=0.9600, ClsAcc=0.9722, ClsF1=0.9010
  Time: 135.8s
  Saved checkpoint: outputs_20260112_125941/fold_3/checkpoint_epoch_8.pth
  *** New best model saved: outputs_20260112_125941/fold_3/best_model.pth ***

  Current LR: 5.00e-04 | Best Dice: 0.6765 | Best Loss: 0.0139

================================================================================
Fold 3 | Epoch 9/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0132
  Batch [100/2514] | Loss: 0.0132
  Batch [150/2514] | Loss: 0.0135
  Batch [200/2514] | Loss: 0.0130
  Batch [250/2514] | Loss: 0.0130
  Batch [300/2514] | Loss: 0.0128
  Batch [350/2514] | Loss: 0.0133
  Batch [400/2514] | Loss: 0.0137
  Batch [450/2514] | Loss: 0.0136
  Batch [500/2514] | Loss: 0.0137
  Batch [550/2514] | Loss: 0.0136
  Batch [600/2514] | Loss: 0.0137
  Batch [650/2514] | Loss: 0.0135
  Batch [700/2514] | Loss: 0.0136
  Batch [750/2514] | Loss: 0.0138
  Batch [800/2514] | Loss: 0.0137
  Batch [850/2514] | Loss: 0.0136
  Batch [900/2514] | Loss: 0.0134
  Batch [950/2514] | Loss: 0.0134
  Batch [1000/2514] | Loss: 0.0135
  Batch [1050/2514] | Loss: 0.0136
  Batch [1100/2514] | Loss: 0.0137
  Batch [1150/2514] | Loss: 0.0139
  Batch [1200/2514] | Loss: 0.0139
  Batch [1250/2514] | Loss: 0.0139
  Batch [1300/2514] | Loss: 0.0139
  Batch [1350/2514] | Loss: 0.0139
  Batch [1400/2514] | Loss: 0.0139
  Batch [1450/2514] | Loss: 0.0138
  Batch [1500/2514] | Loss: 0.0139
  Batch [1550/2514] | Loss: 0.0141
  Batch [1600/2514] | Loss: 0.0141
  Batch [1650/2514] | Loss: 0.0142
  Batch [1700/2514] | Loss: 0.0142
  Batch [1750/2514] | Loss: 0.0140
  Batch [1800/2514] | Loss: 0.0140
  Batch [1850/2514] | Loss: 0.0140
  Batch [1900/2514] | Loss: 0.0141
  Batch [1950/2514] | Loss: 0.0141
  Batch [2000/2514] | Loss: 0.0141
  Batch [2050/2514] | Loss: 0.0141
  Batch [2100/2514] | Loss: 0.0140
  Batch [2150/2514] | Loss: 0.0139
  Batch [2200/2514] | Loss: 0.0139
  Batch [2250/2514] | Loss: 0.0138
  Batch [2300/2514] | Loss: 0.0139
  Batch [2350/2514] | Loss: 0.0139
  Batch [2400/2514] | Loss: 0.0138
  Batch [2450/2514] | Loss: 0.0139
  Batch [2500/2514] | Loss: 0.0139

Train Results:
  Loss: 0.0139 | Dice: 0.6455 | Dice_pos: 0.4684 | Dice_neg: 0.8454 | IoU: 0.3632
  Per-Class Metrics:
    Class 1: Dice=0.9283, IoU=0.9283, Prec=1.0000, Recall=0.9283, ClsAcc=0.9283, ClsF1=0.7450
    Class 2: Dice=0.9809, IoU=0.9809, Prec=1.0000, Recall=0.9809, ClsAcc=0.9809, ClsF1=0.9248
    Class 3: Dice=0.7078, IoU=0.6607, Prec=0.8249, Recall=0.8020, ClsAcc=0.8513, ClsF1=0.7724
    Class 4: Dice=0.9359, IoU=0.9287, Prec=0.9551, Recall=0.9698, ClsAcc=0.9574, ClsF1=0.8634
  Time: 420.0s

================================================================================
Fold 3 | Epoch 9/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0145
  Batch [100/629] | Loss: 0.0155
  Batch [150/629] | Loss: 0.0163
  Batch [200/629] | Loss: 0.0154
  Batch [250/629] | Loss: 0.0152
  Batch [300/629] | Loss: 0.0148
  Batch [350/629] | Loss: 0.0151
  Batch [400/629] | Loss: 0.0146
  Batch [450/629] | Loss: 0.0151
  Batch [500/629] | Loss: 0.0155
  Batch [550/629] | Loss: 0.0154
  Batch [600/629] | Loss: 0.0153

Validation Results:
  Loss: 0.0152 | Dice: 0.6627 | Dice_pos: 0.4204 | Dice_neg: 0.9364 | IoU: 0.3310
  Per-Class Metrics:
    Class 1: Dice=0.9300, IoU=0.9300, Prec=1.0000, Recall=0.9300, ClsAcc=0.9300, ClsF1=0.7488
    Class 2: Dice=0.9781, IoU=0.9781, Prec=1.0000, Recall=0.9781, ClsAcc=0.9781, ClsF1=0.9141
    Class 3: Dice=0.7454, IoU=0.7017, Prec=0.9095, Recall=0.7652, ClsAcc=0.8899, ClsF1=0.8362
    Class 4: Dice=0.9439, IoU=0.9362, Prec=0.9727, Recall=0.9595, ClsAcc=0.9710, ClsF1=0.8973
  Time: 121.4s
  Saved checkpoint: outputs_20260112_125941/fold_3/checkpoint_epoch_9.pth

  Current LR: 5.00e-04 | Best Dice: 0.6765 | Best Loss: 0.0139

================================================================================
Fold 3 | Epoch 10/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0109
  Batch [100/2514] | Loss: 0.0120
  Batch [150/2514] | Loss: 0.0117
  Batch [200/2514] | Loss: 0.0116
  Batch [250/2514] | Loss: 0.0119
  Batch [300/2514] | Loss: 0.0117
  Batch [350/2514] | Loss: 0.0120
  Batch [400/2514] | Loss: 0.0123
  Batch [450/2514] | Loss: 0.0129
  Batch [500/2514] | Loss: 0.0126
  Batch [550/2514] | Loss: 0.0126
  Batch [600/2514] | Loss: 0.0128
  Batch [650/2514] | Loss: 0.0127
  Batch [700/2514] | Loss: 0.0127
  Batch [750/2514] | Loss: 0.0127
  Batch [800/2514] | Loss: 0.0132
  Batch [850/2514] | Loss: 0.0132
  Batch [900/2514] | Loss: 0.0133
  Batch [950/2514] | Loss: 0.0134
  Batch [1000/2514] | Loss: 0.0136
  Batch [1050/2514] | Loss: 0.0138
  Batch [1100/2514] | Loss: 0.0136
  Batch [1150/2514] | Loss: 0.0137
  Batch [1200/2514] | Loss: 0.0139
  Batch [1250/2514] | Loss: 0.0139
  Batch [1300/2514] | Loss: 0.0138
  Batch [1350/2514] | Loss: 0.0138
  Batch [1400/2514] | Loss: 0.0136
  Batch [1450/2514] | Loss: 0.0136
  Batch [1500/2514] | Loss: 0.0135
  Batch [1550/2514] | Loss: 0.0134
  Batch [1600/2514] | Loss: 0.0133
  Batch [1650/2514] | Loss: 0.0134
  Batch [1700/2514] | Loss: 0.0134
  Batch [1750/2514] | Loss: 0.0134
  Batch [1800/2514] | Loss: 0.0134
  Batch [1850/2514] | Loss: 0.0134
  Batch [1900/2514] | Loss: 0.0133
  Batch [1950/2514] | Loss: 0.0134
  Batch [2000/2514] | Loss: 0.0135
  Batch [2050/2514] | Loss: 0.0136
  Batch [2100/2514] | Loss: 0.0136
  Batch [2150/2514] | Loss: 0.0136
  Batch [2200/2514] | Loss: 0.0136
  Batch [2250/2514] | Loss: 0.0137
  Batch [2300/2514] | Loss: 0.0137
  Batch [2350/2514] | Loss: 0.0137
  Batch [2400/2514] | Loss: 0.0137
  Batch [2450/2514] | Loss: 0.0136
  Batch [2500/2514] | Loss: 0.0137

Train Results:
  Loss: 0.0137 | Dice: 0.6489 | Dice_pos: 0.4786 | Dice_neg: 0.8412 | IoU: 0.3754
  Per-Class Metrics:
    Class 1: Dice=0.9283, IoU=0.9283, Prec=1.0000, Recall=0.9283, ClsAcc=0.9283, ClsF1=0.7438
    Class 2: Dice=0.9809, IoU=0.9809, Prec=1.0000, Recall=0.9809, ClsAcc=0.9809, ClsF1=0.9260
    Class 3: Dice=0.7144, IoU=0.6670, Prec=0.8267, Recall=0.8080, ClsAcc=0.8550, ClsF1=0.7856
    Class 4: Dice=0.9399, IoU=0.9329, Prec=0.9595, Recall=0.9701, ClsAcc=0.9603, ClsF1=0.8804
  Time: 437.9s

================================================================================
Fold 3 | Epoch 10/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0147
  Batch [100/629] | Loss: 0.0146
  Batch [150/629] | Loss: 0.0150
  Batch [200/629] | Loss: 0.0144
  Batch [250/629] | Loss: 0.0141
  Batch [300/629] | Loss: 0.0137
  Batch [350/629] | Loss: 0.0140
  Batch [400/629] | Loss: 0.0135
  Batch [450/629] | Loss: 0.0139
  Batch [500/629] | Loss: 0.0142
  Batch [550/629] | Loss: 0.0142
  Batch [600/629] | Loss: 0.0141

Validation Results:
  Loss: 0.0140 | Dice: 0.6679 | Dice_pos: 0.4406 | Dice_neg: 0.9246 | IoU: 0.3478
  Per-Class Metrics:
    Class 1: Dice=0.9300, IoU=0.9300, Prec=1.0000, Recall=0.9300, ClsAcc=0.9300, ClsF1=0.7488
    Class 2: Dice=0.9781, IoU=0.9781, Prec=1.0000, Recall=0.9781, ClsAcc=0.9781, ClsF1=0.9141
    Class 3: Dice=0.7501, IoU=0.7043, Prec=0.8943, Recall=0.7828, ClsAcc=0.8927, ClsF1=0.8395
    Class 4: Dice=0.9420, IoU=0.9338, Prec=0.9749, Recall=0.9560, ClsAcc=0.9718, ClsF1=0.9013
  Time: 113.4s
  Saved checkpoint: outputs_20260112_125941/fold_3/checkpoint_epoch_10.pth

  Current LR: 5.00e-04 | Best Dice: 0.6765 | Best Loss: 0.0139

================================================================================
Fold 3 | Epoch 11/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0119
  Batch [100/2514] | Loss: 0.0130
  Batch [150/2514] | Loss: 0.0124
  Batch [200/2514] | Loss: 0.0116
  Batch [250/2514] | Loss: 0.0116
  Batch [300/2514] | Loss: 0.0120
  Batch [350/2514] | Loss: 0.0121
  Batch [400/2514] | Loss: 0.0118
  Batch [450/2514] | Loss: 0.0119
  Batch [500/2514] | Loss: 0.0118
  Batch [550/2514] | Loss: 0.0119
  Batch [600/2514] | Loss: 0.0116
  Batch [650/2514] | Loss: 0.0118
  Batch [700/2514] | Loss: 0.0119
  Batch [750/2514] | Loss: 0.0119
  Batch [800/2514] | Loss: 0.0118
  Batch [850/2514] | Loss: 0.0120
  Batch [900/2514] | Loss: 0.0119
  Batch [950/2514] | Loss: 0.0119
  Batch [1000/2514] | Loss: 0.0120
  Batch [1050/2514] | Loss: 0.0119
  Batch [1100/2514] | Loss: 0.0121
  Batch [1150/2514] | Loss: 0.0123
  Batch [1200/2514] | Loss: 0.0123
  Batch [1250/2514] | Loss: 0.0123
  Batch [1300/2514] | Loss: 0.0124
  Batch [1350/2514] | Loss: 0.0126
  Batch [1400/2514] | Loss: 0.0125
  Batch [1450/2514] | Loss: 0.0125
  Batch [1500/2514] | Loss: 0.0126
  Batch [1550/2514] | Loss: 0.0126
  Batch [1600/2514] | Loss: 0.0126
  Batch [1650/2514] | Loss: 0.0125
  Batch [1700/2514] | Loss: 0.0126
  Batch [1750/2514] | Loss: 0.0125
  Batch [1800/2514] | Loss: 0.0125
  Batch [1850/2514] | Loss: 0.0126
  Batch [1900/2514] | Loss: 0.0126
  Batch [1950/2514] | Loss: 0.0127
  Batch [2000/2514] | Loss: 0.0128
  Batch [2050/2514] | Loss: 0.0128
  Batch [2100/2514] | Loss: 0.0129
  Batch [2150/2514] | Loss: 0.0129
  Batch [2200/2514] | Loss: 0.0129
  Batch [2250/2514] | Loss: 0.0128
  Batch [2300/2514] | Loss: 0.0128
  Batch [2350/2514] | Loss: 0.0128
  Batch [2400/2514] | Loss: 0.0129
  Batch [2450/2514] | Loss: 0.0130
  Batch [2500/2514] | Loss: 0.0130

Train Results:
  Loss: 0.0130 | Dice: 0.6566 | Dice_pos: 0.4838 | Dice_neg: 0.8518 | IoU: 0.3801
  Per-Class Metrics:
    Class 1: Dice=0.9283, IoU=0.9283, Prec=1.0000, Recall=0.9283, ClsAcc=0.9283, ClsF1=0.7426
    Class 2: Dice=0.9809, IoU=0.9809, Prec=1.0000, Recall=0.9809, ClsAcc=0.9809, ClsF1=0.9260
    Class 3: Dice=0.7168, IoU=0.6698, Prec=0.8268, Recall=0.8101, ClsAcc=0.8571, ClsF1=0.7850
    Class 4: Dice=0.9474, IoU=0.9402, Prec=0.9648, Recall=0.9721, ClsAcc=0.9667, ClsF1=0.8950
  Time: 424.2s

================================================================================
Fold 3 | Epoch 11/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0144
  Batch [100/629] | Loss: 0.0151
  Batch [150/629] | Loss: 0.0161
  Batch [200/629] | Loss: 0.0155
  Batch [250/629] | Loss: 0.0153
  Batch [300/629] | Loss: 0.0150
  Batch [350/629] | Loss: 0.0154
  Batch [400/629] | Loss: 0.0149
  Batch [450/629] | Loss: 0.0153
  Batch [500/629] | Loss: 0.0159
  Batch [550/629] | Loss: 0.0159
  Batch [600/629] | Loss: 0.0158

Validation Results:
  Loss: 0.0157 | Dice: 0.5910 | Dice_pos: 0.2664 | Dice_neg: 0.9576 | IoU: 0.1857
  Per-Class Metrics:
    Class 1: Dice=0.9300, IoU=0.9300, Prec=1.0000, Recall=0.9300, ClsAcc=0.9300, ClsF1=0.7488
    Class 2: Dice=0.9781, IoU=0.9781, Prec=1.0000, Recall=0.9781, ClsAcc=0.9781, ClsF1=0.9141
    Class 3: Dice=0.6767, IoU=0.6379, Prec=0.9329, Recall=0.6817, ClsAcc=0.8843, ClsF1=0.8244
    Class 4: Dice=0.9500, IoU=0.9425, Prec=0.9902, Recall=0.9501, ClsAcc=0.9833, ClsF1=0.9390
  Time: 103.8s
  Saved checkpoint: outputs_20260112_125941/fold_3/checkpoint_epoch_11.pth

  Current LR: 5.00e-04 | Best Dice: 0.6765 | Best Loss: 0.0139

================================================================================
Fold 3 | Epoch 12/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0151
  Batch [100/2514] | Loss: 0.0135
  Batch [150/2514] | Loss: 0.0136
  Batch [200/2514] | Loss: 0.0132
  Batch [250/2514] | Loss: 0.0128
  Batch [300/2514] | Loss: 0.0130
  Batch [350/2514] | Loss: 0.0133
  Batch [400/2514] | Loss: 0.0131
  Batch [450/2514] | Loss: 0.0129
  Batch [500/2514] | Loss: 0.0128
  Batch [550/2514] | Loss: 0.0128
  Batch [600/2514] | Loss: 0.0128
  Batch [650/2514] | Loss: 0.0128
  Batch [700/2514] | Loss: 0.0130
  Batch [750/2514] | Loss: 0.0129
  Batch [800/2514] | Loss: 0.0130
  Batch [850/2514] | Loss: 0.0130
  Batch [900/2514] | Loss: 0.0129
  Batch [950/2514] | Loss: 0.0129
  Batch [1000/2514] | Loss: 0.0132
  Batch [1050/2514] | Loss: 0.0131
  Batch [1100/2514] | Loss: 0.0131
  Batch [1150/2514] | Loss: 0.0131
  Batch [1200/2514] | Loss: 0.0129
  Batch [1250/2514] | Loss: 0.0129
  Batch [1300/2514] | Loss: 0.0129
  Batch [1350/2514] | Loss: 0.0129
  Batch [1400/2514] | Loss: 0.0129
  Batch [1450/2514] | Loss: 0.0129
  Batch [1500/2514] | Loss: 0.0128
  Batch [1550/2514] | Loss: 0.0128
  Batch [1600/2514] | Loss: 0.0128
  Batch [1650/2514] | Loss: 0.0128
  Batch [1700/2514] | Loss: 0.0127
  Batch [1750/2514] | Loss: 0.0128
  Batch [1800/2514] | Loss: 0.0128
  Batch [1850/2514] | Loss: 0.0127
  Batch [1900/2514] | Loss: 0.0127
  Batch [1950/2514] | Loss: 0.0128
  Batch [2000/2514] | Loss: 0.0129
  Batch [2050/2514] | Loss: 0.0129
  Batch [2100/2514] | Loss: 0.0129
  Batch [2150/2514] | Loss: 0.0128
  Batch [2200/2514] | Loss: 0.0128
  Batch [2250/2514] | Loss: 0.0128
  Batch [2300/2514] | Loss: 0.0128
  Batch [2350/2514] | Loss: 0.0128
  Batch [2400/2514] | Loss: 0.0127
  Batch [2450/2514] | Loss: 0.0128
  Batch [2500/2514] | Loss: 0.0127

Train Results:
  Loss: 0.0128 | Dice: 0.6636 | Dice_pos: 0.4910 | Dice_neg: 0.8585 | IoU: 0.3860
  Per-Class Metrics:
    Class 1: Dice=0.9283, IoU=0.9283, Prec=1.0000, Recall=0.9283, ClsAcc=0.9283, ClsF1=0.7430
    Class 2: Dice=0.9809, IoU=0.9809, Prec=1.0000, Recall=0.9809, ClsAcc=0.9809, ClsF1=0.9252
    Class 3: Dice=0.7256, IoU=0.6781, Prec=0.8326, Recall=0.8133, ClsAcc=0.8663, ClsF1=0.7997
    Class 4: Dice=0.9507, IoU=0.9434, Prec=0.9658, Recall=0.9740, ClsAcc=0.9695, ClsF1=0.9069
  Time: 421.9s

================================================================================
Fold 3 | Epoch 12/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0136
  Batch [100/629] | Loss: 0.0149
  Batch [150/629] | Loss: 0.0153
  Batch [200/629] | Loss: 0.0148
  Batch [250/629] | Loss: 0.0144
  Batch [300/629] | Loss: 0.0139
  Batch [350/629] | Loss: 0.0141
  Batch [400/629] | Loss: 0.0137
  Batch [450/629] | Loss: 0.0139
  Batch [500/629] | Loss: 0.0144
  Batch [550/629] | Loss: 0.0144
  Batch [600/629] | Loss: 0.0142

Validation Results:
  Loss: 0.0142 | Dice: 0.6781 | Dice_pos: 0.4457 | Dice_neg: 0.9407 | IoU: 0.3534
  Per-Class Metrics:
    Class 1: Dice=0.9300, IoU=0.9300, Prec=1.0000, Recall=0.9300, ClsAcc=0.9300, ClsF1=0.7488
    Class 2: Dice=0.9781, IoU=0.9781, Prec=1.0000, Recall=0.9781, ClsAcc=0.9781, ClsF1=0.9141
    Class 3: Dice=0.7559, IoU=0.7094, Prec=0.8811, Recall=0.7987, ClsAcc=0.8935, ClsF1=0.8462
    Class 4: Dice=0.9481, IoU=0.9419, Prec=0.9933, Recall=0.9468, ClsAcc=0.9809, ClsF1=0.9329
  Time: 108.9s
  Saved checkpoint: outputs_20260112_125941/fold_3/checkpoint_epoch_12.pth
  *** New best model saved: outputs_20260112_125941/fold_3/best_model.pth ***

  Current LR: 5.00e-04 | Best Dice: 0.6781 | Best Loss: 0.0142

================================================================================
Fold 3 | Epoch 13/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0103
  Batch [100/2514] | Loss: 0.0133
  Batch [150/2514] | Loss: 0.0126
  Batch [200/2514] | Loss: 0.0118
  Batch [250/2514] | Loss: 0.0120
  Batch [300/2514] | Loss: 0.0120
  Batch [350/2514] | Loss: 0.0119
  Batch [400/2514] | Loss: 0.0121
  Batch [450/2514] | Loss: 0.0119
  Batch [500/2514] | Loss: 0.0118
  Batch [550/2514] | Loss: 0.0121
  Batch [600/2514] | Loss: 0.0120
  Batch [650/2514] | Loss: 0.0120
  Batch [700/2514] | Loss: 0.0119
  Batch [750/2514] | Loss: 0.0118
  Batch [800/2514] | Loss: 0.0116
  Batch [850/2514] | Loss: 0.0116
  Batch [900/2514] | Loss: 0.0115
  Batch [950/2514] | Loss: 0.0115
  Batch [1000/2514] | Loss: 0.0114
  Batch [1050/2514] | Loss: 0.0114
  Batch [1100/2514] | Loss: 0.0114
  Batch [1150/2514] | Loss: 0.0114
  Batch [1200/2514] | Loss: 0.0114
  Batch [1250/2514] | Loss: 0.0114
  Batch [1300/2514] | Loss: 0.0113
  Batch [1350/2514] | Loss: 0.0113
  Batch [1400/2514] | Loss: 0.0113
  Batch [1450/2514] | Loss: 0.0113
  Batch [1500/2514] | Loss: 0.0113
  Batch [1550/2514] | Loss: 0.0113
  Batch [1600/2514] | Loss: 0.0113
  Batch [1650/2514] | Loss: 0.0113
  Batch [1700/2514] | Loss: 0.0113
  Batch [1750/2514] | Loss: 0.0112
  Batch [1800/2514] | Loss: 0.0112
  Batch [1850/2514] | Loss: 0.0113
  Batch [1900/2514] | Loss: 0.0113
  Batch [1950/2514] | Loss: 0.0112
  Batch [2000/2514] | Loss: 0.0113
  Batch [2050/2514] | Loss: 0.0114
  Batch [2100/2514] | Loss: 0.0113
  Batch [2150/2514] | Loss: 0.0113
  Batch [2200/2514] | Loss: 0.0112
  Batch [2250/2514] | Loss: 0.0113
  Batch [2300/2514] | Loss: 0.0113
  Batch [2350/2514] | Loss: 0.0113
  Batch [2400/2514] | Loss: 0.0113
  Batch [2450/2514] | Loss: 0.0113
  Batch [2500/2514] | Loss: 0.0113

Train Results:
  Loss: 0.0113 | Dice: 0.6946 | Dice_pos: 0.5264 | Dice_neg: 0.8846 | IoU: 0.4218
  Per-Class Metrics:
    Class 1: Dice=0.9283, IoU=0.9283, Prec=1.0000, Recall=0.9283, ClsAcc=0.9283, ClsF1=0.7411
    Class 2: Dice=0.9809, IoU=0.9809, Prec=1.0000, Recall=0.9809, ClsAcc=0.9809, ClsF1=0.9280
    Class 3: Dice=0.7536, IoU=0.7053, Prec=0.8466, Recall=0.8293, ClsAcc=0.8847, ClsF1=0.8223
    Class 4: Dice=0.9627, IoU=0.9553, Prec=0.9740, Recall=0.9780, ClsAcc=0.9801, ClsF1=0.9404
  Time: 431.6s

================================================================================
Fold 3 | Epoch 13/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0125
  Batch [100/629] | Loss: 0.0129
  Batch [150/629] | Loss: 0.0134
  Batch [200/629] | Loss: 0.0129
  Batch [250/629] | Loss: 0.0127
  Batch [300/629] | Loss: 0.0123
  Batch [350/629] | Loss: 0.0126
  Batch [400/629] | Loss: 0.0123
  Batch [450/629] | Loss: 0.0125
  Batch [500/629] | Loss: 0.0128
  Batch [550/629] | Loss: 0.0128
  Batch [600/629] | Loss: 0.0127

Validation Results:
  Loss: 0.0126 | Dice: 0.6652 | Dice_pos: 0.5428 | Dice_neg: 0.8034 | IoU: 0.4408
  Per-Class Metrics:
    Class 1: Dice=0.9300, IoU=0.9300, Prec=1.0000, Recall=0.9300, ClsAcc=0.9300, ClsF1=0.7488
    Class 2: Dice=0.9781, IoU=0.9781, Prec=1.0000, Recall=0.9781, ClsAcc=0.9781, ClsF1=0.9141
    Class 3: Dice=0.7402, IoU=0.6898, Prec=0.8055, Recall=0.8525, ClsAcc=0.8684, ClsF1=0.8267
    Class 4: Dice=0.9220, IoU=0.9134, Prec=0.9389, Recall=0.9706, ClsAcc=0.9436, ClsF1=0.8158
  Time: 113.5s
  Saved checkpoint: outputs_20260112_125941/fold_3/checkpoint_epoch_13.pth

  Current LR: 2.50e-04 | Best Dice: 0.6781 | Best Loss: 0.0142

================================================================================
Fold 3 | Epoch 14/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0072
  Batch [100/2514] | Loss: 0.0080
  Batch [150/2514] | Loss: 0.0090
  Batch [200/2514] | Loss: 0.0100
  Batch [250/2514] | Loss: 0.0100
  Batch [300/2514] | Loss: 0.0100
  Batch [350/2514] | Loss: 0.0099
  Batch [400/2514] | Loss: 0.0097
  Batch [450/2514] | Loss: 0.0096
  Batch [500/2514] | Loss: 0.0097
  Batch [550/2514] | Loss: 0.0098
  Batch [600/2514] | Loss: 0.0100
  Batch [650/2514] | Loss: 0.0101
  Batch [700/2514] | Loss: 0.0101
  Batch [750/2514] | Loss: 0.0101
  Batch [800/2514] | Loss: 0.0103
  Batch [850/2514] | Loss: 0.0103
  Batch [900/2514] | Loss: 0.0103
  Batch [950/2514] | Loss: 0.0103
  Batch [1000/2514] | Loss: 0.0104
  Batch [1050/2514] | Loss: 0.0104
  Batch [1100/2514] | Loss: 0.0104
  Batch [1150/2514] | Loss: 0.0105
  Batch [1200/2514] | Loss: 0.0105
  Batch [1250/2514] | Loss: 0.0106
  Batch [1300/2514] | Loss: 0.0105
  Batch [1350/2514] | Loss: 0.0105
  Batch [1400/2514] | Loss: 0.0105
  Batch [1450/2514] | Loss: 0.0105
  Batch [1500/2514] | Loss: 0.0105
  Batch [1550/2514] | Loss: 0.0107
  Batch [1600/2514] | Loss: 0.0107
  Batch [1650/2514] | Loss: 0.0108
  Batch [1700/2514] | Loss: 0.0109
  Batch [1750/2514] | Loss: 0.0109
  Batch [1800/2514] | Loss: 0.0109
  Batch [1850/2514] | Loss: 0.0109
  Batch [1900/2514] | Loss: 0.0110
  Batch [1950/2514] | Loss: 0.0109
  Batch [2000/2514] | Loss: 0.0109
  Batch [2050/2514] | Loss: 0.0109
  Batch [2100/2514] | Loss: 0.0109
  Batch [2150/2514] | Loss: 0.0109
  Batch [2200/2514] | Loss: 0.0109
  Batch [2250/2514] | Loss: 0.0109
  Batch [2300/2514] | Loss: 0.0109
  Batch [2350/2514] | Loss: 0.0109
  Batch [2400/2514] | Loss: 0.0109
  Batch [2450/2514] | Loss: 0.0108
  Batch [2500/2514] | Loss: 0.0108

Train Results:
  Loss: 0.0108 | Dice: 0.7033 | Dice_pos: 0.5334 | Dice_neg: 0.8952 | IoU: 0.4301
  Per-Class Metrics:
    Class 1: Dice=0.9283, IoU=0.9283, Prec=1.0000, Recall=0.9283, ClsAcc=0.9283, ClsF1=0.7474
    Class 2: Dice=0.9809, IoU=0.9809, Prec=1.0000, Recall=0.9809, ClsAcc=0.9809, ClsF1=0.9248
    Class 3: Dice=0.7630, IoU=0.7146, Prec=0.8525, Recall=0.8332, ClsAcc=0.8902, ClsF1=0.8259
    Class 4: Dice=0.9639, IoU=0.9565, Prec=0.9740, Recall=0.9795, ClsAcc=0.9805, ClsF1=0.9395
  Time: 437.2s

================================================================================
Fold 3 | Epoch 14/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0128
  Batch [100/629] | Loss: 0.0136
  Batch [150/629] | Loss: 0.0144
  Batch [200/629] | Loss: 0.0139
  Batch [250/629] | Loss: 0.0139
  Batch [300/629] | Loss: 0.0136
  Batch [350/629] | Loss: 0.0140
  Batch [400/629] | Loss: 0.0135
  Batch [450/629] | Loss: 0.0138
  Batch [500/629] | Loss: 0.0142
  Batch [550/629] | Loss: 0.0142
  Batch [600/629] | Loss: 0.0141

Validation Results:
  Loss: 0.0140 | Dice: 0.6429 | Dice_pos: 0.3681 | Dice_neg: 0.9534 | IoU: 0.2727
  Per-Class Metrics:
    Class 1: Dice=0.9300, IoU=0.9300, Prec=1.0000, Recall=0.9300, ClsAcc=0.9300, ClsF1=0.7488
    Class 2: Dice=0.9781, IoU=0.9781, Prec=1.0000, Recall=0.9781, ClsAcc=0.9781, ClsF1=0.9141
    Class 3: Dice=0.7247, IoU=0.6782, Prec=0.9340, Recall=0.7199, ClsAcc=0.9078, ClsF1=0.8510
    Class 4: Dice=0.9586, IoU=0.9501, Prec=0.9818, Recall=0.9652, ClsAcc=0.9837, ClsF1=0.9448
  Time: 107.6s
  Saved checkpoint: outputs_20260112_125941/fold_3/checkpoint_epoch_14.pth

  Current LR: 2.50e-04 | Best Dice: 0.6781 | Best Loss: 0.0142

================================================================================
Fold 3 | Epoch 15/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0128
  Batch [100/2514] | Loss: 0.0108
  Batch [150/2514] | Loss: 0.0108
  Batch [200/2514] | Loss: 0.0102
  Batch [250/2514] | Loss: 0.0105
  Batch [300/2514] | Loss: 0.0108
  Batch [350/2514] | Loss: 0.0105
  Batch [400/2514] | Loss: 0.0105
  Batch [450/2514] | Loss: 0.0103
  Batch [500/2514] | Loss: 0.0101
  Batch [550/2514] | Loss: 0.0102
  Batch [600/2514] | Loss: 0.0104
  Batch [650/2514] | Loss: 0.0103
  Batch [700/2514] | Loss: 0.0103
  Batch [750/2514] | Loss: 0.0103
  Batch [800/2514] | Loss: 0.0101
  Batch [850/2514] | Loss: 0.0101
  Batch [900/2514] | Loss: 0.0100
  Batch [950/2514] | Loss: 0.0100
  Batch [1000/2514] | Loss: 0.0100
  Batch [1050/2514] | Loss: 0.0101
  Batch [1100/2514] | Loss: 0.0100
  Batch [1150/2514] | Loss: 0.0101
  Batch [1200/2514] | Loss: 0.0101
  Batch [1250/2514] | Loss: 0.0102
  Batch [1300/2514] | Loss: 0.0102
  Batch [1350/2514] | Loss: 0.0102
  Batch [1400/2514] | Loss: 0.0102
  Batch [1450/2514] | Loss: 0.0101
  Batch [1500/2514] | Loss: 0.0102
  Batch [1550/2514] | Loss: 0.0102
  Batch [1600/2514] | Loss: 0.0102
  Batch [1650/2514] | Loss: 0.0103
  Batch [1700/2514] | Loss: 0.0104
  Batch [1750/2514] | Loss: 0.0103
  Batch [1800/2514] | Loss: 0.0104
  Batch [1850/2514] | Loss: 0.0105
  Batch [1900/2514] | Loss: 0.0105
  Batch [1950/2514] | Loss: 0.0105
  Batch [2000/2514] | Loss: 0.0105
  Batch [2050/2514] | Loss: 0.0105
  Batch [2100/2514] | Loss: 0.0106
  Batch [2150/2514] | Loss: 0.0106
  Batch [2200/2514] | Loss: 0.0106
  Batch [2250/2514] | Loss: 0.0106
  Batch [2300/2514] | Loss: 0.0106
  Batch [2350/2514] | Loss: 0.0106
  Batch [2400/2514] | Loss: 0.0106
  Batch [2450/2514] | Loss: 0.0105
  Batch [2500/2514] | Loss: 0.0106

Train Results:
  Loss: 0.0106 | Dice: 0.7065 | Dice_pos: 0.5394 | Dice_neg: 0.8952 | IoU: 0.4341
  Per-Class Metrics:
    Class 1: Dice=0.9283, IoU=0.9283, Prec=0.9999, Recall=0.9283, ClsAcc=0.9286, ClsF1=0.7422
    Class 2: Dice=0.9809, IoU=0.9809, Prec=1.0000, Recall=0.9809, ClsAcc=0.9809, ClsF1=0.9256
    Class 3: Dice=0.7672, IoU=0.7189, Prec=0.8525, Recall=0.8375, ClsAcc=0.8935, ClsF1=0.8339
    Class 4: Dice=0.9651, IoU=0.9575, Prec=0.9753, Recall=0.9791, ClsAcc=0.9817, ClsF1=0.9408
  Time: 431.3s

================================================================================
Fold 3 | Epoch 15/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0125
  Batch [100/629] | Loss: 0.0133
  Batch [150/629] | Loss: 0.0139
  Batch [200/629] | Loss: 0.0132
  Batch [250/629] | Loss: 0.0129
  Batch [300/629] | Loss: 0.0125
  Batch [350/629] | Loss: 0.0128
  Batch [400/629] | Loss: 0.0124
  Batch [450/629] | Loss: 0.0127
  Batch [500/629] | Loss: 0.0130
  Batch [550/629] | Loss: 0.0130
  Batch [600/629] | Loss: 0.0128

Validation Results:
  Loss: 0.0127 | Dice: 0.6900 | Dice_pos: 0.4771 | Dice_neg: 0.9305 | IoU: 0.3803
  Per-Class Metrics:
    Class 1: Dice=0.9300, IoU=0.9300, Prec=1.0000, Recall=0.9300, ClsAcc=0.9300, ClsF1=0.7488
    Class 2: Dice=0.9781, IoU=0.9781, Prec=1.0000, Recall=0.9781, ClsAcc=0.9781, ClsF1=0.9141
    Class 3: Dice=0.7810, IoU=0.7345, Prec=0.9078, Recall=0.7995, ClsAcc=0.9177, ClsF1=0.8744
    Class 4: Dice=0.9419, IoU=0.9333, Prec=0.9701, Recall=0.9606, ClsAcc=0.9690, ClsF1=0.8886
  Time: 90.6s
  Saved checkpoint: outputs_20260112_125941/fold_3/checkpoint_epoch_15.pth
  *** New best model saved: outputs_20260112_125941/fold_3/best_model.pth ***

  Current LR: 2.50e-04 | Best Dice: 0.6900 | Best Loss: 0.0127

================================================================================
Fold 3 | Epoch 16/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0095
  Batch [100/2514] | Loss: 0.0093
  Batch [150/2514] | Loss: 0.0095
  Batch [200/2514] | Loss: 0.0098
  Batch [250/2514] | Loss: 0.0095
  Batch [300/2514] | Loss: 0.0094
  Batch [350/2514] | Loss: 0.0093
  Batch [400/2514] | Loss: 0.0095
  Batch [450/2514] | Loss: 0.0096
  Batch [500/2514] | Loss: 0.0096
  Batch [550/2514] | Loss: 0.0095
  Batch [600/2514] | Loss: 0.0096
  Batch [650/2514] | Loss: 0.0096
  Batch [700/2514] | Loss: 0.0095
  Batch [750/2514] | Loss: 0.0096
  Batch [800/2514] | Loss: 0.0097
  Batch [850/2514] | Loss: 0.0097
  Batch [900/2514] | Loss: 0.0099
  Batch [950/2514] | Loss: 0.0099
  Batch [1000/2514] | Loss: 0.0101
  Batch [1050/2514] | Loss: 0.0101
  Batch [1100/2514] | Loss: 0.0102
  Batch [1150/2514] | Loss: 0.0103
  Batch [1200/2514] | Loss: 0.0103
  Batch [1250/2514] | Loss: 0.0103
  Batch [1300/2514] | Loss: 0.0103
  Batch [1350/2514] | Loss: 0.0104
  Batch [1400/2514] | Loss: 0.0103
  Batch [1450/2514] | Loss: 0.0102
  Batch [1500/2514] | Loss: 0.0102
  Batch [1550/2514] | Loss: 0.0103
  Batch [1600/2514] | Loss: 0.0103
  Batch [1650/2514] | Loss: 0.0104
  Batch [1700/2514] | Loss: 0.0104
  Batch [1750/2514] | Loss: 0.0104
  Batch [1800/2514] | Loss: 0.0104
  Batch [1850/2514] | Loss: 0.0104
  Batch [1900/2514] | Loss: 0.0104
  Batch [1950/2514] | Loss: 0.0105
  Batch [2000/2514] | Loss: 0.0105
  Batch [2050/2514] | Loss: 0.0105
  Batch [2100/2514] | Loss: 0.0105
  Batch [2150/2514] | Loss: 0.0105
  Batch [2200/2514] | Loss: 0.0105
  Batch [2250/2514] | Loss: 0.0105
  Batch [2300/2514] | Loss: 0.0105
  Batch [2350/2514] | Loss: 0.0105
  Batch [2400/2514] | Loss: 0.0105
  Batch [2450/2514] | Loss: 0.0104
  Batch [2500/2514] | Loss: 0.0104

Train Results:
  Loss: 0.0104 | Dice: 0.7127 | Dice_pos: 0.5557 | Dice_neg: 0.8901 | IoU: 0.4483
  Per-Class Metrics:
    Class 1: Dice=0.9245, IoU=0.9226, Prec=0.9884, Recall=0.9322, ClsAcc=0.9431, ClsF1=0.7960
    Class 2: Dice=0.9809, IoU=0.9809, Prec=1.0000, Recall=0.9809, ClsAcc=0.9809, ClsF1=0.9260
    Class 3: Dice=0.7673, IoU=0.7185, Prec=0.8490, Recall=0.8408, ClsAcc=0.8953, ClsF1=0.8383
    Class 4: Dice=0.9674, IoU=0.9597, Prec=0.9769, Recall=0.9798, ClsAcc=0.9839, ClsF1=0.9555
  Time: 425.3s

================================================================================
Fold 3 | Epoch 16/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0131
  Batch [100/629] | Loss: 0.0142
  Batch [150/629] | Loss: 0.0148
  Batch [200/629] | Loss: 0.0142
  Batch [250/629] | Loss: 0.0139
  Batch [300/629] | Loss: 0.0136
  Batch [350/629] | Loss: 0.0138
  Batch [400/629] | Loss: 0.0133
  Batch [450/629] | Loss: 0.0137
  Batch [500/629] | Loss: 0.0141
  Batch [550/629] | Loss: 0.0140
  Batch [600/629] | Loss: 0.0139

Validation Results:
  Loss: 0.0138 | Dice: 0.6801 | Dice_pos: 0.4306 | Dice_neg: 0.9619 | IoU: 0.3311
  Per-Class Metrics:
    Class 1: Dice=0.9261, IoU=0.9238, Prec=0.9885, Recall=0.9343, ClsAcc=0.9539, ClsF1=0.8365
    Class 2: Dice=0.9781, IoU=0.9781, Prec=1.0000, Recall=0.9781, ClsAcc=0.9781, ClsF1=0.9141
    Class 3: Dice=0.7541, IoU=0.7064, Prec=0.9232, Recall=0.7590, ClsAcc=0.9126, ClsF1=0.8659
    Class 4: Dice=0.9580, IoU=0.9503, Prec=0.9924, Recall=0.9560, ClsAcc=0.9857, ClsF1=0.9509
  Time: 95.5s
  Saved checkpoint: outputs_20260112_125941/fold_3/checkpoint_epoch_16.pth

  Current LR: 2.50e-04 | Best Dice: 0.6900 | Best Loss: 0.0127

================================================================================
Fold 3 | Epoch 17/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0087
  Batch [100/2514] | Loss: 0.0087
  Batch [150/2514] | Loss: 0.0084
  Batch [200/2514] | Loss: 0.0084
  Batch [250/2514] | Loss: 0.0089
  Batch [300/2514] | Loss: 0.0093
  Batch [350/2514] | Loss: 0.0090
  Batch [400/2514] | Loss: 0.0089
  Batch [450/2514] | Loss: 0.0093
  Batch [500/2514] | Loss: 0.0093
  Batch [550/2514] | Loss: 0.0094
  Batch [600/2514] | Loss: 0.0096
  Batch [650/2514] | Loss: 0.0098
  Batch [700/2514] | Loss: 0.0097
  Batch [750/2514] | Loss: 0.0098
  Batch [800/2514] | Loss: 0.0096
  Batch [850/2514] | Loss: 0.0096
  Batch [900/2514] | Loss: 0.0095
  Batch [950/2514] | Loss: 0.0097
  Batch [1000/2514] | Loss: 0.0098
  Batch [1050/2514] | Loss: 0.0097
  Batch [1100/2514] | Loss: 0.0098
  Batch [1150/2514] | Loss: 0.0099
  Batch [1200/2514] | Loss: 0.0099
  Batch [1250/2514] | Loss: 0.0098
  Batch [1300/2514] | Loss: 0.0098
  Batch [1350/2514] | Loss: 0.0098
  Batch [1400/2514] | Loss: 0.0098
  Batch [1450/2514] | Loss: 0.0099
  Batch [1500/2514] | Loss: 0.0100
  Batch [1550/2514] | Loss: 0.0099
  Batch [1600/2514] | Loss: 0.0099
  Batch [1650/2514] | Loss: 0.0100
  Batch [1700/2514] | Loss: 0.0100
  Batch [1750/2514] | Loss: 0.0100
  Batch [1800/2514] | Loss: 0.0100
  Batch [1850/2514] | Loss: 0.0100
  Batch [1900/2514] | Loss: 0.0100
  Batch [1950/2514] | Loss: 0.0100
  Batch [2000/2514] | Loss: 0.0101
  Batch [2050/2514] | Loss: 0.0101
  Batch [2100/2514] | Loss: 0.0101
  Batch [2150/2514] | Loss: 0.0101
  Batch [2200/2514] | Loss: 0.0101
  Batch [2250/2514] | Loss: 0.0101
  Batch [2300/2514] | Loss: 0.0102
  Batch [2350/2514] | Loss: 0.0102
  Batch [2400/2514] | Loss: 0.0101
  Batch [2450/2514] | Loss: 0.0101
  Batch [2500/2514] | Loss: 0.0101

Train Results:
  Loss: 0.0101 | Dice: 0.7195 | Dice_pos: 0.5738 | Dice_neg: 0.8842 | IoU: 0.4590
  Per-Class Metrics:
    Class 1: Dice=0.9166, IoU=0.9118, Prec=0.9689, Recall=0.9391, ClsAcc=0.9464, ClsF1=0.8185
    Class 2: Dice=0.9809, IoU=0.9809, Prec=1.0000, Recall=0.9809, ClsAcc=0.9809, ClsF1=0.9256
    Class 3: Dice=0.7722, IoU=0.7238, Prec=0.8551, Recall=0.8410, ClsAcc=0.8972, ClsF1=0.8383
    Class 4: Dice=0.9673, IoU=0.9599, Prec=0.9768, Recall=0.9803, ClsAcc=0.9831, ClsF1=0.9499
  Time: 422.0s

================================================================================
Fold 3 | Epoch 17/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0120
  Batch [100/629] | Loss: 0.0126
  Batch [150/629] | Loss: 0.0133
  Batch [200/629] | Loss: 0.0126
  Batch [250/629] | Loss: 0.0124
  Batch [300/629] | Loss: 0.0121
  Batch [350/629] | Loss: 0.0123
  Batch [400/629] | Loss: 0.0119
  Batch [450/629] | Loss: 0.0124
  Batch [500/629] | Loss: 0.0127
  Batch [550/629] | Loss: 0.0127
  Batch [600/629] | Loss: 0.0125

Validation Results:
  Loss: 0.0124 | Dice: 0.7240 | Dice_pos: 0.5502 | Dice_neg: 0.9203 | IoU: 0.4389
  Per-Class Metrics:
    Class 1: Dice=0.8822, IoU=0.8744, Prec=0.9173, Recall=0.9512, ClsAcc=0.9153, ClsF1=0.7446
    Class 2: Dice=0.9781, IoU=0.9781, Prec=1.0000, Recall=0.9781, ClsAcc=0.9781, ClsF1=0.9141
    Class 3: Dice=0.7882, IoU=0.7417, Prec=0.9032, Recall=0.8121, ClsAcc=0.9161, ClsF1=0.8764
    Class 4: Dice=0.9621, IoU=0.9537, Prec=0.9788, Recall=0.9715, ClsAcc=0.9821, ClsF1=0.9377
  Time: 89.2s
  Saved checkpoint: outputs_20260112_125941/fold_3/checkpoint_epoch_17.pth
  *** New best model saved: outputs_20260112_125941/fold_3/best_model.pth ***

  Current LR: 2.50e-04 | Best Dice: 0.7240 | Best Loss: 0.0124

================================================================================
Fold 3 | Epoch 18/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0110
  Batch [100/2514] | Loss: 0.0103
  Batch [150/2514] | Loss: 0.0098
  Batch [200/2514] | Loss: 0.0101
  Batch [250/2514] | Loss: 0.0102
  Batch [300/2514] | Loss: 0.0104
  Batch [350/2514] | Loss: 0.0105
  Batch [400/2514] | Loss: 0.0103
  Batch [450/2514] | Loss: 0.0101
  Batch [500/2514] | Loss: 0.0099
  Batch [550/2514] | Loss: 0.0100
  Batch [600/2514] | Loss: 0.0099
  Batch [650/2514] | Loss: 0.0100
  Batch [700/2514] | Loss: 0.0101
  Batch [750/2514] | Loss: 0.0099
  Batch [800/2514] | Loss: 0.0099
  Batch [850/2514] | Loss: 0.0097
  Batch [900/2514] | Loss: 0.0096
  Batch [950/2514] | Loss: 0.0098
  Batch [1000/2514] | Loss: 0.0098
  Batch [1050/2514] | Loss: 0.0098
  Batch [1100/2514] | Loss: 0.0098
  Batch [1150/2514] | Loss: 0.0098
  Batch [1200/2514] | Loss: 0.0099
  Batch [1250/2514] | Loss: 0.0098
  Batch [1300/2514] | Loss: 0.0098
  Batch [1350/2514] | Loss: 0.0098
  Batch [1400/2514] | Loss: 0.0098
  Batch [1450/2514] | Loss: 0.0098
  Batch [1500/2514] | Loss: 0.0098
  Batch [1550/2514] | Loss: 0.0097
  Batch [1600/2514] | Loss: 0.0097
  Batch [1650/2514] | Loss: 0.0096
  Batch [1700/2514] | Loss: 0.0096
  Batch [1750/2514] | Loss: 0.0096
  Batch [1800/2514] | Loss: 0.0097
  Batch [1850/2514] | Loss: 0.0098
  Batch [1900/2514] | Loss: 0.0098
  Batch [1950/2514] | Loss: 0.0097
  Batch [2000/2514] | Loss: 0.0098
  Batch [2050/2514] | Loss: 0.0098
  Batch [2100/2514] | Loss: 0.0099
  Batch [2150/2514] | Loss: 0.0099
  Batch [2200/2514] | Loss: 0.0099
  Batch [2250/2514] | Loss: 0.0099
  Batch [2300/2514] | Loss: 0.0098
  Batch [2350/2514] | Loss: 0.0099
  Batch [2400/2514] | Loss: 0.0099
  Batch [2450/2514] | Loss: 0.0099
  Batch [2500/2514] | Loss: 0.0099

Train Results:
  Loss: 0.0099 | Dice: 0.7274 | Dice_pos: 0.5864 | Dice_neg: 0.8867 | IoU: 0.4720
  Per-Class Metrics:
    Class 1: Dice=0.9101, IoU=0.9045, Prec=0.9567, Recall=0.9423, ClsAcc=0.9416, ClsF1=0.8067
    Class 2: Dice=0.9809, IoU=0.9809, Prec=1.0000, Recall=0.9809, ClsAcc=0.9809, ClsF1=0.9264
    Class 3: Dice=0.7794, IoU=0.7309, Prec=0.8583, Recall=0.8440, ClsAcc=0.9019, ClsF1=0.8444
    Class 4: Dice=0.9712, IoU=0.9638, Prec=0.9799, Recall=0.9811, ClsAcc=0.9869, ClsF1=0.9586
  Time: 419.4s

================================================================================
Fold 3 | Epoch 18/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0123
  Batch [100/629] | Loss: 0.0130
  Batch [150/629] | Loss: 0.0139
  Batch [200/629] | Loss: 0.0130
  Batch [250/629] | Loss: 0.0128
  Batch [300/629] | Loss: 0.0124
  Batch [350/629] | Loss: 0.0126
  Batch [400/629] | Loss: 0.0122
  Batch [450/629] | Loss: 0.0126
  Batch [500/629] | Loss: 0.0129
  Batch [550/629] | Loss: 0.0128
  Batch [600/629] | Loss: 0.0127

Validation Results:
  Loss: 0.0126 | Dice: 0.7055 | Dice_pos: 0.5288 | Dice_neg: 0.9051 | IoU: 0.4199
  Per-Class Metrics:
    Class 1: Dice=0.9264, IoU=0.9205, Prec=0.9735, Recall=0.9434, ClsAcc=0.9591, ClsF1=0.8606
    Class 2: Dice=0.9781, IoU=0.9781, Prec=1.0000, Recall=0.9781, ClsAcc=0.9781, ClsF1=0.9141
    Class 3: Dice=0.7710, IoU=0.7236, Prec=0.8917, Recall=0.8055, ClsAcc=0.9082, ClsF1=0.8724
    Class 4: Dice=0.9489, IoU=0.9404, Prec=0.9727, Recall=0.9648, ClsAcc=0.9726, ClsF1=0.9079
  Time: 91.9s
  Saved checkpoint: outputs_20260112_125941/fold_3/checkpoint_epoch_18.pth

  Current LR: 2.50e-04 | Best Dice: 0.7240 | Best Loss: 0.0124

================================================================================
Fold 3 | Epoch 19/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0084
  Batch [100/2514] | Loss: 0.0094
  Batch [150/2514] | Loss: 0.0093
  Batch [200/2514] | Loss: 0.0090
  Batch [250/2514] | Loss: 0.0088
  Batch [300/2514] | Loss: 0.0093
  Batch [350/2514] | Loss: 0.0094
  Batch [400/2514] | Loss: 0.0096
  Batch [450/2514] | Loss: 0.0095
  Batch [500/2514] | Loss: 0.0097
  Batch [550/2514] | Loss: 0.0098
  Batch [600/2514] | Loss: 0.0097
  Batch [650/2514] | Loss: 0.0096
  Batch [700/2514] | Loss: 0.0095
  Batch [750/2514] | Loss: 0.0096
  Batch [800/2514] | Loss: 0.0096
  Batch [850/2514] | Loss: 0.0095
  Batch [900/2514] | Loss: 0.0096
  Batch [950/2514] | Loss: 0.0096
  Batch [1000/2514] | Loss: 0.0095
  Batch [1050/2514] | Loss: 0.0095
  Batch [1100/2514] | Loss: 0.0096
  Batch [1150/2514] | Loss: 0.0097
  Batch [1200/2514] | Loss: 0.0096
  Batch [1250/2514] | Loss: 0.0096
  Batch [1300/2514] | Loss: 0.0096
  Batch [1350/2514] | Loss: 0.0096
  Batch [1400/2514] | Loss: 0.0095
  Batch [1450/2514] | Loss: 0.0095
  Batch [1500/2514] | Loss: 0.0095
  Batch [1550/2514] | Loss: 0.0096
  Batch [1600/2514] | Loss: 0.0095
  Batch [1650/2514] | Loss: 0.0095
  Batch [1700/2514] | Loss: 0.0095
  Batch [1750/2514] | Loss: 0.0095
  Batch [1800/2514] | Loss: 0.0095
  Batch [1850/2514] | Loss: 0.0096
  Batch [1900/2514] | Loss: 0.0095
  Batch [1950/2514] | Loss: 0.0096
  Batch [2000/2514] | Loss: 0.0096
  Batch [2050/2514] | Loss: 0.0096
  Batch [2100/2514] | Loss: 0.0096
  Batch [2150/2514] | Loss: 0.0097
  Batch [2200/2514] | Loss: 0.0097
  Batch [2250/2514] | Loss: 0.0098
  Batch [2300/2514] | Loss: 0.0097
  Batch [2350/2514] | Loss: 0.0098
  Batch [2400/2514] | Loss: 0.0098
  Batch [2450/2514] | Loss: 0.0099
  Batch [2500/2514] | Loss: 0.0099

Train Results:
  Loss: 0.0099 | Dice: 0.7259 | Dice_pos: 0.5868 | Dice_neg: 0.8831 | IoU: 0.4714
  Per-Class Metrics:
    Class 1: Dice=0.9121, IoU=0.9064, Prec=0.9592, Recall=0.9427, ClsAcc=0.9434, ClsF1=0.8090
    Class 2: Dice=0.9809, IoU=0.9809, Prec=1.0000, Recall=0.9809, ClsAcc=0.9809, ClsF1=0.9260
    Class 3: Dice=0.7775, IoU=0.7288, Prec=0.8554, Recall=0.8447, ClsAcc=0.9020, ClsF1=0.8423
    Class 4: Dice=0.9700, IoU=0.9626, Prec=0.9787, Recall=0.9813, ClsAcc=0.9849, ClsF1=0.9529
  Time: 432.4s

================================================================================
Fold 3 | Epoch 19/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0129
  Batch [100/629] | Loss: 0.0137
  Batch [150/629] | Loss: 0.0143
  Batch [200/629] | Loss: 0.0138
  Batch [250/629] | Loss: 0.0135
  Batch [300/629] | Loss: 0.0131
  Batch [350/629] | Loss: 0.0133
  Batch [400/629] | Loss: 0.0129
  Batch [450/629] | Loss: 0.0132
  Batch [500/629] | Loss: 0.0136
  Batch [550/629] | Loss: 0.0136
  Batch [600/629] | Loss: 0.0134

Validation Results:
  Loss: 0.0133 | Dice: 0.6873 | Dice_pos: 0.4975 | Dice_neg: 0.9017 | IoU: 0.3864
  Per-Class Metrics:
    Class 1: Dice=0.9279, IoU=0.9225, Prec=0.9759, Recall=0.9423, ClsAcc=0.9587, ClsF1=0.8551
    Class 2: Dice=0.9781, IoU=0.9781, Prec=1.0000, Recall=0.9781, ClsAcc=0.9781, ClsF1=0.9141
    Class 3: Dice=0.7503, IoU=0.6999, Prec=0.8671, Recall=0.8047, ClsAcc=0.8927, ClsF1=0.8433
    Class 4: Dice=0.9502, IoU=0.9435, Prec=0.9961, Recall=0.9465, ClsAcc=0.9849, ClsF1=0.9477
  Time: 94.3s
  Saved checkpoint: outputs_20260112_125941/fold_3/checkpoint_epoch_19.pth

  Current LR: 2.50e-04 | Best Dice: 0.7240 | Best Loss: 0.0124

================================================================================
Fold 3 | Epoch 20/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0097
  Batch [100/2514] | Loss: 0.0099
  Batch [150/2514] | Loss: 0.0101
  Batch [200/2514] | Loss: 0.0099
  Batch [250/2514] | Loss: 0.0099
  Batch [300/2514] | Loss: 0.0095
  Batch [350/2514] | Loss: 0.0094
  Batch [400/2514] | Loss: 0.0094
  Batch [450/2514] | Loss: 0.0094
  Batch [500/2514] | Loss: 0.0094
  Batch [550/2514] | Loss: 0.0094
  Batch [600/2514] | Loss: 0.0094
  Batch [650/2514] | Loss: 0.0094
  Batch [700/2514] | Loss: 0.0093
  Batch [750/2514] | Loss: 0.0092
  Batch [800/2514] | Loss: 0.0092
  Batch [850/2514] | Loss: 0.0091
  Batch [900/2514] | Loss: 0.0092
  Batch [950/2514] | Loss: 0.0092
  Batch [1000/2514] | Loss: 0.0092
  Batch [1050/2514] | Loss: 0.0092
  Batch [1100/2514] | Loss: 0.0092
  Batch [1150/2514] | Loss: 0.0093
  Batch [1200/2514] | Loss: 0.0093
  Batch [1250/2514] | Loss: 0.0094
  Batch [1300/2514] | Loss: 0.0095
  Batch [1350/2514] | Loss: 0.0095
  Batch [1400/2514] | Loss: 0.0095
  Batch [1450/2514] | Loss: 0.0096
  Batch [1500/2514] | Loss: 0.0095
  Batch [1550/2514] | Loss: 0.0095
  Batch [1600/2514] | Loss: 0.0095
  Batch [1650/2514] | Loss: 0.0095
  Batch [1700/2514] | Loss: 0.0095
  Batch [1750/2514] | Loss: 0.0095
  Batch [1800/2514] | Loss: 0.0095
  Batch [1850/2514] | Loss: 0.0095
  Batch [1900/2514] | Loss: 0.0095
  Batch [1950/2514] | Loss: 0.0095
  Batch [2000/2514] | Loss: 0.0095
  Batch [2050/2514] | Loss: 0.0095
  Batch [2100/2514] | Loss: 0.0094
  Batch [2150/2514] | Loss: 0.0095
  Batch [2200/2514] | Loss: 0.0094
  Batch [2250/2514] | Loss: 0.0095
  Batch [2300/2514] | Loss: 0.0095
  Batch [2350/2514] | Loss: 0.0095
  Batch [2400/2514] | Loss: 0.0095
  Batch [2450/2514] | Loss: 0.0095
  Batch [2500/2514] | Loss: 0.0095

Train Results:
  Loss: 0.0095 | Dice: 0.7374 | Dice_pos: 0.6003 | Dice_neg: 0.8922 | IoU: 0.4857
  Per-Class Metrics:
    Class 1: Dice=0.9166, IoU=0.9099, Prec=0.9576, Recall=0.9472, ClsAcc=0.9467, ClsF1=0.8242
    Class 2: Dice=0.9809, IoU=0.9809, Prec=1.0000, Recall=0.9809, ClsAcc=0.9809, ClsF1=0.9272
    Class 3: Dice=0.7846, IoU=0.7357, Prec=0.8609, Recall=0.8475, ClsAcc=0.9057, ClsF1=0.8523
    Class 4: Dice=0.9730, IoU=0.9656, Prec=0.9820, Recall=0.9808, ClsAcc=0.9880, ClsF1=0.9652
  Time: 437.7s

================================================================================
Fold 3 | Epoch 20/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0124
  Batch [100/629] | Loss: 0.0135
  Batch [150/629] | Loss: 0.0142
  Batch [200/629] | Loss: 0.0135
  Batch [250/629] | Loss: 0.0133
  Batch [300/629] | Loss: 0.0130
  Batch [350/629] | Loss: 0.0133
  Batch [400/629] | Loss: 0.0129
  Batch [450/629] | Loss: 0.0134
  Batch [500/629] | Loss: 0.0138
  Batch [550/629] | Loss: 0.0138
  Batch [600/629] | Loss: 0.0137

Validation Results:
  Loss: 0.0135 | Dice: 0.6937 | Dice_pos: 0.5172 | Dice_neg: 0.8932 | IoU: 0.4101
  Per-Class Metrics:
    Class 1: Dice=0.9103, IoU=0.9052, Prec=0.9633, Recall=0.9401, ClsAcc=0.9448, ClsF1=0.8214
    Class 2: Dice=0.9781, IoU=0.9781, Prec=1.0000, Recall=0.9781, ClsAcc=0.9781, ClsF1=0.9141
    Class 3: Dice=0.7768, IoU=0.7292, Prec=0.8894, Recall=0.8106, ClsAcc=0.9138, ClsF1=0.8728
    Class 4: Dice=0.9423, IoU=0.9337, Prec=0.9710, Recall=0.9599, ClsAcc=0.9702, ClsF1=0.9000
  Time: 94.6s
  Saved checkpoint: outputs_20260112_125941/fold_3/checkpoint_epoch_20.pth

  Current LR: 2.50e-04 | Best Dice: 0.7240 | Best Loss: 0.0124

================================================================================
Fold 3 | Epoch 21/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0087
  Batch [100/2514] | Loss: 0.0089
  Batch [150/2514] | Loss: 0.0090
  Batch [200/2514] | Loss: 0.0087
  Batch [250/2514] | Loss: 0.0088
  Batch [300/2514] | Loss: 0.0084
  Batch [350/2514] | Loss: 0.0087
  Batch [400/2514] | Loss: 0.0086
  Batch [450/2514] | Loss: 0.0087
  Batch [500/2514] | Loss: 0.0090
  Batch [550/2514] | Loss: 0.0091
  Batch [600/2514] | Loss: 0.0093
  Batch [650/2514] | Loss: 0.0093
  Batch [700/2514] | Loss: 0.0094
  Batch [750/2514] | Loss: 0.0094
  Batch [800/2514] | Loss: 0.0094
  Batch [850/2514] | Loss: 0.0094
  Batch [900/2514] | Loss: 0.0093
  Batch [950/2514] | Loss: 0.0093
  Batch [1000/2514] | Loss: 0.0094
  Batch [1050/2514] | Loss: 0.0094
  Batch [1100/2514] | Loss: 0.0095
  Batch [1150/2514] | Loss: 0.0094
  Batch [1200/2514] | Loss: 0.0094
  Batch [1250/2514] | Loss: 0.0095
  Batch [1300/2514] | Loss: 0.0094
  Batch [1350/2514] | Loss: 0.0093
  Batch [1400/2514] | Loss: 0.0093
  Batch [1450/2514] | Loss: 0.0094
  Batch [1500/2514] | Loss: 0.0094
  Batch [1550/2514] | Loss: 0.0094
  Batch [1600/2514] | Loss: 0.0094
  Batch [1650/2514] | Loss: 0.0094
  Batch [1700/2514] | Loss: 0.0094
  Batch [1750/2514] | Loss: 0.0093
  Batch [1800/2514] | Loss: 0.0094
  Batch [1850/2514] | Loss: 0.0094
  Batch [1900/2514] | Loss: 0.0094
  Batch [1950/2514] | Loss: 0.0095
  Batch [2000/2514] | Loss: 0.0095
  Batch [2050/2514] | Loss: 0.0095
  Batch [2100/2514] | Loss: 0.0095
  Batch [2150/2514] | Loss: 0.0095
  Batch [2200/2514] | Loss: 0.0095
  Batch [2250/2514] | Loss: 0.0095
  Batch [2300/2514] | Loss: 0.0095
  Batch [2350/2514] | Loss: 0.0095
  Batch [2400/2514] | Loss: 0.0095
  Batch [2450/2514] | Loss: 0.0095
  Batch [2500/2514] | Loss: 0.0094

Train Results:
  Loss: 0.0094 | Dice: 0.7354 | Dice_pos: 0.6013 | Dice_neg: 0.8869 | IoU: 0.4859
  Per-Class Metrics:
    Class 1: Dice=0.9175, IoU=0.9111, Prec=0.9599, Recall=0.9458, ClsAcc=0.9492, ClsF1=0.8276
    Class 2: Dice=0.9809, IoU=0.9809, Prec=1.0000, Recall=0.9809, ClsAcc=0.9809, ClsF1=0.9248
    Class 3: Dice=0.7863, IoU=0.7375, Prec=0.8614, Recall=0.8495, ClsAcc=0.9066, ClsF1=0.8554
    Class 4: Dice=0.9716, IoU=0.9640, Prec=0.9794, Recall=0.9819, ClsAcc=0.9869, ClsF1=0.9585
  Time: 428.1s

================================================================================
Fold 3 | Epoch 21/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0121
  Batch [100/629] | Loss: 0.0132
  Batch [150/629] | Loss: 0.0140
  Batch [200/629] | Loss: 0.0132
  Batch [250/629] | Loss: 0.0131
  Batch [300/629] | Loss: 0.0129
  Batch [350/629] | Loss: 0.0132
  Batch [400/629] | Loss: 0.0127
  Batch [450/629] | Loss: 0.0132
  Batch [500/629] | Loss: 0.0137
  Batch [550/629] | Loss: 0.0136
  Batch [600/629] | Loss: 0.0135

Validation Results:
  Loss: 0.0133 | Dice: 0.7192 | Dice_pos: 0.5283 | Dice_neg: 0.9347 | IoU: 0.4180
  Per-Class Metrics:
    Class 1: Dice=0.9057, IoU=0.8982, Prec=0.9412, Recall=0.9515, ClsAcc=0.9372, ClsF1=0.8038
    Class 2: Dice=0.9781, IoU=0.9781, Prec=1.0000, Recall=0.9781, ClsAcc=0.9781, ClsF1=0.9141
    Class 3: Dice=0.7839, IoU=0.7372, Prec=0.9133, Recall=0.7980, ClsAcc=0.9213, ClsF1=0.8797
    Class 4: Dice=0.9622, IoU=0.9541, Prec=0.9852, Recall=0.9657, ClsAcc=0.9869, ClsF1=0.9546
  Time: 90.2s
  Saved checkpoint: outputs_20260112_125941/fold_3/checkpoint_epoch_21.pth

  Current LR: 2.50e-04 | Best Dice: 0.7240 | Best Loss: 0.0124

================================================================================
Fold 3 | Epoch 22/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0095
  Batch [100/2514] | Loss: 0.0088
  Batch [150/2514] | Loss: 0.0083
  Batch [200/2514] | Loss: 0.0081
  Batch [250/2514] | Loss: 0.0080
  Batch [300/2514] | Loss: 0.0081
  Batch [350/2514] | Loss: 0.0083
  Batch [400/2514] | Loss: 0.0083
  Batch [450/2514] | Loss: 0.0081
  Batch [500/2514] | Loss: 0.0081
  Batch [550/2514] | Loss: 0.0080
  Batch [600/2514] | Loss: 0.0082
  Batch [650/2514] | Loss: 0.0083
  Batch [700/2514] | Loss: 0.0085
  Batch [750/2514] | Loss: 0.0084
  Batch [800/2514] | Loss: 0.0085
  Batch [850/2514] | Loss: 0.0084
  Batch [900/2514] | Loss: 0.0084
  Batch [950/2514] | Loss: 0.0083
  Batch [1000/2514] | Loss: 0.0083
  Batch [1050/2514] | Loss: 0.0083
  Batch [1100/2514] | Loss: 0.0083
  Batch [1150/2514] | Loss: 0.0083
  Batch [1200/2514] | Loss: 0.0084
  Batch [1250/2514] | Loss: 0.0084
  Batch [1300/2514] | Loss: 0.0085
  Batch [1350/2514] | Loss: 0.0085
  Batch [1400/2514] | Loss: 0.0086
  Batch [1450/2514] | Loss: 0.0085
  Batch [1500/2514] | Loss: 0.0085
  Batch [1550/2514] | Loss: 0.0084
  Batch [1600/2514] | Loss: 0.0085
  Batch [1650/2514] | Loss: 0.0085
  Batch [1700/2514] | Loss: 0.0085
  Batch [1750/2514] | Loss: 0.0085
  Batch [1800/2514] | Loss: 0.0085
  Batch [1850/2514] | Loss: 0.0085
  Batch [1900/2514] | Loss: 0.0085
  Batch [1950/2514] | Loss: 0.0085
  Batch [2000/2514] | Loss: 0.0086
  Batch [2050/2514] | Loss: 0.0086
  Batch [2100/2514] | Loss: 0.0086
  Batch [2150/2514] | Loss: 0.0086
  Batch [2200/2514] | Loss: 0.0086
  Batch [2250/2514] | Loss: 0.0085
  Batch [2300/2514] | Loss: 0.0085
  Batch [2350/2514] | Loss: 0.0086
  Batch [2400/2514] | Loss: 0.0086
  Batch [2450/2514] | Loss: 0.0086
  Batch [2500/2514] | Loss: 0.0086

Train Results:
  Loss: 0.0086 | Dice: 0.7591 | Dice_pos: 0.6276 | Dice_neg: 0.9077 | IoU: 0.5103
  Per-Class Metrics:
    Class 1: Dice=0.9222, IoU=0.9151, Prec=0.9605, Recall=0.9492, ClsAcc=0.9534, ClsF1=0.8446
    Class 2: Dice=0.9809, IoU=0.9809, Prec=1.0000, Recall=0.9809, ClsAcc=0.9809, ClsF1=0.9256
    Class 3: Dice=0.8025, IoU=0.7536, Prec=0.8685, Recall=0.8591, ClsAcc=0.9172, ClsF1=0.8647
    Class 4: Dice=0.9784, IoU=0.9710, Prec=0.9848, Recall=0.9836, ClsAcc=0.9920, ClsF1=0.9750
  Time: 471.4s

================================================================================
Fold 3 | Epoch 22/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0114
  Batch [100/629] | Loss: 0.0123
  Batch [150/629] | Loss: 0.0130
  Batch [200/629] | Loss: 0.0122
  Batch [250/629] | Loss: 0.0121
  Batch [300/629] | Loss: 0.0118
  Batch [350/629] | Loss: 0.0120
  Batch [400/629] | Loss: 0.0116
  Batch [450/629] | Loss: 0.0119
  Batch [500/629] | Loss: 0.0123
  Batch [550/629] | Loss: 0.0123
  Batch [600/629] | Loss: 0.0121

Validation Results:
  Loss: 0.0120 | Dice: 0.7274 | Dice_pos: 0.5431 | Dice_neg: 0.9356 | IoU: 0.4331
  Per-Class Metrics:
    Class 1: Dice=0.9285, IoU=0.9220, Prec=0.9716, Recall=0.9467, ClsAcc=0.9603, ClsF1=0.8641
    Class 2: Dice=0.9781, IoU=0.9781, Prec=1.0000, Recall=0.9781, ClsAcc=0.9781, ClsF1=0.9141
    Class 3: Dice=0.7833, IoU=0.7357, Prec=0.8990, Recall=0.8108, ClsAcc=0.9145, ClsF1=0.8741
    Class 4: Dice=0.9618, IoU=0.9535, Prec=0.9838, Recall=0.9664, ClsAcc=0.9857, ClsF1=0.9522
  Time: 103.3s
  Saved checkpoint: outputs_20260112_125941/fold_3/checkpoint_epoch_22.pth
  *** New best model saved: outputs_20260112_125941/fold_3/best_model.pth ***

  Current LR: 1.25e-04 | Best Dice: 0.7274 | Best Loss: 0.0120

================================================================================
Fold 3 | Epoch 23/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0078
  Batch [100/2514] | Loss: 0.0079
  Batch [150/2514] | Loss: 0.0085
  Batch [200/2514] | Loss: 0.0079
  Batch [250/2514] | Loss: 0.0081
  Batch [300/2514] | Loss: 0.0080
  Batch [350/2514] | Loss: 0.0082
  Batch [400/2514] | Loss: 0.0081
  Batch [450/2514] | Loss: 0.0081
  Batch [500/2514] | Loss: 0.0083
  Batch [550/2514] | Loss: 0.0082
  Batch [600/2514] | Loss: 0.0082
  Batch [650/2514] | Loss: 0.0081
  Batch [700/2514] | Loss: 0.0082
  Batch [750/2514] | Loss: 0.0082
  Batch [800/2514] | Loss: 0.0082
  Batch [850/2514] | Loss: 0.0081
  Batch [900/2514] | Loss: 0.0081
  Batch [950/2514] | Loss: 0.0082
  Batch [1000/2514] | Loss: 0.0081
  Batch [1050/2514] | Loss: 0.0083
  Batch [1100/2514] | Loss: 0.0084
  Batch [1150/2514] | Loss: 0.0085
  Batch [1200/2514] | Loss: 0.0085
  Batch [1250/2514] | Loss: 0.0085
  Batch [1300/2514] | Loss: 0.0084
  Batch [1350/2514] | Loss: 0.0084
  Batch [1400/2514] | Loss: 0.0085
  Batch [1450/2514] | Loss: 0.0085
  Batch [1500/2514] | Loss: 0.0085
  Batch [1550/2514] | Loss: 0.0085
  Batch [1600/2514] | Loss: 0.0085
  Batch [1650/2514] | Loss: 0.0085
  Batch [1700/2514] | Loss: 0.0085
  Batch [1750/2514] | Loss: 0.0085
  Batch [1800/2514] | Loss: 0.0085
  Batch [1850/2514] | Loss: 0.0085
  Batch [1900/2514] | Loss: 0.0085
  Batch [1950/2514] | Loss: 0.0085
  Batch [2000/2514] | Loss: 0.0085
  Batch [2050/2514] | Loss: 0.0085
  Batch [2100/2514] | Loss: 0.0085
  Batch [2150/2514] | Loss: 0.0085
  Batch [2200/2514] | Loss: 0.0085
  Batch [2250/2514] | Loss: 0.0085
  Batch [2300/2514] | Loss: 0.0085
  Batch [2350/2514] | Loss: 0.0085
  Batch [2400/2514] | Loss: 0.0085
  Batch [2450/2514] | Loss: 0.0085
  Batch [2500/2514] | Loss: 0.0085

Train Results:
  Loss: 0.0085 | Dice: 0.7640 | Dice_pos: 0.6324 | Dice_neg: 0.9127 | IoU: 0.5185
  Per-Class Metrics:
    Class 1: Dice=0.9256, IoU=0.9182, Prec=0.9623, Recall=0.9505, ClsAcc=0.9550, ClsF1=0.8479
    Class 2: Dice=0.9809, IoU=0.9809, Prec=1.0000, Recall=0.9809, ClsAcc=0.9809, ClsF1=0.9256
    Class 3: Dice=0.8053, IoU=0.7565, Prec=0.8712, Recall=0.8598, ClsAcc=0.9203, ClsF1=0.8734
    Class 4: Dice=0.9776, IoU=0.9702, Prec=0.9836, Recall=0.9842, ClsAcc=0.9911, ClsF1=0.9736
  Time: 458.2s

================================================================================
Fold 3 | Epoch 23/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0111
  Batch [100/629] | Loss: 0.0122
  Batch [150/629] | Loss: 0.0129
  Batch [200/629] | Loss: 0.0122
  Batch [250/629] | Loss: 0.0121
  Batch [300/629] | Loss: 0.0117
  Batch [350/629] | Loss: 0.0119
  Batch [400/629] | Loss: 0.0114
  Batch [450/629] | Loss: 0.0118
  Batch [500/629] | Loss: 0.0121
  Batch [550/629] | Loss: 0.0121
  Batch [600/629] | Loss: 0.0119

Validation Results:
  Loss: 0.0118 | Dice: 0.7318 | Dice_pos: 0.5829 | Dice_neg: 0.9000 | IoU: 0.4675
  Per-Class Metrics:
    Class 1: Dice=0.9124, IoU=0.9045, Prec=0.9449, Recall=0.9539, ClsAcc=0.9412, ClsF1=0.8054
    Class 2: Dice=0.9781, IoU=0.9781, Prec=1.0000, Recall=0.9781, ClsAcc=0.9781, ClsF1=0.9141
    Class 3: Dice=0.7895, IoU=0.7402, Prec=0.8833, Recall=0.8278, ClsAcc=0.9177, ClsF1=0.8812
    Class 4: Dice=0.9571, IoU=0.9486, Prec=0.9741, Recall=0.9712, ClsAcc=0.9789, ClsF1=0.9276
  Time: 111.2s
  Saved checkpoint: outputs_20260112_125941/fold_3/checkpoint_epoch_23.pth
  *** New best model saved: outputs_20260112_125941/fold_3/best_model.pth ***

  Current LR: 1.25e-04 | Best Dice: 0.7318 | Best Loss: 0.0118

================================================================================
Fold 3 | Epoch 24/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0083
  Batch [100/2514] | Loss: 0.0075
  Batch [150/2514] | Loss: 0.0077
  Batch [200/2514] | Loss: 0.0073
  Batch [250/2514] | Loss: 0.0076
  Batch [300/2514] | Loss: 0.0078
  Batch [350/2514] | Loss: 0.0081
  Batch [400/2514] | Loss: 0.0080
  Batch [450/2514] | Loss: 0.0082
  Batch [500/2514] | Loss: 0.0081
  Batch [550/2514] | Loss: 0.0080
  Batch [600/2514] | Loss: 0.0080
  Batch [650/2514] | Loss: 0.0080
  Batch [700/2514] | Loss: 0.0081
  Batch [750/2514] | Loss: 0.0082
  Batch [800/2514] | Loss: 0.0082
  Batch [850/2514] | Loss: 0.0081
  Batch [900/2514] | Loss: 0.0081
  Batch [950/2514] | Loss: 0.0081
  Batch [1000/2514] | Loss: 0.0080
  Batch [1050/2514] | Loss: 0.0081
  Batch [1100/2514] | Loss: 0.0081
  Batch [1150/2514] | Loss: 0.0081
  Batch [1200/2514] | Loss: 0.0082
  Batch [1250/2514] | Loss: 0.0082
  Batch [1300/2514] | Loss: 0.0083
  Batch [1350/2514] | Loss: 0.0083
  Batch [1400/2514] | Loss: 0.0083
  Batch [1450/2514] | Loss: 0.0082
  Batch [1500/2514] | Loss: 0.0082
  Batch [1550/2514] | Loss: 0.0082
  Batch [1600/2514] | Loss: 0.0082
  Batch [1650/2514] | Loss: 0.0082
  Batch [1700/2514] | Loss: 0.0083
  Batch [1750/2514] | Loss: 0.0083
  Batch [1800/2514] | Loss: 0.0083
  Batch [1850/2514] | Loss: 0.0083
  Batch [1900/2514] | Loss: 0.0083
  Batch [1950/2514] | Loss: 0.0083
  Batch [2000/2514] | Loss: 0.0083
  Batch [2050/2514] | Loss: 0.0083
  Batch [2100/2514] | Loss: 0.0083
  Batch [2150/2514] | Loss: 0.0083
  Batch [2200/2514] | Loss: 0.0083
  Batch [2250/2514] | Loss: 0.0082
  Batch [2300/2514] | Loss: 0.0082
  Batch [2350/2514] | Loss: 0.0082
  Batch [2400/2514] | Loss: 0.0082
  Batch [2450/2514] | Loss: 0.0082
  Batch [2500/2514] | Loss: 0.0082

Train Results:
  Loss: 0.0082 | Dice: 0.7652 | Dice_pos: 0.6401 | Dice_neg: 0.9066 | IoU: 0.5214
  Per-Class Metrics:
    Class 1: Dice=0.9264, IoU=0.9187, Prec=0.9602, Recall=0.9525, ClsAcc=0.9569, ClsF1=0.8579
    Class 2: Dice=0.9809, IoU=0.9809, Prec=1.0000, Recall=0.9809, ClsAcc=0.9809, ClsF1=0.9272
    Class 3: Dice=0.8077, IoU=0.7589, Prec=0.8712, Recall=0.8625, ClsAcc=0.9199, ClsF1=0.8711
    Class 4: Dice=0.9792, IoU=0.9718, Prec=0.9840, Recall=0.9852, ClsAcc=0.9924, ClsF1=0.9791
  Time: 441.6s

================================================================================
Fold 3 | Epoch 24/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0122
  Batch [100/629] | Loss: 0.0134
  Batch [150/629] | Loss: 0.0139
  Batch [200/629] | Loss: 0.0131
  Batch [250/629] | Loss: 0.0129
  Batch [300/629] | Loss: 0.0126
  Batch [350/629] | Loss: 0.0128
  Batch [400/629] | Loss: 0.0125
  Batch [450/629] | Loss: 0.0127
  Batch [500/629] | Loss: 0.0131
  Batch [550/629] | Loss: 0.0131
  Batch [600/629] | Loss: 0.0129

Validation Results:
  Loss: 0.0128 | Dice: 0.7200 | Dice_pos: 0.5449 | Dice_neg: 0.9178 | IoU: 0.4343
  Per-Class Metrics:
    Class 1: Dice=0.9288, IoU=0.9216, Prec=0.9683, Recall=0.9493, ClsAcc=0.9587, ClsF1=0.8631
    Class 2: Dice=0.9781, IoU=0.9781, Prec=1.0000, Recall=0.9781, ClsAcc=0.9781, ClsF1=0.9141
    Class 3: Dice=0.7716, IoU=0.7236, Prec=0.8739, Recall=0.8188, ClsAcc=0.9046, ClsF1=0.8639
    Class 4: Dice=0.9604, IoU=0.9522, Prec=0.9929, Recall=0.9575, ClsAcc=0.9869, ClsF1=0.9522
  Time: 103.3s
  Saved checkpoint: outputs_20260112_125941/fold_3/checkpoint_epoch_24.pth

  Current LR: 1.25e-04 | Best Dice: 0.7318 | Best Loss: 0.0118

================================================================================
Fold 3 | Epoch 25/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0079
  Batch [100/2514] | Loss: 0.0081
  Batch [150/2514] | Loss: 0.0084
  Batch [200/2514] | Loss: 0.0077
  Batch [250/2514] | Loss: 0.0079
  Batch [300/2514] | Loss: 0.0079
  Batch [350/2514] | Loss: 0.0078
  Batch [400/2514] | Loss: 0.0076
  Batch [450/2514] | Loss: 0.0076
  Batch [500/2514] | Loss: 0.0077
  Batch [550/2514] | Loss: 0.0078
  Batch [600/2514] | Loss: 0.0078
  Batch [650/2514] | Loss: 0.0078
  Batch [700/2514] | Loss: 0.0078
  Batch [750/2514] | Loss: 0.0079
  Batch [800/2514] | Loss: 0.0078
  Batch [850/2514] | Loss: 0.0078
  Batch [900/2514] | Loss: 0.0078
  Batch [950/2514] | Loss: 0.0077
  Batch [1000/2514] | Loss: 0.0077
  Batch [1050/2514] | Loss: 0.0078
  Batch [1100/2514] | Loss: 0.0078
  Batch [1150/2514] | Loss: 0.0079
  Batch [1200/2514] | Loss: 0.0079
  Batch [1250/2514] | Loss: 0.0079
  Batch [1300/2514] | Loss: 0.0079
  Batch [1350/2514] | Loss: 0.0080
  Batch [1400/2514] | Loss: 0.0080
  Batch [1450/2514] | Loss: 0.0080
  Batch [1500/2514] | Loss: 0.0080
  Batch [1550/2514] | Loss: 0.0080
  Batch [1600/2514] | Loss: 0.0080
  Batch [1650/2514] | Loss: 0.0080
  Batch [1700/2514] | Loss: 0.0080
  Batch [1750/2514] | Loss: 0.0080
  Batch [1800/2514] | Loss: 0.0080
  Batch [1850/2514] | Loss: 0.0081
  Batch [1900/2514] | Loss: 0.0080
  Batch [1950/2514] | Loss: 0.0081
  Batch [2000/2514] | Loss: 0.0081
  Batch [2050/2514] | Loss: 0.0081
  Batch [2100/2514] | Loss: 0.0081
  Batch [2150/2514] | Loss: 0.0081
  Batch [2200/2514] | Loss: 0.0081
  Batch [2250/2514] | Loss: 0.0081
  Batch [2300/2514] | Loss: 0.0081
  Batch [2350/2514] | Loss: 0.0081
  Batch [2400/2514] | Loss: 0.0081
  Batch [2450/2514] | Loss: 0.0081
  Batch [2500/2514] | Loss: 0.0081

Train Results:
  Loss: 0.0081 | Dice: 0.7687 | Dice_pos: 0.6426 | Dice_neg: 0.9111 | IoU: 0.5264
  Per-Class Metrics:
    Class 1: Dice=0.9257, IoU=0.9180, Prec=0.9583, Recall=0.9532, ClsAcc=0.9561, ClsF1=0.8556
    Class 2: Dice=0.9809, IoU=0.9809, Prec=1.0000, Recall=0.9809, ClsAcc=0.9809, ClsF1=0.9252
    Class 3: Dice=0.8109, IoU=0.7625, Prec=0.8742, Recall=0.8628, ClsAcc=0.9231, ClsF1=0.8800
    Class 4: Dice=0.9793, IoU=0.9720, Prec=0.9842, Recall=0.9853, ClsAcc=0.9925, ClsF1=0.9780
  Time: 428.4s

================================================================================
Fold 3 | Epoch 25/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0118
  Batch [100/629] | Loss: 0.0133
  Batch [150/629] | Loss: 0.0142
  Batch [200/629] | Loss: 0.0133
  Batch [250/629] | Loss: 0.0131
  Batch [300/629] | Loss: 0.0128
  Batch [350/629] | Loss: 0.0129
  Batch [400/629] | Loss: 0.0124
  Batch [450/629] | Loss: 0.0129
  Batch [500/629] | Loss: 0.0132
  Batch [550/629] | Loss: 0.0131
  Batch [600/629] | Loss: 0.0129

Validation Results:
  Loss: 0.0128 | Dice: 0.7321 | Dice_pos: 0.5632 | Dice_neg: 0.9229 | IoU: 0.4539
  Per-Class Metrics:
    Class 1: Dice=0.9291, IoU=0.9223, Prec=0.9694, Recall=0.9487, ClsAcc=0.9587, ClsF1=0.8592
    Class 2: Dice=0.9781, IoU=0.9781, Prec=1.0000, Recall=0.9781, ClsAcc=0.9781, ClsF1=0.9141
    Class 3: Dice=0.7822, IoU=0.7349, Prec=0.8814, Recall=0.8259, ClsAcc=0.9102, ClsF1=0.8741
    Class 4: Dice=0.9647, IoU=0.9564, Prec=0.9864, Recall=0.9672, ClsAcc=0.9873, ClsF1=0.9580
  Time: 93.8s
  Saved checkpoint: outputs_20260112_125941/fold_3/checkpoint_epoch_25.pth
  *** New best model saved: outputs_20260112_125941/fold_3/best_model.pth ***

  Current LR: 1.25e-04 | Best Dice: 0.7321 | Best Loss: 0.0128
  Saved OOF predictions: outputs_20260112_125941/fold_3/oof_predictions.npy
  Saved training history: outputs_20260112_125941/fold_3/history.csv

################################################################################
# Finished training for Fold 3
# Best Dice: 0.7321 | Best Loss: 0.0128
################################################################################


================================================================================
TRAINING SUMMARY
================================================================================
Fold 3: Best Dice = 0.7321, Best Loss = 0.0128
================================================================================
