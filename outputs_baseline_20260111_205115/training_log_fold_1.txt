================================================================================
CONFIGURATION
================================================================================
Data root: /home/frank/Dropbox/Project/kaggle_severstal/input/
Output dir: outputs_20260112_044318
Model: unet with resnet18 encoder
Num classes: 4
Num folds: 5
Num epochs: 25
Batch size: 4 (effective: 4)
Learning rate: 0.0005
Optimizer: adam
Loss: bce_with_logits
Scheduler: reduce_on_plateau
Seed: 69
================================================================================

Using device: cuda:0
Fold 1: Train samples = 10054, Val samples = 2514

################################################################################
# Starting training for Fold 1
# Output directory: outputs_20260112_044318/fold_1
################################################################################


================================================================================
Fold 1 | Epoch 1/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.4127
  Batch [100/2514] | Loss: 0.2796
  Batch [150/2514] | Loss: 0.2148
  Batch [200/2514] | Loss: 0.1768
  Batch [250/2514] | Loss: 0.1501
  Batch [300/2514] | Loss: 0.1322
  Batch [350/2514] | Loss: 0.1192
  Batch [400/2514] | Loss: 0.1091
  Batch [450/2514] | Loss: 0.1013
  Batch [500/2514] | Loss: 0.0942
  Batch [550/2514] | Loss: 0.0888
  Batch [600/2514] | Loss: 0.0844
  Batch [650/2514] | Loss: 0.0803
  Batch [700/2514] | Loss: 0.0766
  Batch [750/2514] | Loss: 0.0731
  Batch [800/2514] | Loss: 0.0701
  Batch [850/2514] | Loss: 0.0675
  Batch [900/2514] | Loss: 0.0652
  Batch [950/2514] | Loss: 0.0630
  Batch [1000/2514] | Loss: 0.0611
  Batch [1050/2514] | Loss: 0.0599
  Batch [1100/2514] | Loss: 0.0585
  Batch [1150/2514] | Loss: 0.0571
  Batch [1200/2514] | Loss: 0.0559
  Batch [1250/2514] | Loss: 0.0546
  Batch [1300/2514] | Loss: 0.0537
  Batch [1350/2514] | Loss: 0.0527
  Batch [1400/2514] | Loss: 0.0523
  Batch [1450/2514] | Loss: 0.0513
  Batch [1500/2514] | Loss: 0.0507
  Batch [1550/2514] | Loss: 0.0499
  Batch [1600/2514] | Loss: 0.0491
  Batch [1650/2514] | Loss: 0.0484
  Batch [1700/2514] | Loss: 0.0477
  Batch [1750/2514] | Loss: 0.0472
  Batch [1800/2514] | Loss: 0.0464
  Batch [1850/2514] | Loss: 0.0457
  Batch [1900/2514] | Loss: 0.0452
  Batch [1950/2514] | Loss: 0.0447
  Batch [2000/2514] | Loss: 0.0441
  Batch [2050/2514] | Loss: 0.0436
  Batch [2100/2514] | Loss: 0.0432
  Batch [2150/2514] | Loss: 0.0427
  Batch [2200/2514] | Loss: 0.0423
  Batch [2250/2514] | Loss: 0.0420
  Batch [2300/2514] | Loss: 0.0417
  Batch [2350/2514] | Loss: 0.0414
  Batch [2400/2514] | Loss: 0.0409
  Batch [2450/2514] | Loss: 0.0406
  Batch [2500/2514] | Loss: 0.0403

Train Results:
  Loss: 0.0402 | Dice: 0.4071 | Dice_pos: 0.1879 | Dice_neg: 0.6546 | IoU: 0.1429
  Per-Class Metrics:
    Class 1: Dice=0.9050, IoU=0.9050, Prec=0.9740, Recall=0.9295, ClsAcc=0.9066, ClsF1=0.7248
    Class 2: Dice=0.9538, IoU=0.9538, Prec=0.9729, Recall=0.9805, ClsAcc=0.9543, ClsF1=0.8958
    Class 3: Dice=0.4777, IoU=0.4471, Prec=0.7191, Recall=0.6798, ClsAcc=0.6719, ClsF1=0.5920
    Class 4: Dice=0.9025, IoU=0.9025, Prec=0.9671, Recall=0.9345, ClsAcc=0.9035, ClsF1=0.7140
  Time: 434.9s

================================================================================
Fold 1 | Epoch 1/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0240
  Batch [100/629] | Loss: 0.0209
  Batch [150/629] | Loss: 0.0203
  Batch [200/629] | Loss: 0.0196
  Batch [250/629] | Loss: 0.0204
  Batch [300/629] | Loss: 0.0210
  Batch [350/629] | Loss: 0.0211
  Batch [400/629] | Loss: 0.0209
  Batch [450/629] | Loss: 0.0214
  Batch [500/629] | Loss: 0.0220
  Batch [550/629] | Loss: 0.0220
  Batch [600/629] | Loss: 0.0221

Validation Results:
  Loss: 0.0220 | Dice: 0.5429 | Dice_pos: 0.2570 | Dice_neg: 0.8661 | IoU: 0.1821
  Per-Class Metrics:
    Class 1: Dice=0.9253, IoU=0.9253, Prec=1.0000, Recall=0.9253, ClsAcc=0.9253, ClsF1=0.7361
    Class 2: Dice=0.9801, IoU=0.9801, Prec=1.0000, Recall=0.9801, ClsAcc=0.9801, ClsF1=0.9237
    Class 3: Dice=0.6176, IoU=0.5776, Prec=0.8355, Recall=0.7008, ClsAcc=0.8080, ClsF1=0.7105
    Class 4: Dice=0.9444, IoU=0.9444, Prec=1.0000, Recall=0.9444, ClsAcc=0.9444, ClsF1=0.7997
  Time: 82.9s
  Saved checkpoint: outputs_20260112_044318/fold_1/checkpoint_epoch_1.pth
  *** New best model saved: outputs_20260112_044318/fold_1/best_model.pth ***

  Current LR: 5.00e-04 | Best Dice: 0.5429 | Best Loss: 0.0220

================================================================================
Fold 1 | Epoch 2/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0214
  Batch [100/2514] | Loss: 0.0231
  Batch [150/2514] | Loss: 0.0239
  Batch [200/2514] | Loss: 0.0242
  Batch [250/2514] | Loss: 0.0231
  Batch [300/2514] | Loss: 0.0239
  Batch [350/2514] | Loss: 0.0240
  Batch [400/2514] | Loss: 0.0247
  Batch [450/2514] | Loss: 0.0248
  Batch [500/2514] | Loss: 0.0247
  Batch [550/2514] | Loss: 0.0245
  Batch [600/2514] | Loss: 0.0244
  Batch [650/2514] | Loss: 0.0243
  Batch [700/2514] | Loss: 0.0245
  Batch [750/2514] | Loss: 0.0245
  Batch [800/2514] | Loss: 0.0247
  Batch [850/2514] | Loss: 0.0247
  Batch [900/2514] | Loss: 0.0244
  Batch [950/2514] | Loss: 0.0243
  Batch [1000/2514] | Loss: 0.0242
  Batch [1050/2514] | Loss: 0.0241
  Batch [1100/2514] | Loss: 0.0240
  Batch [1150/2514] | Loss: 0.0240
  Batch [1200/2514] | Loss: 0.0237
  Batch [1250/2514] | Loss: 0.0237
  Batch [1300/2514] | Loss: 0.0235
  Batch [1350/2514] | Loss: 0.0235
  Batch [1400/2514] | Loss: 0.0232
  Batch [1450/2514] | Loss: 0.0231
  Batch [1500/2514] | Loss: 0.0232
  Batch [1550/2514] | Loss: 0.0231
  Batch [1600/2514] | Loss: 0.0229
  Batch [1650/2514] | Loss: 0.0229
  Batch [1700/2514] | Loss: 0.0227
  Batch [1750/2514] | Loss: 0.0226
  Batch [1800/2514] | Loss: 0.0226
  Batch [1850/2514] | Loss: 0.0225
  Batch [1900/2514] | Loss: 0.0225
  Batch [1950/2514] | Loss: 0.0225
  Batch [2000/2514] | Loss: 0.0226
  Batch [2050/2514] | Loss: 0.0227
  Batch [2100/2514] | Loss: 0.0226
  Batch [2150/2514] | Loss: 0.0225
  Batch [2200/2514] | Loss: 0.0224
  Batch [2250/2514] | Loss: 0.0224
  Batch [2300/2514] | Loss: 0.0224
  Batch [2350/2514] | Loss: 0.0224
  Batch [2400/2514] | Loss: 0.0223
  Batch [2450/2514] | Loss: 0.0222
  Batch [2500/2514] | Loss: 0.0222

Train Results:
  Loss: 0.0221 | Dice: 0.5006 | Dice_pos: 0.3303 | Dice_neg: 0.6929 | IoU: 0.2526
  Per-Class Metrics:
    Class 1: Dice=0.9295, IoU=0.9295, Prec=1.0000, Recall=0.9295, ClsAcc=0.9295, ClsF1=0.7486
    Class 2: Dice=0.9804, IoU=0.9804, Prec=1.0000, Recall=0.9804, ClsAcc=0.9804, ClsF1=0.9236
    Class 3: Dice=0.5542, IoU=0.5078, Prec=0.7092, Recall=0.7539, ClsAcc=0.7352, ClsF1=0.6850
    Class 4: Dice=0.9343, IoU=0.9343, Prec=1.0000, Recall=0.9343, ClsAcc=0.9343, ClsF1=0.7629
  Time: 420.3s

================================================================================
Fold 1 | Epoch 2/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0220
  Batch [100/629] | Loss: 0.0195
  Batch [150/629] | Loss: 0.0192
  Batch [200/629] | Loss: 0.0184
  Batch [250/629] | Loss: 0.0192
  Batch [300/629] | Loss: 0.0197
  Batch [350/629] | Loss: 0.0200
  Batch [400/629] | Loss: 0.0198
  Batch [450/629] | Loss: 0.0202
  Batch [500/629] | Loss: 0.0208
  Batch [550/629] | Loss: 0.0209
  Batch [600/629] | Loss: 0.0209

Validation Results:
  Loss: 0.0207 | Dice: 0.4480 | Dice_pos: 0.0578 | Dice_neg: 0.8890 | IoU: 0.0338
  Per-Class Metrics:
    Class 1: Dice=0.9253, IoU=0.9253, Prec=1.0000, Recall=0.9253, ClsAcc=0.9253, ClsF1=0.7361
    Class 2: Dice=0.9801, IoU=0.9801, Prec=1.0000, Recall=0.9801, ClsAcc=0.9801, ClsF1=0.9237
    Class 3: Dice=0.5295, IoU=0.5160, Prec=0.8867, Recall=0.6037, ClsAcc=0.7874, ClsF1=0.6720
    Class 4: Dice=0.9444, IoU=0.9444, Prec=1.0000, Recall=0.9444, ClsAcc=0.9444, ClsF1=0.7997
  Time: 83.3s
  Saved checkpoint: outputs_20260112_044318/fold_1/checkpoint_epoch_2.pth

  Current LR: 5.00e-04 | Best Dice: 0.5429 | Best Loss: 0.0220

================================================================================
Fold 1 | Epoch 3/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0177
  Batch [100/2514] | Loss: 0.0195
  Batch [150/2514] | Loss: 0.0204
  Batch [200/2514] | Loss: 0.0208
  Batch [250/2514] | Loss: 0.0201
  Batch [300/2514] | Loss: 0.0209
  Batch [350/2514] | Loss: 0.0211
  Batch [400/2514] | Loss: 0.0213
  Batch [450/2514] | Loss: 0.0211
  Batch [500/2514] | Loss: 0.0208
  Batch [550/2514] | Loss: 0.0206
  Batch [600/2514] | Loss: 0.0202
  Batch [650/2514] | Loss: 0.0202
  Batch [700/2514] | Loss: 0.0209
  Batch [750/2514] | Loss: 0.0212
  Batch [800/2514] | Loss: 0.0211
  Batch [850/2514] | Loss: 0.0213
  Batch [900/2514] | Loss: 0.0210
  Batch [950/2514] | Loss: 0.0207
  Batch [1000/2514] | Loss: 0.0204
  Batch [1050/2514] | Loss: 0.0202
  Batch [1100/2514] | Loss: 0.0200
  Batch [1150/2514] | Loss: 0.0202
  Batch [1200/2514] | Loss: 0.0202
  Batch [1250/2514] | Loss: 0.0202
  Batch [1300/2514] | Loss: 0.0200
  Batch [1350/2514] | Loss: 0.0199
  Batch [1400/2514] | Loss: 0.0200
  Batch [1450/2514] | Loss: 0.0200
  Batch [1500/2514] | Loss: 0.0199
  Batch [1550/2514] | Loss: 0.0198
  Batch [1600/2514] | Loss: 0.0198
  Batch [1650/2514] | Loss: 0.0197
  Batch [1700/2514] | Loss: 0.0197
  Batch [1750/2514] | Loss: 0.0197
  Batch [1800/2514] | Loss: 0.0197
  Batch [1850/2514] | Loss: 0.0198
  Batch [1900/2514] | Loss: 0.0197
  Batch [1950/2514] | Loss: 0.0196
  Batch [2000/2514] | Loss: 0.0196
  Batch [2050/2514] | Loss: 0.0195
  Batch [2100/2514] | Loss: 0.0195
  Batch [2150/2514] | Loss: 0.0194
  Batch [2200/2514] | Loss: 0.0194
  Batch [2250/2514] | Loss: 0.0193
  Batch [2300/2514] | Loss: 0.0192
  Batch [2350/2514] | Loss: 0.0192
  Batch [2400/2514] | Loss: 0.0192
  Batch [2450/2514] | Loss: 0.0192
  Batch [2500/2514] | Loss: 0.0191

Train Results:
  Loss: 0.0191 | Dice: 0.5413 | Dice_pos: 0.3623 | Dice_neg: 0.7435 | IoU: 0.2781
  Per-Class Metrics:
    Class 1: Dice=0.9295, IoU=0.9295, Prec=1.0000, Recall=0.9295, ClsAcc=0.9295, ClsF1=0.7470
    Class 2: Dice=0.9804, IoU=0.9804, Prec=1.0000, Recall=0.9804, ClsAcc=0.9804, ClsF1=0.9244
    Class 3: Dice=0.6033, IoU=0.5561, Prec=0.7421, Recall=0.7716, ClsAcc=0.7737, ClsF1=0.7083
    Class 4: Dice=0.9343, IoU=0.9343, Prec=1.0000, Recall=0.9343, ClsAcc=0.9343, ClsF1=0.7629
  Time: 413.1s

================================================================================
Fold 1 | Epoch 3/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0196
  Batch [100/629] | Loss: 0.0173
  Batch [150/629] | Loss: 0.0172
  Batch [200/629] | Loss: 0.0164
  Batch [250/629] | Loss: 0.0166
  Batch [300/629] | Loss: 0.0172
  Batch [350/629] | Loss: 0.0172
  Batch [400/629] | Loss: 0.0172
  Batch [450/629] | Loss: 0.0176
  Batch [500/629] | Loss: 0.0182
  Batch [550/629] | Loss: 0.0181
  Batch [600/629] | Loss: 0.0183

Validation Results:
  Loss: 0.0182 | Dice: 0.5435 | Dice_pos: 0.3195 | Dice_neg: 0.7966 | IoU: 0.2383
  Per-Class Metrics:
    Class 1: Dice=0.9253, IoU=0.9253, Prec=1.0000, Recall=0.9253, ClsAcc=0.9253, ClsF1=0.7361
    Class 2: Dice=0.9801, IoU=0.9801, Prec=1.0000, Recall=0.9801, ClsAcc=0.9801, ClsF1=0.9237
    Class 3: Dice=0.6060, IoU=0.5596, Prec=0.7738, Recall=0.7326, ClsAcc=0.8041, ClsF1=0.7348
    Class 4: Dice=0.9444, IoU=0.9444, Prec=1.0000, Recall=0.9444, ClsAcc=0.9444, ClsF1=0.7997
  Time: 105.2s
  Saved checkpoint: outputs_20260112_044318/fold_1/checkpoint_epoch_3.pth
  *** New best model saved: outputs_20260112_044318/fold_1/best_model.pth ***

  Current LR: 5.00e-04 | Best Dice: 0.5435 | Best Loss: 0.0182

================================================================================
Fold 1 | Epoch 4/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0186
  Batch [100/2514] | Loss: 0.0201
  Batch [150/2514] | Loss: 0.0204
  Batch [200/2514] | Loss: 0.0199
  Batch [250/2514] | Loss: 0.0194
  Batch [300/2514] | Loss: 0.0189
  Batch [350/2514] | Loss: 0.0186
  Batch [400/2514] | Loss: 0.0179
  Batch [450/2514] | Loss: 0.0180
  Batch [500/2514] | Loss: 0.0176
  Batch [550/2514] | Loss: 0.0177
  Batch [600/2514] | Loss: 0.0180
  Batch [650/2514] | Loss: 0.0178
  Batch [700/2514] | Loss: 0.0179
  Batch [750/2514] | Loss: 0.0178
  Batch [800/2514] | Loss: 0.0177
  Batch [850/2514] | Loss: 0.0177
  Batch [900/2514] | Loss: 0.0177
  Batch [950/2514] | Loss: 0.0177
  Batch [1000/2514] | Loss: 0.0176
  Batch [1050/2514] | Loss: 0.0176
  Batch [1100/2514] | Loss: 0.0176
  Batch [1150/2514] | Loss: 0.0176
  Batch [1200/2514] | Loss: 0.0175
  Batch [1250/2514] | Loss: 0.0176
  Batch [1300/2514] | Loss: 0.0175
  Batch [1350/2514] | Loss: 0.0175
  Batch [1400/2514] | Loss: 0.0174
  Batch [1450/2514] | Loss: 0.0173
  Batch [1500/2514] | Loss: 0.0172
  Batch [1550/2514] | Loss: 0.0172
  Batch [1600/2514] | Loss: 0.0171
  Batch [1650/2514] | Loss: 0.0172
  Batch [1700/2514] | Loss: 0.0172
  Batch [1750/2514] | Loss: 0.0174
  Batch [1800/2514] | Loss: 0.0173
  Batch [1850/2514] | Loss: 0.0173
  Batch [1900/2514] | Loss: 0.0173
  Batch [1950/2514] | Loss: 0.0173
  Batch [2000/2514] | Loss: 0.0175
  Batch [2050/2514] | Loss: 0.0175
  Batch [2100/2514] | Loss: 0.0176
  Batch [2150/2514] | Loss: 0.0176
  Batch [2200/2514] | Loss: 0.0175
  Batch [2250/2514] | Loss: 0.0176
  Batch [2300/2514] | Loss: 0.0176
  Batch [2350/2514] | Loss: 0.0176
  Batch [2400/2514] | Loss: 0.0176
  Batch [2450/2514] | Loss: 0.0176
  Batch [2500/2514] | Loss: 0.0176

Train Results:
  Loss: 0.0176 | Dice: 0.5744 | Dice_pos: 0.3933 | Dice_neg: 0.7789 | IoU: 0.3018
  Per-Class Metrics:
    Class 1: Dice=0.9294, IoU=0.9294, Prec=1.0000, Recall=0.9294, ClsAcc=0.9294, ClsF1=0.7438
    Class 2: Dice=0.9804, IoU=0.9804, Prec=1.0000, Recall=0.9804, ClsAcc=0.9804, ClsF1=0.9228
    Class 3: Dice=0.6444, IoU=0.5982, Prec=0.7793, Recall=0.7796, ClsAcc=0.8034, ClsF1=0.7271
    Class 4: Dice=0.9199, IoU=0.9164, Prec=0.9684, Recall=0.9454, ClsAcc=0.9357, ClsF1=0.7749
  Time: 418.7s

================================================================================
Fold 1 | Epoch 4/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0171
  Batch [100/629] | Loss: 0.0153
  Batch [150/629] | Loss: 0.0156
  Batch [200/629] | Loss: 0.0147
  Batch [250/629] | Loss: 0.0154
  Batch [300/629] | Loss: 0.0158
  Batch [350/629] | Loss: 0.0158
  Batch [400/629] | Loss: 0.0157
  Batch [450/629] | Loss: 0.0160
  Batch [500/629] | Loss: 0.0164
  Batch [550/629] | Loss: 0.0165
  Batch [600/629] | Loss: 0.0165

Validation Results:
  Loss: 0.0164 | Dice: 0.6063 | Dice_pos: 0.3690 | Dice_neg: 0.8746 | IoU: 0.2889
  Per-Class Metrics:
    Class 1: Dice=0.9253, IoU=0.9253, Prec=1.0000, Recall=0.9253, ClsAcc=0.9253, ClsF1=0.7361
    Class 2: Dice=0.9801, IoU=0.9801, Prec=1.0000, Recall=0.9801, ClsAcc=0.9801, ClsF1=0.9237
    Class 3: Dice=0.7038, IoU=0.6609, Prec=0.8837, Recall=0.7483, ClsAcc=0.8577, ClsF1=0.7755
    Class 4: Dice=0.9343, IoU=0.9299, Prec=0.9719, Recall=0.9559, ClsAcc=0.9579, ClsF1=0.8561
  Time: 103.0s
  Saved checkpoint: outputs_20260112_044318/fold_1/checkpoint_epoch_4.pth
  *** New best model saved: outputs_20260112_044318/fold_1/best_model.pth ***

  Current LR: 5.00e-04 | Best Dice: 0.6063 | Best Loss: 0.0164

================================================================================
Fold 1 | Epoch 5/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0135
  Batch [100/2514] | Loss: 0.0171
  Batch [150/2514] | Loss: 0.0181
  Batch [200/2514] | Loss: 0.0193
  Batch [250/2514] | Loss: 0.0190
  Batch [300/2514] | Loss: 0.0190
  Batch [350/2514] | Loss: 0.0184
  Batch [400/2514] | Loss: 0.0175
  Batch [450/2514] | Loss: 0.0170
  Batch [500/2514] | Loss: 0.0167
  Batch [550/2514] | Loss: 0.0165
  Batch [600/2514] | Loss: 0.0164
  Batch [650/2514] | Loss: 0.0164
  Batch [700/2514] | Loss: 0.0166
  Batch [750/2514] | Loss: 0.0167
  Batch [800/2514] | Loss: 0.0168
  Batch [850/2514] | Loss: 0.0166
  Batch [900/2514] | Loss: 0.0165
  Batch [950/2514] | Loss: 0.0163
  Batch [1000/2514] | Loss: 0.0163
  Batch [1050/2514] | Loss: 0.0164
  Batch [1100/2514] | Loss: 0.0164
  Batch [1150/2514] | Loss: 0.0163
  Batch [1200/2514] | Loss: 0.0165
  Batch [1250/2514] | Loss: 0.0164
  Batch [1300/2514] | Loss: 0.0163
  Batch [1350/2514] | Loss: 0.0164
  Batch [1400/2514] | Loss: 0.0165
  Batch [1450/2514] | Loss: 0.0164
  Batch [1500/2514] | Loss: 0.0163
  Batch [1550/2514] | Loss: 0.0164
  Batch [1600/2514] | Loss: 0.0164
  Batch [1650/2514] | Loss: 0.0164
  Batch [1700/2514] | Loss: 0.0164
  Batch [1750/2514] | Loss: 0.0165
  Batch [1800/2514] | Loss: 0.0166
  Batch [1850/2514] | Loss: 0.0165
  Batch [1900/2514] | Loss: 0.0165
  Batch [1950/2514] | Loss: 0.0164
  Batch [2000/2514] | Loss: 0.0163
  Batch [2050/2514] | Loss: 0.0163
  Batch [2100/2514] | Loss: 0.0162
  Batch [2150/2514] | Loss: 0.0161
  Batch [2200/2514] | Loss: 0.0161
  Batch [2250/2514] | Loss: 0.0162
  Batch [2300/2514] | Loss: 0.0161
  Batch [2350/2514] | Loss: 0.0161
  Batch [2400/2514] | Loss: 0.0160
  Batch [2450/2514] | Loss: 0.0160
  Batch [2500/2514] | Loss: 0.0160

Train Results:
  Loss: 0.0160 | Dice: 0.6087 | Dice_pos: 0.4366 | Dice_neg: 0.8030 | IoU: 0.3356
  Per-Class Metrics:
    Class 1: Dice=0.9295, IoU=0.9295, Prec=1.0000, Recall=0.9295, ClsAcc=0.9295, ClsF1=0.7442
    Class 2: Dice=0.9804, IoU=0.9804, Prec=1.0000, Recall=0.9804, ClsAcc=0.9804, ClsF1=0.9240
    Class 3: Dice=0.6744, IoU=0.6273, Prec=0.7997, Recall=0.7918, ClsAcc=0.8288, ClsF1=0.7584
    Class 4: Dice=0.9233, IoU=0.9167, Prec=0.9524, Recall=0.9599, ClsAcc=0.9480, ClsF1=0.8252
  Time: 414.4s

================================================================================
Fold 1 | Epoch 5/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0267
  Batch [100/629] | Loss: 0.0249
  Batch [150/629] | Loss: 0.0252
  Batch [200/629] | Loss: 0.0249
  Batch [250/629] | Loss: 0.0255
  Batch [300/629] | Loss: 0.0260
  Batch [350/629] | Loss: 0.0258
  Batch [400/629] | Loss: 0.0252
  Batch [450/629] | Loss: 0.0255
  Batch [500/629] | Loss: 0.0262
  Batch [550/629] | Loss: 0.0265
  Batch [600/629] | Loss: 0.0263

Validation Results:
  Loss: 0.0263 | Dice: 0.4997 | Dice_pos: 0.3376 | Dice_neg: 0.6831 | IoU: 0.2502
  Per-Class Metrics:
    Class 1: Dice=0.9253, IoU=0.9253, Prec=1.0000, Recall=0.9253, ClsAcc=0.9253, ClsF1=0.7361
    Class 2: Dice=0.9801, IoU=0.9801, Prec=1.0000, Recall=0.9801, ClsAcc=0.9801, ClsF1=0.9237
    Class 3: Dice=0.6603, IoU=0.6174, Prec=0.8882, Recall=0.7061, ClsAcc=0.8303, ClsF1=0.7398
    Class 4: Dice=0.7951, IoU=0.7872, Prec=0.7921, Recall=0.9913, ClsAcc=0.8164, ClsF1=0.5008
  Time: 97.2s
  Saved checkpoint: outputs_20260112_044318/fold_1/checkpoint_epoch_5.pth

  Current LR: 5.00e-04 | Best Dice: 0.6063 | Best Loss: 0.0164

================================================================================
Fold 1 | Epoch 6/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0147
  Batch [100/2514] | Loss: 0.0153
  Batch [150/2514] | Loss: 0.0155
  Batch [200/2514] | Loss: 0.0154
  Batch [250/2514] | Loss: 0.0150
  Batch [300/2514] | Loss: 0.0143
  Batch [350/2514] | Loss: 0.0149
  Batch [400/2514] | Loss: 0.0149
  Batch [450/2514] | Loss: 0.0154
  Batch [500/2514] | Loss: 0.0151
  Batch [550/2514] | Loss: 0.0154
  Batch [600/2514] | Loss: 0.0157
  Batch [650/2514] | Loss: 0.0154
  Batch [700/2514] | Loss: 0.0154
  Batch [750/2514] | Loss: 0.0154
  Batch [800/2514] | Loss: 0.0155
  Batch [850/2514] | Loss: 0.0151
  Batch [900/2514] | Loss: 0.0151
  Batch [950/2514] | Loss: 0.0150
  Batch [1000/2514] | Loss: 0.0150
  Batch [1050/2514] | Loss: 0.0152
  Batch [1100/2514] | Loss: 0.0151
  Batch [1150/2514] | Loss: 0.0151
  Batch [1200/2514] | Loss: 0.0151
  Batch [1250/2514] | Loss: 0.0153
  Batch [1300/2514] | Loss: 0.0153
  Batch [1350/2514] | Loss: 0.0151
  Batch [1400/2514] | Loss: 0.0150
  Batch [1450/2514] | Loss: 0.0151
  Batch [1500/2514] | Loss: 0.0150
  Batch [1550/2514] | Loss: 0.0149
  Batch [1600/2514] | Loss: 0.0151
  Batch [1650/2514] | Loss: 0.0153
  Batch [1700/2514] | Loss: 0.0153
  Batch [1750/2514] | Loss: 0.0152
  Batch [1800/2514] | Loss: 0.0152
  Batch [1850/2514] | Loss: 0.0152
  Batch [1900/2514] | Loss: 0.0152
  Batch [1950/2514] | Loss: 0.0152
  Batch [2000/2514] | Loss: 0.0152
  Batch [2050/2514] | Loss: 0.0152
  Batch [2100/2514] | Loss: 0.0152
  Batch [2150/2514] | Loss: 0.0152
  Batch [2200/2514] | Loss: 0.0151
  Batch [2250/2514] | Loss: 0.0150
  Batch [2300/2514] | Loss: 0.0150
  Batch [2350/2514] | Loss: 0.0150
  Batch [2400/2514] | Loss: 0.0150
  Batch [2450/2514] | Loss: 0.0150
  Batch [2500/2514] | Loss: 0.0151

Train Results:
  Loss: 0.0151 | Dice: 0.6220 | Dice_pos: 0.4480 | Dice_neg: 0.8185 | IoU: 0.3509
  Per-Class Metrics:
    Class 1: Dice=0.9295, IoU=0.9295, Prec=1.0000, Recall=0.9295, ClsAcc=0.9295, ClsF1=0.7474
    Class 2: Dice=0.9804, IoU=0.9804, Prec=1.0000, Recall=0.9804, ClsAcc=0.9804, ClsF1=0.9220
    Class 3: Dice=0.6883, IoU=0.6416, Prec=0.8100, Recall=0.7965, ClsAcc=0.8383, ClsF1=0.7713
    Class 4: Dice=0.9281, IoU=0.9211, Prec=0.9558, Recall=0.9613, ClsAcc=0.9536, ClsF1=0.8480
  Time: 417.5s

================================================================================
Fold 1 | Epoch 6/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0173
  Batch [100/629] | Loss: 0.0156
  Batch [150/629] | Loss: 0.0156
  Batch [200/629] | Loss: 0.0148
  Batch [250/629] | Loss: 0.0156
  Batch [300/629] | Loss: 0.0160
  Batch [350/629] | Loss: 0.0161
  Batch [400/629] | Loss: 0.0160
  Batch [450/629] | Loss: 0.0165
  Batch [500/629] | Loss: 0.0170
  Batch [550/629] | Loss: 0.0170
  Batch [600/629] | Loss: 0.0170

Validation Results:
  Loss: 0.0169 | Dice: 0.5645 | Dice_pos: 0.2227 | Dice_neg: 0.9508 | IoU: 0.1553
  Per-Class Metrics:
    Class 1: Dice=0.9253, IoU=0.9253, Prec=1.0000, Recall=0.9253, ClsAcc=0.9253, ClsF1=0.7361
    Class 2: Dice=0.9801, IoU=0.9801, Prec=1.0000, Recall=0.9801, ClsAcc=0.9801, ClsF1=0.9237
    Class 3: Dice=0.6646, IoU=0.6323, Prec=0.9698, Recall=0.6532, ClsAcc=0.8430, ClsF1=0.7233
    Class 4: Dice=0.9511, IoU=0.9456, Prec=0.9787, Recall=0.9643, ClsAcc=0.9714, ClsF1=0.8988
  Time: 91.6s
  Saved checkpoint: outputs_20260112_044318/fold_1/checkpoint_epoch_6.pth

  Current LR: 5.00e-04 | Best Dice: 0.6063 | Best Loss: 0.0164

================================================================================
Fold 1 | Epoch 7/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0121
  Batch [100/2514] | Loss: 0.0127
  Batch [150/2514] | Loss: 0.0144
  Batch [200/2514] | Loss: 0.0150
  Batch [250/2514] | Loss: 0.0159
  Batch [300/2514] | Loss: 0.0157
  Batch [350/2514] | Loss: 0.0152
  Batch [400/2514] | Loss: 0.0150
  Batch [450/2514] | Loss: 0.0149
  Batch [500/2514] | Loss: 0.0146
  Batch [550/2514] | Loss: 0.0143
  Batch [600/2514] | Loss: 0.0143
  Batch [650/2514] | Loss: 0.0141
  Batch [700/2514] | Loss: 0.0139
  Batch [750/2514] | Loss: 0.0138
  Batch [800/2514] | Loss: 0.0139
  Batch [850/2514] | Loss: 0.0138
  Batch [900/2514] | Loss: 0.0140
  Batch [950/2514] | Loss: 0.0142
  Batch [1000/2514] | Loss: 0.0143
  Batch [1050/2514] | Loss: 0.0143
  Batch [1100/2514] | Loss: 0.0143
  Batch [1150/2514] | Loss: 0.0144
  Batch [1200/2514] | Loss: 0.0144
  Batch [1250/2514] | Loss: 0.0144
  Batch [1300/2514] | Loss: 0.0144
  Batch [1350/2514] | Loss: 0.0144
  Batch [1400/2514] | Loss: 0.0143
  Batch [1450/2514] | Loss: 0.0143
  Batch [1500/2514] | Loss: 0.0143
  Batch [1550/2514] | Loss: 0.0143
  Batch [1600/2514] | Loss: 0.0143
  Batch [1650/2514] | Loss: 0.0143
  Batch [1700/2514] | Loss: 0.0143
  Batch [1750/2514] | Loss: 0.0143
  Batch [1800/2514] | Loss: 0.0143
  Batch [1850/2514] | Loss: 0.0144
  Batch [1900/2514] | Loss: 0.0144
  Batch [1950/2514] | Loss: 0.0144
  Batch [2000/2514] | Loss: 0.0143
  Batch [2050/2514] | Loss: 0.0143
  Batch [2100/2514] | Loss: 0.0141
  Batch [2150/2514] | Loss: 0.0141
  Batch [2200/2514] | Loss: 0.0141
  Batch [2250/2514] | Loss: 0.0141
  Batch [2300/2514] | Loss: 0.0141
  Batch [2350/2514] | Loss: 0.0142
  Batch [2400/2514] | Loss: 0.0142
  Batch [2450/2514] | Loss: 0.0142
  Batch [2500/2514] | Loss: 0.0142

Train Results:
  Loss: 0.0142 | Dice: 0.6446 | Dice_pos: 0.4698 | Dice_neg: 0.8420 | IoU: 0.3690
  Per-Class Metrics:
    Class 1: Dice=0.9295, IoU=0.9295, Prec=1.0000, Recall=0.9295, ClsAcc=0.9295, ClsF1=0.7506
    Class 2: Dice=0.9804, IoU=0.9804, Prec=1.0000, Recall=0.9804, ClsAcc=0.9804, ClsF1=0.9248
    Class 3: Dice=0.7055, IoU=0.6584, Prec=0.8196, Recall=0.8056, ClsAcc=0.8475, ClsF1=0.7802
    Class 4: Dice=0.9358, IoU=0.9283, Prec=0.9581, Recall=0.9663, ClsAcc=0.9585, ClsF1=0.8629
  Time: 411.7s

================================================================================
Fold 1 | Epoch 7/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0185
  Batch [100/629] | Loss: 0.0155
  Batch [150/629] | Loss: 0.0161
  Batch [200/629] | Loss: 0.0149
  Batch [250/629] | Loss: 0.0156
  Batch [300/629] | Loss: 0.0160
  Batch [350/629] | Loss: 0.0160
  Batch [400/629] | Loss: 0.0159
  Batch [450/629] | Loss: 0.0163
  Batch [500/629] | Loss: 0.0168
  Batch [550/629] | Loss: 0.0171
  Batch [600/629] | Loss: 0.0170

Validation Results:
  Loss: 0.0169 | Dice: 0.6029 | Dice_pos: 0.4166 | Dice_neg: 0.8136 | IoU: 0.3269
  Per-Class Metrics:
    Class 1: Dice=0.9253, IoU=0.9253, Prec=1.0000, Recall=0.9253, ClsAcc=0.9253, ClsF1=0.7361
    Class 2: Dice=0.9801, IoU=0.9801, Prec=1.0000, Recall=0.9801, ClsAcc=0.9801, ClsF1=0.9237
    Class 3: Dice=0.7098, IoU=0.6635, Prec=0.8765, Recall=0.7524, ClsAcc=0.8784, ClsF1=0.8145
    Class 4: Dice=0.8668, IoU=0.8598, Prec=0.8749, Recall=0.9799, ClsAcc=0.8851, ClsF1=0.6474
  Time: 94.9s
  Saved checkpoint: outputs_20260112_044318/fold_1/checkpoint_epoch_7.pth

  Current LR: 5.00e-04 | Best Dice: 0.6063 | Best Loss: 0.0164

================================================================================
Fold 1 | Epoch 8/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0158
  Batch [100/2514] | Loss: 0.0151
  Batch [150/2514] | Loss: 0.0152
  Batch [200/2514] | Loss: 0.0149
  Batch [250/2514] | Loss: 0.0146
  Batch [300/2514] | Loss: 0.0147
  Batch [350/2514] | Loss: 0.0140
  Batch [400/2514] | Loss: 0.0137
  Batch [450/2514] | Loss: 0.0134
  Batch [500/2514] | Loss: 0.0133
  Batch [550/2514] | Loss: 0.0131
  Batch [600/2514] | Loss: 0.0132
  Batch [650/2514] | Loss: 0.0135
  Batch [700/2514] | Loss: 0.0135
  Batch [750/2514] | Loss: 0.0135
  Batch [800/2514] | Loss: 0.0137
  Batch [850/2514] | Loss: 0.0138
  Batch [900/2514] | Loss: 0.0139
  Batch [950/2514] | Loss: 0.0140
  Batch [1000/2514] | Loss: 0.0141
  Batch [1050/2514] | Loss: 0.0142
  Batch [1100/2514] | Loss: 0.0141
  Batch [1150/2514] | Loss: 0.0141
  Batch [1200/2514] | Loss: 0.0141
  Batch [1250/2514] | Loss: 0.0142
  Batch [1300/2514] | Loss: 0.0142
  Batch [1350/2514] | Loss: 0.0141
  Batch [1400/2514] | Loss: 0.0142
  Batch [1450/2514] | Loss: 0.0141
  Batch [1500/2514] | Loss: 0.0142
  Batch [1550/2514] | Loss: 0.0142
  Batch [1600/2514] | Loss: 0.0142
  Batch [1650/2514] | Loss: 0.0143
  Batch [1700/2514] | Loss: 0.0142
  Batch [1750/2514] | Loss: 0.0142
  Batch [1800/2514] | Loss: 0.0142
  Batch [1850/2514] | Loss: 0.0142
  Batch [1900/2514] | Loss: 0.0142
  Batch [1950/2514] | Loss: 0.0142
  Batch [2000/2514] | Loss: 0.0142
  Batch [2050/2514] | Loss: 0.0142
  Batch [2100/2514] | Loss: 0.0141
  Batch [2150/2514] | Loss: 0.0141
  Batch [2200/2514] | Loss: 0.0141
  Batch [2250/2514] | Loss: 0.0140
  Batch [2300/2514] | Loss: 0.0140
  Batch [2350/2514] | Loss: 0.0140
  Batch [2400/2514] | Loss: 0.0140
  Batch [2450/2514] | Loss: 0.0140
  Batch [2500/2514] | Loss: 0.0139

Train Results:
  Loss: 0.0139 | Dice: 0.6469 | Dice_pos: 0.4756 | Dice_neg: 0.8403 | IoU: 0.3731
  Per-Class Metrics:
    Class 1: Dice=0.9295, IoU=0.9295, Prec=1.0000, Recall=0.9295, ClsAcc=0.9295, ClsF1=0.7510
    Class 2: Dice=0.9804, IoU=0.9804, Prec=1.0000, Recall=0.9804, ClsAcc=0.9804, ClsF1=0.9240
    Class 3: Dice=0.7086, IoU=0.6615, Prec=0.8215, Recall=0.8079, ClsAcc=0.8505, ClsF1=0.7850
    Class 4: Dice=0.9413, IoU=0.9339, Prec=0.9629, Recall=0.9669, ClsAcc=0.9635, ClsF1=0.8800
  Time: 418.5s

================================================================================
Fold 1 | Epoch 8/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0154
  Batch [100/629] | Loss: 0.0140
  Batch [150/629] | Loss: 0.0144
  Batch [200/629] | Loss: 0.0137
  Batch [250/629] | Loss: 0.0142
  Batch [300/629] | Loss: 0.0147
  Batch [350/629] | Loss: 0.0146
  Batch [400/629] | Loss: 0.0144
  Batch [450/629] | Loss: 0.0148
  Batch [500/629] | Loss: 0.0152
  Batch [550/629] | Loss: 0.0152
  Batch [600/629] | Loss: 0.0151

Validation Results:
  Loss: 0.0151 | Dice: 0.6252 | Dice_pos: 0.4698 | Dice_neg: 0.8008 | IoU: 0.3800
  Per-Class Metrics:
    Class 1: Dice=0.9253, IoU=0.9253, Prec=1.0000, Recall=0.9253, ClsAcc=0.9253, ClsF1=0.7361
    Class 2: Dice=0.9801, IoU=0.9801, Prec=1.0000, Recall=0.9801, ClsAcc=0.9801, ClsF1=0.9237
    Class 3: Dice=0.7371, IoU=0.6913, Prec=0.8544, Recall=0.8032, ClsAcc=0.8724, ClsF1=0.8023
    Class 4: Dice=0.9019, IoU=0.8952, Prec=0.9105, Recall=0.9809, ClsAcc=0.9173, ClsF1=0.7484
  Time: 89.8s
  Saved checkpoint: outputs_20260112_044318/fold_1/checkpoint_epoch_8.pth
  *** New best model saved: outputs_20260112_044318/fold_1/best_model.pth ***

  Current LR: 5.00e-04 | Best Dice: 0.6252 | Best Loss: 0.0151

================================================================================
Fold 1 | Epoch 9/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0142
  Batch [100/2514] | Loss: 0.0137
  Batch [150/2514] | Loss: 0.0126
  Batch [200/2514] | Loss: 0.0128
  Batch [250/2514] | Loss: 0.0132
  Batch [300/2514] | Loss: 0.0131
  Batch [350/2514] | Loss: 0.0132
  Batch [400/2514] | Loss: 0.0133
  Batch [450/2514] | Loss: 0.0135
  Batch [500/2514] | Loss: 0.0131
  Batch [550/2514] | Loss: 0.0127
  Batch [600/2514] | Loss: 0.0129
  Batch [650/2514] | Loss: 0.0132
  Batch [700/2514] | Loss: 0.0135
  Batch [750/2514] | Loss: 0.0134
  Batch [800/2514] | Loss: 0.0133
  Batch [850/2514] | Loss: 0.0135
  Batch [900/2514] | Loss: 0.0134
  Batch [950/2514] | Loss: 0.0132
  Batch [1000/2514] | Loss: 0.0132
  Batch [1050/2514] | Loss: 0.0133
  Batch [1100/2514] | Loss: 0.0131
  Batch [1150/2514] | Loss: 0.0131
  Batch [1200/2514] | Loss: 0.0133
  Batch [1250/2514] | Loss: 0.0132
  Batch [1300/2514] | Loss: 0.0131
  Batch [1350/2514] | Loss: 0.0131
  Batch [1400/2514] | Loss: 0.0130
  Batch [1450/2514] | Loss: 0.0131
  Batch [1500/2514] | Loss: 0.0131
  Batch [1550/2514] | Loss: 0.0133
  Batch [1600/2514] | Loss: 0.0133
  Batch [1650/2514] | Loss: 0.0133
  Batch [1700/2514] | Loss: 0.0133
  Batch [1750/2514] | Loss: 0.0134
  Batch [1800/2514] | Loss: 0.0134
  Batch [1850/2514] | Loss: 0.0134
  Batch [1900/2514] | Loss: 0.0133
  Batch [1950/2514] | Loss: 0.0133
  Batch [2000/2514] | Loss: 0.0133
  Batch [2050/2514] | Loss: 0.0132
  Batch [2100/2514] | Loss: 0.0132
  Batch [2150/2514] | Loss: 0.0132
  Batch [2200/2514] | Loss: 0.0132
  Batch [2250/2514] | Loss: 0.0131
  Batch [2300/2514] | Loss: 0.0131
  Batch [2350/2514] | Loss: 0.0131
  Batch [2400/2514] | Loss: 0.0132
  Batch [2450/2514] | Loss: 0.0132
  Batch [2500/2514] | Loss: 0.0132

Train Results:
  Loss: 0.0132 | Dice: 0.6613 | Dice_pos: 0.4946 | Dice_neg: 0.8496 | IoU: 0.3891
  Per-Class Metrics:
    Class 1: Dice=0.9295, IoU=0.9295, Prec=1.0000, Recall=0.9295, ClsAcc=0.9295, ClsF1=0.7470
    Class 2: Dice=0.9804, IoU=0.9804, Prec=1.0000, Recall=0.9804, ClsAcc=0.9804, ClsF1=0.9236
    Class 3: Dice=0.7250, IoU=0.6769, Prec=0.8292, Recall=0.8153, ClsAcc=0.8664, ClsF1=0.8069
    Class 4: Dice=0.9429, IoU=0.9352, Prec=0.9615, Recall=0.9700, ClsAcc=0.9646, ClsF1=0.8898
  Time: 412.0s

================================================================================
Fold 1 | Epoch 9/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0151
  Batch [100/629] | Loss: 0.0133
  Batch [150/629] | Loss: 0.0134
  Batch [200/629] | Loss: 0.0125
  Batch [250/629] | Loss: 0.0132
  Batch [300/629] | Loss: 0.0134
  Batch [350/629] | Loss: 0.0136
  Batch [400/629] | Loss: 0.0134
  Batch [450/629] | Loss: 0.0138
  Batch [500/629] | Loss: 0.0142
  Batch [550/629] | Loss: 0.0143
  Batch [600/629] | Loss: 0.0144

Validation Results:
  Loss: 0.0143 | Dice: 0.6289 | Dice_pos: 0.4453 | Dice_neg: 0.8364 | IoU: 0.3524
  Per-Class Metrics:
    Class 1: Dice=0.9253, IoU=0.9253, Prec=1.0000, Recall=0.9253, ClsAcc=0.9253, ClsF1=0.7361
    Class 2: Dice=0.9801, IoU=0.9801, Prec=1.0000, Recall=0.9801, ClsAcc=0.9801, ClsF1=0.9237
    Class 3: Dice=0.7100, IoU=0.6626, Prec=0.8630, Recall=0.7723, ClsAcc=0.8565, ClsF1=0.7913
    Class 4: Dice=0.9372, IoU=0.9308, Prec=0.9591, Recall=0.9687, ClsAcc=0.9571, ClsF1=0.8609
  Time: 92.1s
  Saved checkpoint: outputs_20260112_044318/fold_1/checkpoint_epoch_9.pth
  *** New best model saved: outputs_20260112_044318/fold_1/best_model.pth ***

  Current LR: 5.00e-04 | Best Dice: 0.6289 | Best Loss: 0.0143

================================================================================
Fold 1 | Epoch 10/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0107
  Batch [100/2514] | Loss: 0.0120
  Batch [150/2514] | Loss: 0.0116
  Batch [200/2514] | Loss: 0.0116
  Batch [250/2514] | Loss: 0.0132
  Batch [300/2514] | Loss: 0.0136
  Batch [350/2514] | Loss: 0.0132
  Batch [400/2514] | Loss: 0.0134
  Batch [450/2514] | Loss: 0.0135
  Batch [500/2514] | Loss: 0.0139
  Batch [550/2514] | Loss: 0.0137
  Batch [600/2514] | Loss: 0.0137
  Batch [650/2514] | Loss: 0.0138
  Batch [700/2514] | Loss: 0.0141
  Batch [750/2514] | Loss: 0.0139
  Batch [800/2514] | Loss: 0.0139
  Batch [850/2514] | Loss: 0.0137
  Batch [900/2514] | Loss: 0.0135
  Batch [950/2514] | Loss: 0.0135
  Batch [1000/2514] | Loss: 0.0134
  Batch [1050/2514] | Loss: 0.0133
  Batch [1100/2514] | Loss: 0.0132
  Batch [1150/2514] | Loss: 0.0133
  Batch [1200/2514] | Loss: 0.0133
  Batch [1250/2514] | Loss: 0.0133
  Batch [1300/2514] | Loss: 0.0133
  Batch [1350/2514] | Loss: 0.0132
  Batch [1400/2514] | Loss: 0.0134
  Batch [1450/2514] | Loss: 0.0133
  Batch [1500/2514] | Loss: 0.0133
  Batch [1550/2514] | Loss: 0.0133
  Batch [1600/2514] | Loss: 0.0133
  Batch [1650/2514] | Loss: 0.0132
  Batch [1700/2514] | Loss: 0.0132
  Batch [1750/2514] | Loss: 0.0132
  Batch [1800/2514] | Loss: 0.0132
  Batch [1850/2514] | Loss: 0.0131
  Batch [1900/2514] | Loss: 0.0131
  Batch [1950/2514] | Loss: 0.0131
  Batch [2000/2514] | Loss: 0.0131
  Batch [2050/2514] | Loss: 0.0131
  Batch [2100/2514] | Loss: 0.0131
  Batch [2150/2514] | Loss: 0.0132
  Batch [2200/2514] | Loss: 0.0133
  Batch [2250/2514] | Loss: 0.0132
  Batch [2300/2514] | Loss: 0.0131
  Batch [2350/2514] | Loss: 0.0131
  Batch [2400/2514] | Loss: 0.0131
  Batch [2450/2514] | Loss: 0.0130
  Batch [2500/2514] | Loss: 0.0130

Train Results:
  Loss: 0.0130 | Dice: 0.6652 | Dice_pos: 0.4913 | Dice_neg: 0.8615 | IoU: 0.3897
  Per-Class Metrics:
    Class 1: Dice=0.9280, IoU=0.9280, Prec=0.9983, Recall=0.9295, ClsAcc=0.9288, ClsF1=0.7422
    Class 2: Dice=0.9803, IoU=0.9803, Prec=0.9999, Recall=0.9804, ClsAcc=0.9803, ClsF1=0.9232
    Class 3: Dice=0.7321, IoU=0.6850, Prec=0.8391, Recall=0.8151, ClsAcc=0.8676, ClsF1=0.8010
    Class 4: Dice=0.9449, IoU=0.9373, Prec=0.9644, Recall=0.9697, ClsAcc=0.9658, ClsF1=0.8921
  Time: 419.6s

================================================================================
Fold 1 | Epoch 10/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0133
  Batch [100/629] | Loss: 0.0118
  Batch [150/629] | Loss: 0.0121
  Batch [200/629] | Loss: 0.0114
  Batch [250/629] | Loss: 0.0121
  Batch [300/629] | Loss: 0.0123
  Batch [350/629] | Loss: 0.0124
  Batch [400/629] | Loss: 0.0123
  Batch [450/629] | Loss: 0.0126
  Batch [500/629] | Loss: 0.0131
  Batch [550/629] | Loss: 0.0131
  Batch [600/629] | Loss: 0.0131

Validation Results:
  Loss: 0.0130 | Dice: 0.6828 | Dice_pos: 0.4532 | Dice_neg: 0.9424 | IoU: 0.3622
  Per-Class Metrics:
    Class 1: Dice=0.9253, IoU=0.9253, Prec=0.9996, Recall=0.9253, ClsAcc=0.9257, ClsF1=0.7377
    Class 2: Dice=0.9801, IoU=0.9801, Prec=1.0000, Recall=0.9801, ClsAcc=0.9801, ClsF1=0.9237
    Class 3: Dice=0.7659, IoU=0.7190, Prec=0.8996, Recall=0.7904, ClsAcc=0.9086, ClsF1=0.8496
    Class 4: Dice=0.9612, IoU=0.9550, Prec=0.9877, Recall=0.9651, ClsAcc=0.9837, ClsF1=0.9412
  Time: 100.9s
  Saved checkpoint: outputs_20260112_044318/fold_1/checkpoint_epoch_10.pth
  *** New best model saved: outputs_20260112_044318/fold_1/best_model.pth ***

  Current LR: 5.00e-04 | Best Dice: 0.6828 | Best Loss: 0.0130

================================================================================
Fold 1 | Epoch 11/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0131
  Batch [100/2514] | Loss: 0.0135
  Batch [150/2514] | Loss: 0.0133
  Batch [200/2514] | Loss: 0.0137
  Batch [250/2514] | Loss: 0.0129
  Batch [300/2514] | Loss: 0.0124
  Batch [350/2514] | Loss: 0.0125
  Batch [400/2514] | Loss: 0.0126
  Batch [450/2514] | Loss: 0.0126
  Batch [500/2514] | Loss: 0.0126
  Batch [550/2514] | Loss: 0.0128
  Batch [600/2514] | Loss: 0.0127
  Batch [650/2514] | Loss: 0.0128
  Batch [700/2514] | Loss: 0.0127
  Batch [750/2514] | Loss: 0.0126
  Batch [800/2514] | Loss: 0.0125
  Batch [850/2514] | Loss: 0.0125
  Batch [900/2514] | Loss: 0.0126
  Batch [950/2514] | Loss: 0.0126
  Batch [1000/2514] | Loss: 0.0124
  Batch [1050/2514] | Loss: 0.0123
  Batch [1100/2514] | Loss: 0.0123
  Batch [1150/2514] | Loss: 0.0123
  Batch [1200/2514] | Loss: 0.0123
  Batch [1250/2514] | Loss: 0.0122
  Batch [1300/2514] | Loss: 0.0122
  Batch [1350/2514] | Loss: 0.0122
  Batch [1400/2514] | Loss: 0.0122
  Batch [1450/2514] | Loss: 0.0121
  Batch [1500/2514] | Loss: 0.0122
  Batch [1550/2514] | Loss: 0.0122
  Batch [1600/2514] | Loss: 0.0122
  Batch [1650/2514] | Loss: 0.0122
  Batch [1700/2514] | Loss: 0.0123
  Batch [1750/2514] | Loss: 0.0123
  Batch [1800/2514] | Loss: 0.0122
  Batch [1850/2514] | Loss: 0.0123
  Batch [1900/2514] | Loss: 0.0122
  Batch [1950/2514] | Loss: 0.0122
  Batch [2000/2514] | Loss: 0.0122
  Batch [2050/2514] | Loss: 0.0121
  Batch [2100/2514] | Loss: 0.0121
  Batch [2150/2514] | Loss: 0.0121
  Batch [2200/2514] | Loss: 0.0121
  Batch [2250/2514] | Loss: 0.0122
  Batch [2300/2514] | Loss: 0.0121
  Batch [2350/2514] | Loss: 0.0122
  Batch [2400/2514] | Loss: 0.0122
  Batch [2450/2514] | Loss: 0.0122
  Batch [2500/2514] | Loss: 0.0123

Train Results:
  Loss: 0.0123 | Dice: 0.6795 | Dice_pos: 0.5121 | Dice_neg: 0.8685 | IoU: 0.4081
  Per-Class Metrics:
    Class 1: Dice=0.9264, IoU=0.9260, Prec=0.9939, Recall=0.9301, ClsAcc=0.9315, ClsF1=0.7587
    Class 2: Dice=0.9803, IoU=0.9803, Prec=1.0000, Recall=0.9803, ClsAcc=0.9803, ClsF1=0.9228
    Class 3: Dice=0.7423, IoU=0.6944, Prec=0.8398, Recall=0.8237, ClsAcc=0.8770, ClsF1=0.8131
    Class 4: Dice=0.9535, IoU=0.9457, Prec=0.9688, Recall=0.9731, ClsAcc=0.9739, ClsF1=0.9178
  Time: 415.0s

================================================================================
Fold 1 | Epoch 11/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0149
  Batch [100/629] | Loss: 0.0130
  Batch [150/629] | Loss: 0.0130
  Batch [200/629] | Loss: 0.0123
  Batch [250/629] | Loss: 0.0128
  Batch [300/629] | Loss: 0.0132
  Batch [350/629] | Loss: 0.0132
  Batch [400/629] | Loss: 0.0132
  Batch [450/629] | Loss: 0.0136
  Batch [500/629] | Loss: 0.0141
  Batch [550/629] | Loss: 0.0141
  Batch [600/629] | Loss: 0.0142

Validation Results:
  Loss: 0.0142 | Dice: 0.6557 | Dice_pos: 0.4479 | Dice_neg: 0.8907 | IoU: 0.3595
  Per-Class Metrics:
    Class 1: Dice=0.9253, IoU=0.9253, Prec=1.0000, Recall=0.9253, ClsAcc=0.9253, ClsF1=0.7361
    Class 2: Dice=0.9801, IoU=0.9801, Prec=1.0000, Recall=0.9801, ClsAcc=0.9801, ClsF1=0.9237
    Class 3: Dice=0.7349, IoU=0.6896, Prec=0.8676, Recall=0.7929, ClsAcc=0.8708, ClsF1=0.7874
    Class 4: Dice=0.9537, IoU=0.9476, Prec=0.9791, Recall=0.9654, ClsAcc=0.9742, ClsF1=0.9147
  Time: 106.0s
  Saved checkpoint: outputs_20260112_044318/fold_1/checkpoint_epoch_11.pth

  Current LR: 5.00e-04 | Best Dice: 0.6828 | Best Loss: 0.0130

================================================================================
Fold 1 | Epoch 12/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0110
  Batch [100/2514] | Loss: 0.0112
  Batch [150/2514] | Loss: 0.0115
  Batch [200/2514] | Loss: 0.0117
  Batch [250/2514] | Loss: 0.0117
  Batch [300/2514] | Loss: 0.0121
  Batch [350/2514] | Loss: 0.0125
  Batch [400/2514] | Loss: 0.0128
  Batch [450/2514] | Loss: 0.0123
  Batch [500/2514] | Loss: 0.0121
  Batch [550/2514] | Loss: 0.0121
  Batch [600/2514] | Loss: 0.0121
  Batch [650/2514] | Loss: 0.0121
  Batch [700/2514] | Loss: 0.0119
  Batch [750/2514] | Loss: 0.0118
  Batch [800/2514] | Loss: 0.0118
  Batch [850/2514] | Loss: 0.0119
  Batch [900/2514] | Loss: 0.0118
  Batch [950/2514] | Loss: 0.0118
  Batch [1000/2514] | Loss: 0.0119
  Batch [1050/2514] | Loss: 0.0118
  Batch [1100/2514] | Loss: 0.0119
  Batch [1150/2514] | Loss: 0.0118
  Batch [1200/2514] | Loss: 0.0118
  Batch [1250/2514] | Loss: 0.0116
  Batch [1300/2514] | Loss: 0.0119
  Batch [1350/2514] | Loss: 0.0120
  Batch [1400/2514] | Loss: 0.0120
  Batch [1450/2514] | Loss: 0.0119
  Batch [1500/2514] | Loss: 0.0120
  Batch [1550/2514] | Loss: 0.0120
  Batch [1600/2514] | Loss: 0.0120
  Batch [1650/2514] | Loss: 0.0120
  Batch [1700/2514] | Loss: 0.0121
  Batch [1750/2514] | Loss: 0.0121
  Batch [1800/2514] | Loss: 0.0121
  Batch [1850/2514] | Loss: 0.0121
  Batch [1900/2514] | Loss: 0.0121
  Batch [1950/2514] | Loss: 0.0120
  Batch [2000/2514] | Loss: 0.0120
  Batch [2050/2514] | Loss: 0.0121
  Batch [2100/2514] | Loss: 0.0121
  Batch [2150/2514] | Loss: 0.0121
  Batch [2200/2514] | Loss: 0.0120
  Batch [2250/2514] | Loss: 0.0120
  Batch [2300/2514] | Loss: 0.0121
  Batch [2350/2514] | Loss: 0.0120
  Batch [2400/2514] | Loss: 0.0120
  Batch [2450/2514] | Loss: 0.0120
  Batch [2500/2514] | Loss: 0.0120

Train Results:
  Loss: 0.0120 | Dice: 0.6864 | Dice_pos: 0.5231 | Dice_neg: 0.8708 | IoU: 0.4182
  Per-Class Metrics:
    Class 1: Dice=0.9192, IoU=0.9177, Prec=0.9812, Recall=0.9325, ClsAcc=0.9358, ClsF1=0.7796
    Class 2: Dice=0.9804, IoU=0.9804, Prec=1.0000, Recall=0.9804, ClsAcc=0.9804, ClsF1=0.9252
    Class 3: Dice=0.7485, IoU=0.7007, Prec=0.8456, Recall=0.8264, ClsAcc=0.8814, ClsF1=0.8250
    Class 4: Dice=0.9572, IoU=0.9494, Prec=0.9707, Recall=0.9751, ClsAcc=0.9760, ClsF1=0.9257
  Time: 417.4s

================================================================================
Fold 1 | Epoch 12/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0129
  Batch [100/629] | Loss: 0.0114
  Batch [150/629] | Loss: 0.0116
  Batch [200/629] | Loss: 0.0111
  Batch [250/629] | Loss: 0.0119
  Batch [300/629] | Loss: 0.0122
  Batch [350/629] | Loss: 0.0123
  Batch [400/629] | Loss: 0.0122
  Batch [450/629] | Loss: 0.0126
  Batch [500/629] | Loss: 0.0131
  Batch [550/629] | Loss: 0.0130
  Batch [600/629] | Loss: 0.0131

Validation Results:
  Loss: 0.0131 | Dice: 0.6330 | Dice_pos: 0.5491 | Dice_neg: 0.7280 | IoU: 0.4473
  Per-Class Metrics:
    Class 1: Dice=0.9244, IoU=0.9231, Prec=0.9846, Recall=0.9273, ClsAcc=0.9507, ClsF1=0.8325
    Class 2: Dice=0.9801, IoU=0.9801, Prec=1.0000, Recall=0.9801, ClsAcc=0.9801, ClsF1=0.9237
    Class 3: Dice=0.6876, IoU=0.6364, Prec=0.7457, Recall=0.8532, ClsAcc=0.8156, ClsF1=0.7668
    Class 4: Dice=0.9412, IoU=0.9348, Prec=0.9587, Recall=0.9722, ClsAcc=0.9603, ClsF1=0.8638
  Time: 95.0s
  Saved checkpoint: outputs_20260112_044318/fold_1/checkpoint_epoch_12.pth

  Current LR: 5.00e-04 | Best Dice: 0.6828 | Best Loss: 0.0130

================================================================================
Fold 1 | Epoch 13/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0096
  Batch [100/2514] | Loss: 0.0110
  Batch [150/2514] | Loss: 0.0106
  Batch [200/2514] | Loss: 0.0106
  Batch [250/2514] | Loss: 0.0111
  Batch [300/2514] | Loss: 0.0110
  Batch [350/2514] | Loss: 0.0108
  Batch [400/2514] | Loss: 0.0106
  Batch [450/2514] | Loss: 0.0108
  Batch [500/2514] | Loss: 0.0112
  Batch [550/2514] | Loss: 0.0115
  Batch [600/2514] | Loss: 0.0117
  Batch [650/2514] | Loss: 0.0116
  Batch [700/2514] | Loss: 0.0115
  Batch [750/2514] | Loss: 0.0116
  Batch [800/2514] | Loss: 0.0116
  Batch [850/2514] | Loss: 0.0116
  Batch [900/2514] | Loss: 0.0116
  Batch [950/2514] | Loss: 0.0117
  Batch [1000/2514] | Loss: 0.0118
  Batch [1050/2514] | Loss: 0.0119
  Batch [1100/2514] | Loss: 0.0121
  Batch [1150/2514] | Loss: 0.0120
  Batch [1200/2514] | Loss: 0.0120
  Batch [1250/2514] | Loss: 0.0120
  Batch [1300/2514] | Loss: 0.0119
  Batch [1350/2514] | Loss: 0.0119
  Batch [1400/2514] | Loss: 0.0119
  Batch [1450/2514] | Loss: 0.0119
  Batch [1500/2514] | Loss: 0.0119
  Batch [1550/2514] | Loss: 0.0120
  Batch [1600/2514] | Loss: 0.0120
  Batch [1650/2514] | Loss: 0.0120
  Batch [1700/2514] | Loss: 0.0119
  Batch [1750/2514] | Loss: 0.0119
  Batch [1800/2514] | Loss: 0.0119
  Batch [1850/2514] | Loss: 0.0118
  Batch [1900/2514] | Loss: 0.0118
  Batch [1950/2514] | Loss: 0.0118
  Batch [2000/2514] | Loss: 0.0117
  Batch [2050/2514] | Loss: 0.0117
  Batch [2100/2514] | Loss: 0.0117
  Batch [2150/2514] | Loss: 0.0117
  Batch [2200/2514] | Loss: 0.0118
  Batch [2250/2514] | Loss: 0.0118
  Batch [2300/2514] | Loss: 0.0118
  Batch [2350/2514] | Loss: 0.0118
  Batch [2400/2514] | Loss: 0.0117
  Batch [2450/2514] | Loss: 0.0117
  Batch [2500/2514] | Loss: 0.0118

Train Results:
  Loss: 0.0117 | Dice: 0.6963 | Dice_pos: 0.5399 | Dice_neg: 0.8729 | IoU: 0.4279
  Per-Class Metrics:
    Class 1: Dice=0.9114, IoU=0.9078, Prec=0.9645, Recall=0.9372, ClsAcc=0.9392, ClsF1=0.7959
    Class 2: Dice=0.9804, IoU=0.9804, Prec=1.0000, Recall=0.9804, ClsAcc=0.9804, ClsF1=0.9252
    Class 3: Dice=0.7555, IoU=0.7076, Prec=0.8494, Recall=0.8295, ClsAcc=0.8833, ClsF1=0.8242
    Class 4: Dice=0.9564, IoU=0.9488, Prec=0.9708, Recall=0.9746, ClsAcc=0.9740, ClsF1=0.9182
  Time: 424.2s

================================================================================
Fold 1 | Epoch 13/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0134
  Batch [100/629] | Loss: 0.0117
  Batch [150/629] | Loss: 0.0118
  Batch [200/629] | Loss: 0.0109
  Batch [250/629] | Loss: 0.0114
  Batch [300/629] | Loss: 0.0117
  Batch [350/629] | Loss: 0.0117
  Batch [400/629] | Loss: 0.0118
  Batch [450/629] | Loss: 0.0123
  Batch [500/629] | Loss: 0.0128
  Batch [550/629] | Loss: 0.0128
  Batch [600/629] | Loss: 0.0127

Validation Results:
  Loss: 0.0127 | Dice: 0.7066 | Dice_pos: 0.5175 | Dice_neg: 0.9203 | IoU: 0.4133
  Per-Class Metrics:
    Class 1: Dice=0.9232, IoU=0.9171, Prec=0.9703, Recall=0.9428, ClsAcc=0.9563, ClsF1=0.8632
    Class 2: Dice=0.9801, IoU=0.9801, Prec=1.0000, Recall=0.9801, ClsAcc=0.9801, ClsF1=0.9237
    Class 3: Dice=0.7778, IoU=0.7309, Prec=0.9033, Recall=0.8009, ClsAcc=0.9058, ClsF1=0.8415
    Class 4: Dice=0.9545, IoU=0.9483, Prec=0.9699, Recall=0.9750, ClsAcc=0.9702, ClsF1=0.8969
  Time: 99.8s
  Saved checkpoint: outputs_20260112_044318/fold_1/checkpoint_epoch_13.pth
  *** New best model saved: outputs_20260112_044318/fold_1/best_model.pth ***

  Current LR: 5.00e-04 | Best Dice: 0.7066 | Best Loss: 0.0127

================================================================================
Fold 1 | Epoch 14/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0105
  Batch [100/2514] | Loss: 0.0107
  Batch [150/2514] | Loss: 0.0125
  Batch [200/2514] | Loss: 0.0128
  Batch [250/2514] | Loss: 0.0122
  Batch [300/2514] | Loss: 0.0122
  Batch [350/2514] | Loss: 0.0123
  Batch [400/2514] | Loss: 0.0127
  Batch [450/2514] | Loss: 0.0124
  Batch [500/2514] | Loss: 0.0122
  Batch [550/2514] | Loss: 0.0121
  Batch [600/2514] | Loss: 0.0121
  Batch [650/2514] | Loss: 0.0120
  Batch [700/2514] | Loss: 0.0118
  Batch [750/2514] | Loss: 0.0120
  Batch [800/2514] | Loss: 0.0119
  Batch [850/2514] | Loss: 0.0118
  Batch [900/2514] | Loss: 0.0120
  Batch [950/2514] | Loss: 0.0120
  Batch [1000/2514] | Loss: 0.0118
  Batch [1050/2514] | Loss: 0.0117
  Batch [1100/2514] | Loss: 0.0117
  Batch [1150/2514] | Loss: 0.0116
  Batch [1200/2514] | Loss: 0.0116
  Batch [1250/2514] | Loss: 0.0116
  Batch [1300/2514] | Loss: 0.0115
  Batch [1350/2514] | Loss: 0.0115
  Batch [1400/2514] | Loss: 0.0114
  Batch [1450/2514] | Loss: 0.0113
  Batch [1500/2514] | Loss: 0.0113
  Batch [1550/2514] | Loss: 0.0114
  Batch [1600/2514] | Loss: 0.0113
  Batch [1650/2514] | Loss: 0.0113
  Batch [1700/2514] | Loss: 0.0112
  Batch [1750/2514] | Loss: 0.0112
  Batch [1800/2514] | Loss: 0.0113
  Batch [1850/2514] | Loss: 0.0113
  Batch [1900/2514] | Loss: 0.0113
  Batch [1950/2514] | Loss: 0.0113
  Batch [2000/2514] | Loss: 0.0113
  Batch [2050/2514] | Loss: 0.0113
  Batch [2100/2514] | Loss: 0.0113
  Batch [2150/2514] | Loss: 0.0114
  Batch [2200/2514] | Loss: 0.0114
  Batch [2250/2514] | Loss: 0.0114
  Batch [2300/2514] | Loss: 0.0115
  Batch [2350/2514] | Loss: 0.0115
  Batch [2400/2514] | Loss: 0.0115
  Batch [2450/2514] | Loss: 0.0115
  Batch [2500/2514] | Loss: 0.0115

Train Results:
  Loss: 0.0115 | Dice: 0.7007 | Dice_pos: 0.5550 | Dice_neg: 0.8653 | IoU: 0.4435
  Per-Class Metrics:
    Class 1: Dice=0.9097, IoU=0.9047, Prec=0.9569, Recall=0.9416, ClsAcc=0.9390, ClsF1=0.7964
    Class 2: Dice=0.9802, IoU=0.9802, Prec=0.9998, Recall=0.9804, ClsAcc=0.9802, ClsF1=0.9224
    Class 3: Dice=0.7588, IoU=0.7104, Prec=0.8487, Recall=0.8330, ClsAcc=0.8884, ClsF1=0.8336
    Class 4: Dice=0.9556, IoU=0.9476, Prec=0.9691, Recall=0.9751, ClsAcc=0.9746, ClsF1=0.9198
  Time: 435.5s

================================================================================
Fold 1 | Epoch 14/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0134
  Batch [100/629] | Loss: 0.0119
  Batch [150/629] | Loss: 0.0123
  Batch [200/629] | Loss: 0.0115
  Batch [250/629] | Loss: 0.0122
  Batch [300/629] | Loss: 0.0125
  Batch [350/629] | Loss: 0.0126
  Batch [400/629] | Loss: 0.0125
  Batch [450/629] | Loss: 0.0130
  Batch [500/629] | Loss: 0.0135
  Batch [550/629] | Loss: 0.0135
  Batch [600/629] | Loss: 0.0133

Validation Results:
  Loss: 0.0133 | Dice: 0.6720 | Dice_pos: 0.4868 | Dice_neg: 0.8814 | IoU: 0.3821
  Per-Class Metrics:
    Class 1: Dice=0.9286, IoU=0.9271, Prec=0.9977, Recall=0.9286, ClsAcc=0.9436, ClsF1=0.8045
    Class 2: Dice=0.9801, IoU=0.9801, Prec=1.0000, Recall=0.9801, ClsAcc=0.9801, ClsF1=0.9237
    Class 3: Dice=0.7424, IoU=0.6900, Prec=0.8876, Recall=0.7762, ClsAcc=0.8994, ClsF1=0.8498
    Class 4: Dice=0.9378, IoU=0.9313, Prec=0.9460, Recall=0.9824, ClsAcc=0.9519, ClsF1=0.8370
  Time: 98.4s
  Saved checkpoint: outputs_20260112_044318/fold_1/checkpoint_epoch_14.pth

  Current LR: 5.00e-04 | Best Dice: 0.7066 | Best Loss: 0.0127

================================================================================
Fold 1 | Epoch 15/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0093
  Batch [100/2514] | Loss: 0.0098
  Batch [150/2514] | Loss: 0.0105
  Batch [200/2514] | Loss: 0.0108
  Batch [250/2514] | Loss: 0.0106
  Batch [300/2514] | Loss: 0.0106
  Batch [350/2514] | Loss: 0.0110
  Batch [400/2514] | Loss: 0.0110
  Batch [450/2514] | Loss: 0.0115
  Batch [500/2514] | Loss: 0.0116
  Batch [550/2514] | Loss: 0.0115
  Batch [600/2514] | Loss: 0.0118
  Batch [650/2514] | Loss: 0.0116
  Batch [700/2514] | Loss: 0.0115
  Batch [750/2514] | Loss: 0.0115
  Batch [800/2514] | Loss: 0.0114
  Batch [850/2514] | Loss: 0.0114
  Batch [900/2514] | Loss: 0.0113
  Batch [950/2514] | Loss: 0.0112
  Batch [1000/2514] | Loss: 0.0111
  Batch [1050/2514] | Loss: 0.0110
  Batch [1100/2514] | Loss: 0.0110
  Batch [1150/2514] | Loss: 0.0110
  Batch [1200/2514] | Loss: 0.0109
  Batch [1250/2514] | Loss: 0.0109
  Batch [1300/2514] | Loss: 0.0110
  Batch [1350/2514] | Loss: 0.0109
  Batch [1400/2514] | Loss: 0.0110
  Batch [1450/2514] | Loss: 0.0109
  Batch [1500/2514] | Loss: 0.0109
  Batch [1550/2514] | Loss: 0.0110
  Batch [1600/2514] | Loss: 0.0109
  Batch [1650/2514] | Loss: 0.0109
  Batch [1700/2514] | Loss: 0.0109
  Batch [1750/2514] | Loss: 0.0109
  Batch [1800/2514] | Loss: 0.0110
  Batch [1850/2514] | Loss: 0.0110
  Batch [1900/2514] | Loss: 0.0110
  Batch [1950/2514] | Loss: 0.0110
  Batch [2000/2514] | Loss: 0.0110
  Batch [2050/2514] | Loss: 0.0110
  Batch [2100/2514] | Loss: 0.0110
  Batch [2150/2514] | Loss: 0.0110
  Batch [2200/2514] | Loss: 0.0110
  Batch [2250/2514] | Loss: 0.0110
  Batch [2300/2514] | Loss: 0.0111
  Batch [2350/2514] | Loss: 0.0111
  Batch [2400/2514] | Loss: 0.0112
  Batch [2450/2514] | Loss: 0.0111
  Batch [2500/2514] | Loss: 0.0112

Train Results:
  Loss: 0.0112 | Dice: 0.7113 | Dice_pos: 0.5673 | Dice_neg: 0.8740 | IoU: 0.4523
  Per-Class Metrics:
    Class 1: Dice=0.9143, IoU=0.9086, Prec=0.9572, Recall=0.9452, ClsAcc=0.9436, ClsF1=0.8049
    Class 2: Dice=0.9803, IoU=0.9803, Prec=0.9999, Recall=0.9804, ClsAcc=0.9803, ClsF1=0.9228
    Class 3: Dice=0.7700, IoU=0.7214, Prec=0.8568, Recall=0.8376, ClsAcc=0.8971, ClsF1=0.8415
    Class 4: Dice=0.9560, IoU=0.9482, Prec=0.9700, Recall=0.9750, ClsAcc=0.9751, ClsF1=0.9233
  Time: 414.3s

================================================================================
Fold 1 | Epoch 15/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0135
  Batch [100/629] | Loss: 0.0119
  Batch [150/629] | Loss: 0.0119
  Batch [200/629] | Loss: 0.0111
  Batch [250/629] | Loss: 0.0119
  Batch [300/629] | Loss: 0.0122
  Batch [350/629] | Loss: 0.0123
  Batch [400/629] | Loss: 0.0123
  Batch [450/629] | Loss: 0.0129
  Batch [500/629] | Loss: 0.0135
  Batch [550/629] | Loss: 0.0135
  Batch [600/629] | Loss: 0.0135

Validation Results:
  Loss: 0.0134 | Dice: 0.6815 | Dice_pos: 0.5370 | Dice_neg: 0.8449 | IoU: 0.4286
  Per-Class Metrics:
    Class 1: Dice=0.9097, IoU=0.9024, Prec=0.9447, Recall=0.9474, ClsAcc=0.9412, ClsF1=0.8229
    Class 2: Dice=0.9801, IoU=0.9801, Prec=1.0000, Recall=0.9801, ClsAcc=0.9801, ClsF1=0.9237
    Class 3: Dice=0.7363, IoU=0.6862, Prec=0.8275, Recall=0.8246, ClsAcc=0.8748, ClsF1=0.8168
    Class 4: Dice=0.9624, IoU=0.9565, Prec=0.9896, Recall=0.9648, ClsAcc=0.9841, ClsF1=0.9438
  Time: 89.3s
  Saved checkpoint: outputs_20260112_044318/fold_1/checkpoint_epoch_15.pth

  Current LR: 5.00e-04 | Best Dice: 0.7066 | Best Loss: 0.0127

================================================================================
Fold 1 | Epoch 16/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0107
  Batch [100/2514] | Loss: 0.0107
  Batch [150/2514] | Loss: 0.0109
  Batch [200/2514] | Loss: 0.0109
  Batch [250/2514] | Loss: 0.0105
  Batch [300/2514] | Loss: 0.0104
  Batch [350/2514] | Loss: 0.0102
  Batch [400/2514] | Loss: 0.0103
  Batch [450/2514] | Loss: 0.0106
  Batch [500/2514] | Loss: 0.0106
  Batch [550/2514] | Loss: 0.0107
  Batch [600/2514] | Loss: 0.0108
  Batch [650/2514] | Loss: 0.0108
  Batch [700/2514] | Loss: 0.0109
  Batch [750/2514] | Loss: 0.0107
  Batch [800/2514] | Loss: 0.0106
  Batch [850/2514] | Loss: 0.0105
  Batch [900/2514] | Loss: 0.0105
  Batch [950/2514] | Loss: 0.0106
  Batch [1000/2514] | Loss: 0.0105
  Batch [1050/2514] | Loss: 0.0105
  Batch [1100/2514] | Loss: 0.0105
  Batch [1150/2514] | Loss: 0.0105
  Batch [1200/2514] | Loss: 0.0105
  Batch [1250/2514] | Loss: 0.0106
  Batch [1300/2514] | Loss: 0.0106
  Batch [1350/2514] | Loss: 0.0107
  Batch [1400/2514] | Loss: 0.0107
  Batch [1450/2514] | Loss: 0.0106
  Batch [1500/2514] | Loss: 0.0107
  Batch [1550/2514] | Loss: 0.0107
  Batch [1600/2514] | Loss: 0.0107
  Batch [1650/2514] | Loss: 0.0108
  Batch [1700/2514] | Loss: 0.0107
  Batch [1750/2514] | Loss: 0.0108
  Batch [1800/2514] | Loss: 0.0108
  Batch [1850/2514] | Loss: 0.0108
  Batch [1900/2514] | Loss: 0.0108
  Batch [1950/2514] | Loss: 0.0107
  Batch [2000/2514] | Loss: 0.0107
  Batch [2050/2514] | Loss: 0.0107
  Batch [2100/2514] | Loss: 0.0107
  Batch [2150/2514] | Loss: 0.0107
  Batch [2200/2514] | Loss: 0.0107
  Batch [2250/2514] | Loss: 0.0107
  Batch [2300/2514] | Loss: 0.0107
  Batch [2350/2514] | Loss: 0.0107
  Batch [2400/2514] | Loss: 0.0107
  Batch [2450/2514] | Loss: 0.0108
  Batch [2500/2514] | Loss: 0.0108

Train Results:
  Loss: 0.0108 | Dice: 0.7156 | Dice_pos: 0.5783 | Dice_neg: 0.8706 | IoU: 0.4641
  Per-Class Metrics:
    Class 1: Dice=0.9119, IoU=0.9058, Prec=0.9556, Recall=0.9448, ClsAcc=0.9423, ClsF1=0.8042
    Class 2: Dice=0.9803, IoU=0.9803, Prec=0.9999, Recall=0.9804, ClsAcc=0.9803, ClsF1=0.9224
    Class 3: Dice=0.7746, IoU=0.7260, Prec=0.8553, Recall=0.8425, ClsAcc=0.8984, ClsF1=0.8476
    Class 4: Dice=0.9604, IoU=0.9524, Prec=0.9723, Recall=0.9768, ClsAcc=0.9786, ClsF1=0.9337
  Time: 418.2s

================================================================================
Fold 1 | Epoch 16/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0127
  Batch [100/629] | Loss: 0.0113
  Batch [150/629] | Loss: 0.0116
  Batch [200/629] | Loss: 0.0108
  Batch [250/629] | Loss: 0.0114
  Batch [300/629] | Loss: 0.0117
  Batch [350/629] | Loss: 0.0117
  Batch [400/629] | Loss: 0.0117
  Batch [450/629] | Loss: 0.0123
  Batch [500/629] | Loss: 0.0127
  Batch [550/629] | Loss: 0.0127
  Batch [600/629] | Loss: 0.0126

Validation Results:
  Loss: 0.0126 | Dice: 0.6987 | Dice_pos: 0.5259 | Dice_neg: 0.8941 | IoU: 0.4239
  Per-Class Metrics:
    Class 1: Dice=0.9214, IoU=0.9148, Prec=0.9660, Recall=0.9435, ClsAcc=0.9539, ClsF1=0.8557
    Class 2: Dice=0.9801, IoU=0.9801, Prec=1.0000, Recall=0.9801, ClsAcc=0.9801, ClsF1=0.9237
    Class 3: Dice=0.7722, IoU=0.7258, Prec=0.8961, Recall=0.8021, ClsAcc=0.9002, ClsF1=0.8342
    Class 4: Dice=0.9458, IoU=0.9392, Prec=0.9610, Recall=0.9754, ClsAcc=0.9626, ClsF1=0.8718
  Time: 91.6s
  Saved checkpoint: outputs_20260112_044318/fold_1/checkpoint_epoch_16.pth

  Current LR: 5.00e-04 | Best Dice: 0.7066 | Best Loss: 0.0127

================================================================================
Fold 1 | Epoch 17/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0081
  Batch [100/2514] | Loss: 0.0084
  Batch [150/2514] | Loss: 0.0081
  Batch [200/2514] | Loss: 0.0086
  Batch [250/2514] | Loss: 0.0087
  Batch [300/2514] | Loss: 0.0086
  Batch [350/2514] | Loss: 0.0088
  Batch [400/2514] | Loss: 0.0089
  Batch [450/2514] | Loss: 0.0091
  Batch [500/2514] | Loss: 0.0092
  Batch [550/2514] | Loss: 0.0094
  Batch [600/2514] | Loss: 0.0097
  Batch [650/2514] | Loss: 0.0099
  Batch [700/2514] | Loss: 0.0102
  Batch [750/2514] | Loss: 0.0103
  Batch [800/2514] | Loss: 0.0103
  Batch [850/2514] | Loss: 0.0104
  Batch [900/2514] | Loss: 0.0103
  Batch [950/2514] | Loss: 0.0105
  Batch [1000/2514] | Loss: 0.0105
  Batch [1050/2514] | Loss: 0.0105
  Batch [1100/2514] | Loss: 0.0105
  Batch [1150/2514] | Loss: 0.0104
  Batch [1200/2514] | Loss: 0.0105
  Batch [1250/2514] | Loss: 0.0106
  Batch [1300/2514] | Loss: 0.0106
  Batch [1350/2514] | Loss: 0.0106
  Batch [1400/2514] | Loss: 0.0107
  Batch [1450/2514] | Loss: 0.0107
  Batch [1500/2514] | Loss: 0.0107
  Batch [1550/2514] | Loss: 0.0107
  Batch [1600/2514] | Loss: 0.0107
  Batch [1650/2514] | Loss: 0.0106
  Batch [1700/2514] | Loss: 0.0106
  Batch [1750/2514] | Loss: 0.0106
  Batch [1800/2514] | Loss: 0.0107
  Batch [1850/2514] | Loss: 0.0107
  Batch [1900/2514] | Loss: 0.0107
  Batch [1950/2514] | Loss: 0.0106
  Batch [2000/2514] | Loss: 0.0108
  Batch [2050/2514] | Loss: 0.0108
  Batch [2100/2514] | Loss: 0.0109
  Batch [2150/2514] | Loss: 0.0110
  Batch [2200/2514] | Loss: 0.0110
  Batch [2250/2514] | Loss: 0.0110
  Batch [2300/2514] | Loss: 0.0110
  Batch [2350/2514] | Loss: 0.0110
  Batch [2400/2514] | Loss: 0.0109
  Batch [2450/2514] | Loss: 0.0109
  Batch [2500/2514] | Loss: 0.0109

Train Results:
  Loss: 0.0109 | Dice: 0.7146 | Dice_pos: 0.5784 | Dice_neg: 0.8685 | IoU: 0.4639
  Per-Class Metrics:
    Class 1: Dice=0.9136, IoU=0.9073, Prec=0.9549, Recall=0.9472, ClsAcc=0.9425, ClsF1=0.8088
    Class 2: Dice=0.9804, IoU=0.9804, Prec=1.0000, Recall=0.9804, ClsAcc=0.9804, ClsF1=0.9232
    Class 3: Dice=0.7706, IoU=0.7223, Prec=0.8559, Recall=0.8391, ClsAcc=0.8958, ClsF1=0.8408
    Class 4: Dice=0.9616, IoU=0.9536, Prec=0.9731, Recall=0.9774, ClsAcc=0.9794, ClsF1=0.9362
  Time: 413.9s

================================================================================
Fold 1 | Epoch 17/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0131
  Batch [100/629] | Loss: 0.0114
  Batch [150/629] | Loss: 0.0113
  Batch [200/629] | Loss: 0.0108
  Batch [250/629] | Loss: 0.0114
  Batch [300/629] | Loss: 0.0117
  Batch [350/629] | Loss: 0.0119
  Batch [400/629] | Loss: 0.0119
  Batch [450/629] | Loss: 0.0124
  Batch [500/629] | Loss: 0.0129
  Batch [550/629] | Loss: 0.0129
  Batch [600/629] | Loss: 0.0130

Validation Results:
  Loss: 0.0129 | Dice: 0.7079 | Dice_pos: 0.5200 | Dice_neg: 0.9203 | IoU: 0.4067
  Per-Class Metrics:
    Class 1: Dice=0.9021, IoU=0.8943, Prec=0.9339, Recall=0.9529, ClsAcc=0.9324, ClsF1=0.7947
    Class 2: Dice=0.9797, IoU=0.9797, Prec=0.9996, Recall=0.9801, ClsAcc=0.9797, ClsF1=0.9221
    Class 3: Dice=0.7667, IoU=0.7154, Prec=0.9082, Recall=0.7817, ClsAcc=0.9122, ClsF1=0.8614
    Class 4: Dice=0.9676, IoU=0.9617, Prec=0.9939, Recall=0.9662, ClsAcc=0.9873, ClsF1=0.9571
  Time: 139.1s
  Saved checkpoint: outputs_20260112_044318/fold_1/checkpoint_epoch_17.pth
  *** New best model saved: outputs_20260112_044318/fold_1/best_model.pth ***

  Current LR: 5.00e-04 | Best Dice: 0.7079 | Best Loss: 0.0129

================================================================================
Fold 1 | Epoch 18/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0130
  Batch [100/2514] | Loss: 0.0118
  Batch [150/2514] | Loss: 0.0110
  Batch [200/2514] | Loss: 0.0101
  Batch [250/2514] | Loss: 0.0104
  Batch [300/2514] | Loss: 0.0103
  Batch [350/2514] | Loss: 0.0102
  Batch [400/2514] | Loss: 0.0104
  Batch [450/2514] | Loss: 0.0107
  Batch [500/2514] | Loss: 0.0107
  Batch [550/2514] | Loss: 0.0106
  Batch [600/2514] | Loss: 0.0104
  Batch [650/2514] | Loss: 0.0103
  Batch [700/2514] | Loss: 0.0105
  Batch [750/2514] | Loss: 0.0107
  Batch [800/2514] | Loss: 0.0106
  Batch [850/2514] | Loss: 0.0105
  Batch [900/2514] | Loss: 0.0104
  Batch [950/2514] | Loss: 0.0104
  Batch [1000/2514] | Loss: 0.0103
  Batch [1050/2514] | Loss: 0.0103
  Batch [1100/2514] | Loss: 0.0106
  Batch [1150/2514] | Loss: 0.0108
  Batch [1200/2514] | Loss: 0.0109
  Batch [1250/2514] | Loss: 0.0109
  Batch [1300/2514] | Loss: 0.0109
  Batch [1350/2514] | Loss: 0.0109
  Batch [1400/2514] | Loss: 0.0108
  Batch [1450/2514] | Loss: 0.0108
  Batch [1500/2514] | Loss: 0.0106
  Batch [1550/2514] | Loss: 0.0107
  Batch [1600/2514] | Loss: 0.0107
  Batch [1650/2514] | Loss: 0.0107
  Batch [1700/2514] | Loss: 0.0107
  Batch [1750/2514] | Loss: 0.0107
  Batch [1800/2514] | Loss: 0.0107
  Batch [1850/2514] | Loss: 0.0107
  Batch [1900/2514] | Loss: 0.0107
  Batch [1950/2514] | Loss: 0.0106
  Batch [2000/2514] | Loss: 0.0106
  Batch [2050/2514] | Loss: 0.0106
  Batch [2100/2514] | Loss: 0.0106
  Batch [2150/2514] | Loss: 0.0106
  Batch [2200/2514] | Loss: 0.0106
  Batch [2250/2514] | Loss: 0.0106
  Batch [2300/2514] | Loss: 0.0105
  Batch [2350/2514] | Loss: 0.0105
  Batch [2400/2514] | Loss: 0.0105
  Batch [2450/2514] | Loss: 0.0105
  Batch [2500/2514] | Loss: 0.0105

Train Results:
  Loss: 0.0105 | Dice: 0.7221 | Dice_pos: 0.5891 | Dice_neg: 0.8723 | IoU: 0.4746
  Per-Class Metrics:
    Class 1: Dice=0.9142, IoU=0.9077, Prec=0.9535, Recall=0.9487, ClsAcc=0.9431, ClsF1=0.8060
    Class 2: Dice=0.9798, IoU=0.9798, Prec=0.9993, Recall=0.9804, ClsAcc=0.9800, ClsF1=0.9228
    Class 3: Dice=0.7775, IoU=0.7289, Prec=0.8563, Recall=0.8456, ClsAcc=0.8995, ClsF1=0.8465
    Class 4: Dice=0.9636, IoU=0.9556, Prec=0.9751, Recall=0.9774, ClsAcc=0.9818, ClsF1=0.9448
  Time: 415.6s

================================================================================
Fold 1 | Epoch 18/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0118
  Batch [100/629] | Loss: 0.0108
  Batch [150/629] | Loss: 0.0110
  Batch [200/629] | Loss: 0.0102
  Batch [250/629] | Loss: 0.0109
  Batch [300/629] | Loss: 0.0111
  Batch [350/629] | Loss: 0.0112
  Batch [400/629] | Loss: 0.0112
  Batch [450/629] | Loss: 0.0117
  Batch [500/629] | Loss: 0.0122
  Batch [550/629] | Loss: 0.0123
  Batch [600/629] | Loss: 0.0123

Validation Results:
  Loss: 0.0122 | Dice: 0.7187 | Dice_pos: 0.5644 | Dice_neg: 0.8932 | IoU: 0.4548
  Per-Class Metrics:
    Class 1: Dice=0.9297, IoU=0.9235, Prec=0.9785, Recall=0.9407, ClsAcc=0.9599, ClsF1=0.8716
    Class 2: Dice=0.9801, IoU=0.9801, Prec=1.0000, Recall=0.9801, ClsAcc=0.9801, ClsF1=0.9237
    Class 3: Dice=0.7667, IoU=0.7159, Prec=0.8608, Recall=0.8252, ClsAcc=0.9006, ClsF1=0.8512
    Class 4: Dice=0.9702, IoU=0.9639, Prec=0.9859, Recall=0.9752, ClsAcc=0.9865, ClsF1=0.9502
  Time: 118.2s
  Saved checkpoint: outputs_20260112_044318/fold_1/checkpoint_epoch_18.pth
  *** New best model saved: outputs_20260112_044318/fold_1/best_model.pth ***

  Current LR: 5.00e-04 | Best Dice: 0.7187 | Best Loss: 0.0122

================================================================================
Fold 1 | Epoch 19/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0094
  Batch [100/2514] | Loss: 0.0090
  Batch [150/2514] | Loss: 0.0094
  Batch [200/2514] | Loss: 0.0095
  Batch [250/2514] | Loss: 0.0097
  Batch [300/2514] | Loss: 0.0097
  Batch [350/2514] | Loss: 0.0097
  Batch [400/2514] | Loss: 0.0099
  Batch [450/2514] | Loss: 0.0101
  Batch [500/2514] | Loss: 0.0101
  Batch [550/2514] | Loss: 0.0101
  Batch [600/2514] | Loss: 0.0100
  Batch [650/2514] | Loss: 0.0099
  Batch [700/2514] | Loss: 0.0099
  Batch [750/2514] | Loss: 0.0099
  Batch [800/2514] | Loss: 0.0099
  Batch [850/2514] | Loss: 0.0100
  Batch [900/2514] | Loss: 0.0100
  Batch [950/2514] | Loss: 0.0101
  Batch [1000/2514] | Loss: 0.0100
  Batch [1050/2514] | Loss: 0.0099
  Batch [1100/2514] | Loss: 0.0099
  Batch [1150/2514] | Loss: 0.0098
  Batch [1200/2514] | Loss: 0.0098
  Batch [1250/2514] | Loss: 0.0097
  Batch [1300/2514] | Loss: 0.0096
  Batch [1350/2514] | Loss: 0.0096
  Batch [1400/2514] | Loss: 0.0096
  Batch [1450/2514] | Loss: 0.0096
  Batch [1500/2514] | Loss: 0.0096
  Batch [1550/2514] | Loss: 0.0097
  Batch [1600/2514] | Loss: 0.0097
  Batch [1650/2514] | Loss: 0.0097
  Batch [1700/2514] | Loss: 0.0098
  Batch [1750/2514] | Loss: 0.0099
  Batch [1800/2514] | Loss: 0.0099
  Batch [1850/2514] | Loss: 0.0099
  Batch [1900/2514] | Loss: 0.0099
  Batch [1950/2514] | Loss: 0.0099
  Batch [2000/2514] | Loss: 0.0099
  Batch [2050/2514] | Loss: 0.0099
  Batch [2100/2514] | Loss: 0.0099
  Batch [2150/2514] | Loss: 0.0099
  Batch [2200/2514] | Loss: 0.0098
  Batch [2250/2514] | Loss: 0.0098
  Batch [2300/2514] | Loss: 0.0098
  Batch [2350/2514] | Loss: 0.0098
  Batch [2400/2514] | Loss: 0.0099
  Batch [2450/2514] | Loss: 0.0099
  Batch [2500/2514] | Loss: 0.0099

Train Results:
  Loss: 0.0099 | Dice: 0.7345 | Dice_pos: 0.5981 | Dice_neg: 0.8886 | IoU: 0.4810
  Per-Class Metrics:
    Class 1: Dice=0.9146, IoU=0.9078, Prec=0.9521, Recall=0.9497, ClsAcc=0.9452, ClsF1=0.8158
    Class 2: Dice=0.9780, IoU=0.9779, Prec=0.9971, Recall=0.9805, ClsAcc=0.9791, ClsF1=0.9203
    Class 3: Dice=0.7871, IoU=0.7387, Prec=0.8652, Recall=0.8476, ClsAcc=0.9074, ClsF1=0.8591
    Class 4: Dice=0.9668, IoU=0.9591, Prec=0.9770, Recall=0.9791, ClsAcc=0.9829, ClsF1=0.9469
  Time: 412.3s

================================================================================
Fold 1 | Epoch 19/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0139
  Batch [100/629] | Loss: 0.0121
  Batch [150/629] | Loss: 0.0121
  Batch [200/629] | Loss: 0.0114
  Batch [250/629] | Loss: 0.0120
  Batch [300/629] | Loss: 0.0123
  Batch [350/629] | Loss: 0.0124
  Batch [400/629] | Loss: 0.0123
  Batch [450/629] | Loss: 0.0128
  Batch [500/629] | Loss: 0.0134
  Batch [550/629] | Loss: 0.0135
  Batch [600/629] | Loss: 0.0133

Validation Results:
  Loss: 0.0133 | Dice: 0.7094 | Dice_pos: 0.5385 | Dice_neg: 0.9025 | IoU: 0.4319
  Per-Class Metrics:
    Class 1: Dice=0.9158, IoU=0.9080, Prec=0.9534, Recall=0.9478, ClsAcc=0.9483, ClsF1=0.8414
    Class 2: Dice=0.9801, IoU=0.9801, Prec=1.0000, Recall=0.9801, ClsAcc=0.9801, ClsF1=0.9237
    Class 3: Dice=0.7741, IoU=0.7251, Prec=0.9035, Recall=0.7946, ClsAcc=0.9145, ClsF1=0.8617
    Class 4: Dice=0.9408, IoU=0.9346, Prec=0.9548, Recall=0.9770, ClsAcc=0.9559, ClsF1=0.8566
  Time: 121.7s
  Saved checkpoint: outputs_20260112_044318/fold_1/checkpoint_epoch_19.pth

  Current LR: 5.00e-04 | Best Dice: 0.7187 | Best Loss: 0.0122

================================================================================
Fold 1 | Epoch 20/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0086
  Batch [100/2514] | Loss: 0.0101
  Batch [150/2514] | Loss: 0.0097
  Batch [200/2514] | Loss: 0.0095
  Batch [250/2514] | Loss: 0.0091
  Batch [300/2514] | Loss: 0.0091
  Batch [350/2514] | Loss: 0.0095
  Batch [400/2514] | Loss: 0.0094
  Batch [450/2514] | Loss: 0.0092
  Batch [500/2514] | Loss: 0.0091
  Batch [550/2514] | Loss: 0.0090
  Batch [600/2514] | Loss: 0.0090
  Batch [650/2514] | Loss: 0.0088
  Batch [700/2514] | Loss: 0.0089
  Batch [750/2514] | Loss: 0.0088
  Batch [800/2514] | Loss: 0.0089
  Batch [850/2514] | Loss: 0.0088
  Batch [900/2514] | Loss: 0.0089
  Batch [950/2514] | Loss: 0.0091
  Batch [1000/2514] | Loss: 0.0091
  Batch [1050/2514] | Loss: 0.0092
  Batch [1100/2514] | Loss: 0.0095
  Batch [1150/2514] | Loss: 0.0098
  Batch [1200/2514] | Loss: 0.0099
  Batch [1250/2514] | Loss: 0.0099
  Batch [1300/2514] | Loss: 0.0099
  Batch [1350/2514] | Loss: 0.0098
  Batch [1400/2514] | Loss: 0.0098
  Batch [1450/2514] | Loss: 0.0098
  Batch [1500/2514] | Loss: 0.0099
  Batch [1550/2514] | Loss: 0.0099
  Batch [1600/2514] | Loss: 0.0099
  Batch [1650/2514] | Loss: 0.0100
  Batch [1700/2514] | Loss: 0.0100
  Batch [1750/2514] | Loss: 0.0100
  Batch [1800/2514] | Loss: 0.0100
  Batch [1850/2514] | Loss: 0.0100
  Batch [1900/2514] | Loss: 0.0099
  Batch [1950/2514] | Loss: 0.0100
  Batch [2000/2514] | Loss: 0.0099
  Batch [2050/2514] | Loss: 0.0099
  Batch [2100/2514] | Loss: 0.0099
  Batch [2150/2514] | Loss: 0.0099
  Batch [2200/2514] | Loss: 0.0099
  Batch [2250/2514] | Loss: 0.0099
  Batch [2300/2514] | Loss: 0.0099
  Batch [2350/2514] | Loss: 0.0099
  Batch [2400/2514] | Loss: 0.0100
  Batch [2450/2514] | Loss: 0.0099
  Batch [2500/2514] | Loss: 0.0099

Train Results:
  Loss: 0.0099 | Dice: 0.7347 | Dice_pos: 0.6045 | Dice_neg: 0.8816 | IoU: 0.4901
  Per-Class Metrics:
    Class 1: Dice=0.9173, IoU=0.9104, Prec=0.9558, Recall=0.9494, ClsAcc=0.9467, ClsF1=0.8194
    Class 2: Dice=0.9781, IoU=0.9776, Prec=0.9954, Recall=0.9815, ClsAcc=0.9808, ClsF1=0.9265
    Class 3: Dice=0.7854, IoU=0.7368, Prec=0.8613, Recall=0.8495, ClsAcc=0.9045, ClsF1=0.8602
    Class 4: Dice=0.9667, IoU=0.9588, Prec=0.9766, Recall=0.9791, ClsAcc=0.9833, ClsF1=0.9487
  Time: 416.9s

================================================================================
Fold 1 | Epoch 20/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0124
  Batch [100/629] | Loss: 0.0111
  Batch [150/629] | Loss: 0.0114
  Batch [200/629] | Loss: 0.0106
  Batch [250/629] | Loss: 0.0115
  Batch [300/629] | Loss: 0.0118
  Batch [350/629] | Loss: 0.0119
  Batch [400/629] | Loss: 0.0119
  Batch [450/629] | Loss: 0.0126
  Batch [500/629] | Loss: 0.0131
  Batch [550/629] | Loss: 0.0132
  Batch [600/629] | Loss: 0.0131

Validation Results:
  Loss: 0.0132 | Dice: 0.7170 | Dice_pos: 0.5634 | Dice_neg: 0.8907 | IoU: 0.4553
  Per-Class Metrics:
    Class 1: Dice=0.8971, IoU=0.8878, Prec=0.9179, Recall=0.9607, ClsAcc=0.9269, ClsF1=0.7802
    Class 2: Dice=0.9786, IoU=0.9779, Prec=0.9953, Recall=0.9815, ClsAcc=0.9849, ClsF1=0.9438
    Class 3: Dice=0.7809, IoU=0.7333, Prec=0.8950, Recall=0.8120, ClsAcc=0.9066, ClsF1=0.8550
    Class 4: Dice=0.9684, IoU=0.9621, Prec=0.9882, Recall=0.9714, ClsAcc=0.9857, ClsF1=0.9491
  Time: 102.2s
  Saved checkpoint: outputs_20260112_044318/fold_1/checkpoint_epoch_20.pth

  Current LR: 5.00e-04 | Best Dice: 0.7187 | Best Loss: 0.0122

================================================================================
Fold 1 | Epoch 21/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0088
  Batch [100/2514] | Loss: 0.0095
  Batch [150/2514] | Loss: 0.0097
  Batch [200/2514] | Loss: 0.0095
  Batch [250/2514] | Loss: 0.0093
  Batch [300/2514] | Loss: 0.0094
  Batch [350/2514] | Loss: 0.0094
  Batch [400/2514] | Loss: 0.0097
  Batch [450/2514] | Loss: 0.0096
  Batch [500/2514] | Loss: 0.0095
  Batch [550/2514] | Loss: 0.0096
  Batch [600/2514] | Loss: 0.0095
  Batch [650/2514] | Loss: 0.0094
  Batch [700/2514] | Loss: 0.0093
  Batch [750/2514] | Loss: 0.0094
  Batch [800/2514] | Loss: 0.0093
  Batch [850/2514] | Loss: 0.0093
  Batch [900/2514] | Loss: 0.0095
  Batch [950/2514] | Loss: 0.0096
  Batch [1000/2514] | Loss: 0.0095
  Batch [1050/2514] | Loss: 0.0095
  Batch [1100/2514] | Loss: 0.0094
  Batch [1150/2514] | Loss: 0.0093
  Batch [1200/2514] | Loss: 0.0093
  Batch [1250/2514] | Loss: 0.0093
  Batch [1300/2514] | Loss: 0.0094
  Batch [1350/2514] | Loss: 0.0094
  Batch [1400/2514] | Loss: 0.0094
  Batch [1450/2514] | Loss: 0.0094
  Batch [1500/2514] | Loss: 0.0093
  Batch [1550/2514] | Loss: 0.0094
  Batch [1600/2514] | Loss: 0.0094
  Batch [1650/2514] | Loss: 0.0094
  Batch [1700/2514] | Loss: 0.0094
  Batch [1750/2514] | Loss: 0.0093
  Batch [1800/2514] | Loss: 0.0094
  Batch [1850/2514] | Loss: 0.0094
  Batch [1900/2514] | Loss: 0.0094
  Batch [1950/2514] | Loss: 0.0094
  Batch [2000/2514] | Loss: 0.0094
  Batch [2050/2514] | Loss: 0.0094
  Batch [2100/2514] | Loss: 0.0094
  Batch [2150/2514] | Loss: 0.0094
  Batch [2200/2514] | Loss: 0.0094
  Batch [2250/2514] | Loss: 0.0095
  Batch [2300/2514] | Loss: 0.0095
  Batch [2350/2514] | Loss: 0.0095
  Batch [2400/2514] | Loss: 0.0096
  Batch [2450/2514] | Loss: 0.0096
  Batch [2500/2514] | Loss: 0.0096

Train Results:
  Loss: 0.0096 | Dice: 0.7354 | Dice_pos: 0.6109 | Dice_neg: 0.8759 | IoU: 0.4942
  Per-Class Metrics:
    Class 1: Dice=0.9182, IoU=0.9111, Prec=0.9540, Recall=0.9516, ClsAcc=0.9464, ClsF1=0.8243
    Class 2: Dice=0.9776, IoU=0.9769, Prec=0.9936, Recall=0.9822, ClsAcc=0.9824, ClsF1=0.9340
    Class 3: Dice=0.7892, IoU=0.7406, Prec=0.8618, Recall=0.8527, ClsAcc=0.9077, ClsF1=0.8602
    Class 4: Dice=0.9648, IoU=0.9569, Prec=0.9750, Recall=0.9789, ClsAcc=0.9815, ClsF1=0.9439
  Time: 413.3s

================================================================================
Fold 1 | Epoch 21/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0129
  Batch [100/629] | Loss: 0.0119
  Batch [150/629] | Loss: 0.0120
  Batch [200/629] | Loss: 0.0111
  Batch [250/629] | Loss: 0.0117
  Batch [300/629] | Loss: 0.0120
  Batch [350/629] | Loss: 0.0120
  Batch [400/629] | Loss: 0.0121
  Batch [450/629] | Loss: 0.0126
  Batch [500/629] | Loss: 0.0131
  Batch [550/629] | Loss: 0.0132
  Batch [600/629] | Loss: 0.0132

Validation Results:
  Loss: 0.0132 | Dice: 0.6945 | Dice_pos: 0.5495 | Dice_neg: 0.8585 | IoU: 0.4354
  Per-Class Metrics:
    Class 1: Dice=0.9017, IoU=0.8938, Prec=0.9379, Recall=0.9489, ClsAcc=0.9316, ClsF1=0.7919
    Class 2: Dice=0.9791, IoU=0.9789, Prec=0.9983, Recall=0.9805, ClsAcc=0.9829, ClsF1=0.9343
    Class 3: Dice=0.7598, IoU=0.7096, Prec=0.8822, Recall=0.8005, ClsAcc=0.9038, ClsF1=0.8488
    Class 4: Dice=0.9596, IoU=0.9531, Prec=0.9725, Recall=0.9769, ClsAcc=0.9758, ClsF1=0.9163
  Time: 127.9s
  Saved checkpoint: outputs_20260112_044318/fold_1/checkpoint_epoch_21.pth

  Current LR: 5.00e-04 | Best Dice: 0.7187 | Best Loss: 0.0122

================================================================================
Fold 1 | Epoch 22/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0101
  Batch [100/2514] | Loss: 0.0091
  Batch [150/2514] | Loss: 0.0090
  Batch [200/2514] | Loss: 0.0088
  Batch [250/2514] | Loss: 0.0091
  Batch [300/2514] | Loss: 0.0088
  Batch [350/2514] | Loss: 0.0089
  Batch [400/2514] | Loss: 0.0088
  Batch [450/2514] | Loss: 0.0087
  Batch [500/2514] | Loss: 0.0088
  Batch [550/2514] | Loss: 0.0089
  Batch [600/2514] | Loss: 0.0090
  Batch [650/2514] | Loss: 0.0089
  Batch [700/2514] | Loss: 0.0088
  Batch [750/2514] | Loss: 0.0089
  Batch [800/2514] | Loss: 0.0089
  Batch [850/2514] | Loss: 0.0091
  Batch [900/2514] | Loss: 0.0090
  Batch [950/2514] | Loss: 0.0091
  Batch [1000/2514] | Loss: 0.0091
  Batch [1050/2514] | Loss: 0.0093
  Batch [1100/2514] | Loss: 0.0092
  Batch [1150/2514] | Loss: 0.0092
  Batch [1200/2514] | Loss: 0.0092
  Batch [1250/2514] | Loss: 0.0093
  Batch [1300/2514] | Loss: 0.0093
  Batch [1350/2514] | Loss: 0.0092
  Batch [1400/2514] | Loss: 0.0092
  Batch [1450/2514] | Loss: 0.0093
  Batch [1500/2514] | Loss: 0.0094
  Batch [1550/2514] | Loss: 0.0094
  Batch [1600/2514] | Loss: 0.0094
  Batch [1650/2514] | Loss: 0.0094
  Batch [1700/2514] | Loss: 0.0095
  Batch [1750/2514] | Loss: 0.0095
  Batch [1800/2514] | Loss: 0.0095
  Batch [1850/2514] | Loss: 0.0095
  Batch [1900/2514] | Loss: 0.0095
  Batch [1950/2514] | Loss: 0.0095
  Batch [2000/2514] | Loss: 0.0095
  Batch [2050/2514] | Loss: 0.0094
  Batch [2100/2514] | Loss: 0.0094
  Batch [2150/2514] | Loss: 0.0094
  Batch [2200/2514] | Loss: 0.0093
  Batch [2250/2514] | Loss: 0.0093
  Batch [2300/2514] | Loss: 0.0093
  Batch [2350/2514] | Loss: 0.0093
  Batch [2400/2514] | Loss: 0.0093
  Batch [2450/2514] | Loss: 0.0093
  Batch [2500/2514] | Loss: 0.0093

Train Results:
  Loss: 0.0093 | Dice: 0.7472 | Dice_pos: 0.6234 | Dice_neg: 0.8869 | IoU: 0.5035
  Per-Class Metrics:
    Class 1: Dice=0.9233, IoU=0.9158, Prec=0.9572, Recall=0.9525, ClsAcc=0.9527, ClsF1=0.8377
    Class 2: Dice=0.9757, IoU=0.9748, Prec=0.9912, Recall=0.9826, ClsAcc=0.9809, ClsF1=0.9279
    Class 3: Dice=0.7979, IoU=0.7492, Prec=0.8678, Recall=0.8557, ClsAcc=0.9139, ClsF1=0.8723
    Class 4: Dice=0.9689, IoU=0.9611, Prec=0.9779, Recall=0.9804, ClsAcc=0.9847, ClsF1=0.9537
  Time: 409.3s

================================================================================
Fold 1 | Epoch 22/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0134
  Batch [100/629] | Loss: 0.0118
  Batch [150/629] | Loss: 0.0120
  Batch [200/629] | Loss: 0.0112
  Batch [250/629] | Loss: 0.0120
  Batch [300/629] | Loss: 0.0124
  Batch [350/629] | Loss: 0.0124
  Batch [400/629] | Loss: 0.0124
  Batch [450/629] | Loss: 0.0130
  Batch [500/629] | Loss: 0.0137
  Batch [550/629] | Loss: 0.0137
  Batch [600/629] | Loss: 0.0137

Validation Results:
  Loss: 0.0137 | Dice: 0.7176 | Dice_pos: 0.5495 | Dice_neg: 0.9076 | IoU: 0.4397
  Per-Class Metrics:
    Class 1: Dice=0.9246, IoU=0.9167, Prec=0.9569, Recall=0.9531, ClsAcc=0.9535, ClsF1=0.8560
    Class 2: Dice=0.9785, IoU=0.9783, Prec=0.9964, Recall=0.9807, ClsAcc=0.9813, ClsF1=0.9311
    Class 3: Dice=0.7704, IoU=0.7223, Prec=0.8892, Recall=0.8030, ClsAcc=0.9030, ClsF1=0.8413
    Class 4: Dice=0.9621, IoU=0.9556, Prec=0.9767, Recall=0.9759, ClsAcc=0.9781, ClsF1=0.9271
  Time: 98.1s
  Saved checkpoint: outputs_20260112_044318/fold_1/checkpoint_epoch_22.pth

  Current LR: 5.00e-04 | Best Dice: 0.7187 | Best Loss: 0.0122

================================================================================
Fold 1 | Epoch 23/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0076
  Batch [100/2514] | Loss: 0.0091
  Batch [150/2514] | Loss: 0.0087
  Batch [200/2514] | Loss: 0.0086
  Batch [250/2514] | Loss: 0.0082
  Batch [300/2514] | Loss: 0.0083
  Batch [350/2514] | Loss: 0.0083
  Batch [400/2514] | Loss: 0.0084
  Batch [450/2514] | Loss: 0.0084
  Batch [500/2514] | Loss: 0.0086
  Batch [550/2514] | Loss: 0.0085
  Batch [600/2514] | Loss: 0.0086
  Batch [650/2514] | Loss: 0.0086
  Batch [700/2514] | Loss: 0.0085
  Batch [750/2514] | Loss: 0.0085
  Batch [800/2514] | Loss: 0.0084
  Batch [850/2514] | Loss: 0.0084
  Batch [900/2514] | Loss: 0.0083
  Batch [950/2514] | Loss: 0.0084
  Batch [1000/2514] | Loss: 0.0084
  Batch [1050/2514] | Loss: 0.0084
  Batch [1100/2514] | Loss: 0.0083
  Batch [1150/2514] | Loss: 0.0084
  Batch [1200/2514] | Loss: 0.0084
  Batch [1250/2514] | Loss: 0.0084
  Batch [1300/2514] | Loss: 0.0083
  Batch [1350/2514] | Loss: 0.0084
  Batch [1400/2514] | Loss: 0.0084
  Batch [1450/2514] | Loss: 0.0084
  Batch [1500/2514] | Loss: 0.0084
  Batch [1550/2514] | Loss: 0.0084
  Batch [1600/2514] | Loss: 0.0084
  Batch [1650/2514] | Loss: 0.0085
  Batch [1700/2514] | Loss: 0.0084
  Batch [1750/2514] | Loss: 0.0084
  Batch [1800/2514] | Loss: 0.0084
  Batch [1850/2514] | Loss: 0.0083
  Batch [1900/2514] | Loss: 0.0083
  Batch [1950/2514] | Loss: 0.0083
  Batch [2000/2514] | Loss: 0.0083
  Batch [2050/2514] | Loss: 0.0083
  Batch [2100/2514] | Loss: 0.0083
  Batch [2150/2514] | Loss: 0.0082
  Batch [2200/2514] | Loss: 0.0083
  Batch [2250/2514] | Loss: 0.0083
  Batch [2300/2514] | Loss: 0.0083
  Batch [2350/2514] | Loss: 0.0082
  Batch [2400/2514] | Loss: 0.0082
  Batch [2450/2514] | Loss: 0.0082
  Batch [2500/2514] | Loss: 0.0083

Train Results:
  Loss: 0.0083 | Dice: 0.7704 | Dice_pos: 0.6566 | Dice_neg: 0.8990 | IoU: 0.5381
  Per-Class Metrics:
    Class 1: Dice=0.9300, IoU=0.9220, Prec=0.9583, Recall=0.9571, ClsAcc=0.9571, ClsF1=0.8539
    Class 2: Dice=0.9766, IoU=0.9753, Prec=0.9896, Recall=0.9840, ClsAcc=0.9837, ClsF1=0.9374
    Class 3: Dice=0.8139, IoU=0.7659, Prec=0.8742, Recall=0.8672, ClsAcc=0.9228, ClsF1=0.8859
    Class 4: Dice=0.9749, IoU=0.9672, Prec=0.9816, Recall=0.9830, ClsAcc=0.9893, ClsF1=0.9676
  Time: 410.5s

================================================================================
Fold 1 | Epoch 23/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0118
  Batch [100/629] | Loss: 0.0106
  Batch [150/629] | Loss: 0.0108
  Batch [200/629] | Loss: 0.0101
  Batch [250/629] | Loss: 0.0109
  Batch [300/629] | Loss: 0.0110
  Batch [350/629] | Loss: 0.0113
  Batch [400/629] | Loss: 0.0113
  Batch [450/629] | Loss: 0.0119
  Batch [500/629] | Loss: 0.0125
  Batch [550/629] | Loss: 0.0125
  Batch [600/629] | Loss: 0.0125

Validation Results:
  Loss: 0.0125 | Dice: 0.7360 | Dice_pos: 0.5955 | Dice_neg: 0.8949 | IoU: 0.4761
  Per-Class Metrics:
    Class 1: Dice=0.9259, IoU=0.9170, Prec=0.9528, Recall=0.9574, ClsAcc=0.9543, ClsF1=0.8542
    Class 2: Dice=0.9786, IoU=0.9770, Prec=0.9910, Recall=0.9845, ClsAcc=0.9853, ClsF1=0.9428
    Class 3: Dice=0.7812, IoU=0.7309, Prec=0.8904, Recall=0.8137, ClsAcc=0.9114, ClsF1=0.8544
    Class 4: Dice=0.9711, IoU=0.9651, Prec=0.9867, Recall=0.9754, ClsAcc=0.9869, ClsF1=0.9550
  Time: 91.7s
  Saved checkpoint: outputs_20260112_044318/fold_1/checkpoint_epoch_23.pth
  *** New best model saved: outputs_20260112_044318/fold_1/best_model.pth ***

  Current LR: 2.50e-04 | Best Dice: 0.7360 | Best Loss: 0.0125

================================================================================
Fold 1 | Epoch 24/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0063
  Batch [100/2514] | Loss: 0.0069
  Batch [150/2514] | Loss: 0.0069
  Batch [200/2514] | Loss: 0.0071
  Batch [250/2514] | Loss: 0.0075
  Batch [300/2514] | Loss: 0.0076
  Batch [350/2514] | Loss: 0.0077
  Batch [400/2514] | Loss: 0.0077
  Batch [450/2514] | Loss: 0.0075
  Batch [500/2514] | Loss: 0.0076
  Batch [550/2514] | Loss: 0.0075
  Batch [600/2514] | Loss: 0.0075
  Batch [650/2514] | Loss: 0.0075
  Batch [700/2514] | Loss: 0.0074
  Batch [750/2514] | Loss: 0.0076
  Batch [800/2514] | Loss: 0.0075
  Batch [850/2514] | Loss: 0.0075
  Batch [900/2514] | Loss: 0.0075
  Batch [950/2514] | Loss: 0.0076
  Batch [1000/2514] | Loss: 0.0076
  Batch [1050/2514] | Loss: 0.0076
  Batch [1100/2514] | Loss: 0.0076
  Batch [1150/2514] | Loss: 0.0076
  Batch [1200/2514] | Loss: 0.0076
  Batch [1250/2514] | Loss: 0.0077
  Batch [1300/2514] | Loss: 0.0077
  Batch [1350/2514] | Loss: 0.0076
  Batch [1400/2514] | Loss: 0.0077
  Batch [1450/2514] | Loss: 0.0076
  Batch [1500/2514] | Loss: 0.0077
  Batch [1550/2514] | Loss: 0.0077
  Batch [1600/2514] | Loss: 0.0078
  Batch [1650/2514] | Loss: 0.0077
  Batch [1700/2514] | Loss: 0.0078
  Batch [1750/2514] | Loss: 0.0078
  Batch [1800/2514] | Loss: 0.0078
  Batch [1850/2514] | Loss: 0.0078
  Batch [1900/2514] | Loss: 0.0078
  Batch [1950/2514] | Loss: 0.0078
  Batch [2000/2514] | Loss: 0.0078
  Batch [2050/2514] | Loss: 0.0078
  Batch [2100/2514] | Loss: 0.0079
  Batch [2150/2514] | Loss: 0.0078
  Batch [2200/2514] | Loss: 0.0078
  Batch [2250/2514] | Loss: 0.0078
  Batch [2300/2514] | Loss: 0.0078
  Batch [2350/2514] | Loss: 0.0078
  Batch [2400/2514] | Loss: 0.0078
  Batch [2450/2514] | Loss: 0.0078
  Batch [2500/2514] | Loss: 0.0078

Train Results:
  Loss: 0.0078 | Dice: 0.7766 | Dice_pos: 0.6659 | Dice_neg: 0.9015 | IoU: 0.5462
  Per-Class Metrics:
    Class 1: Dice=0.9338, IoU=0.9255, Prec=0.9606, Recall=0.9584, ClsAcc=0.9609, ClsF1=0.8673
    Class 2: Dice=0.9774, IoU=0.9760, Prec=0.9898, Recall=0.9847, ClsAcc=0.9845, ClsF1=0.9391
    Class 3: Dice=0.8178, IoU=0.7697, Prec=0.8772, Recall=0.8694, ClsAcc=0.9252, ClsF1=0.8824
    Class 4: Dice=0.9784, IoU=0.9707, Prec=0.9843, Recall=0.9840, ClsAcc=0.9917, ClsF1=0.9759
  Time: 415.0s

================================================================================
Fold 1 | Epoch 24/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0116
  Batch [100/629] | Loss: 0.0104
  Batch [150/629] | Loss: 0.0107
  Batch [200/629] | Loss: 0.0099
  Batch [250/629] | Loss: 0.0108
  Batch [300/629] | Loss: 0.0109
  Batch [350/629] | Loss: 0.0111
  Batch [400/629] | Loss: 0.0110
  Batch [450/629] | Loss: 0.0117
  Batch [500/629] | Loss: 0.0123
  Batch [550/629] | Loss: 0.0123
  Batch [600/629] | Loss: 0.0123

Validation Results:
  Loss: 0.0122 | Dice: 0.7590 | Dice_pos: 0.6095 | Dice_neg: 0.9280 | IoU: 0.4979
  Per-Class Metrics:
    Class 1: Dice=0.9403, IoU=0.9328, Prec=0.9782, Recall=0.9502, ClsAcc=0.9682, ClsF1=0.8956
    Class 2: Dice=0.9789, IoU=0.9770, Prec=0.9889, Recall=0.9856, ClsAcc=0.9873, ClsF1=0.9518
    Class 3: Dice=0.8009, IoU=0.7518, Prec=0.8799, Recall=0.8455, ClsAcc=0.9217, ClsF1=0.8768
    Class 4: Dice=0.9722, IoU=0.9660, Prec=0.9860, Recall=0.9774, ClsAcc=0.9865, ClsF1=0.9512
  Time: 105.7s
  Saved checkpoint: outputs_20260112_044318/fold_1/checkpoint_epoch_24.pth
  *** New best model saved: outputs_20260112_044318/fold_1/best_model.pth ***

  Current LR: 2.50e-04 | Best Dice: 0.7590 | Best Loss: 0.0122

================================================================================
Fold 1 | Epoch 25/25 | Phase: TRAIN
================================================================================
  Batch [50/2514] | Loss: 0.0070
  Batch [100/2514] | Loss: 0.0076
  Batch [150/2514] | Loss: 0.0080
  Batch [200/2514] | Loss: 0.0081
  Batch [250/2514] | Loss: 0.0081
  Batch [300/2514] | Loss: 0.0079
  Batch [350/2514] | Loss: 0.0077
  Batch [400/2514] | Loss: 0.0076
  Batch [450/2514] | Loss: 0.0075
  Batch [500/2514] | Loss: 0.0075
  Batch [550/2514] | Loss: 0.0075
  Batch [600/2514] | Loss: 0.0074
  Batch [650/2514] | Loss: 0.0074
  Batch [700/2514] | Loss: 0.0073
  Batch [750/2514] | Loss: 0.0073
  Batch [800/2514] | Loss: 0.0073
  Batch [850/2514] | Loss: 0.0073
  Batch [900/2514] | Loss: 0.0073
  Batch [950/2514] | Loss: 0.0074
  Batch [1000/2514] | Loss: 0.0074
  Batch [1050/2514] | Loss: 0.0074
  Batch [1100/2514] | Loss: 0.0073
  Batch [1150/2514] | Loss: 0.0074
  Batch [1200/2514] | Loss: 0.0074
  Batch [1250/2514] | Loss: 0.0074
  Batch [1300/2514] | Loss: 0.0074
  Batch [1350/2514] | Loss: 0.0074
  Batch [1400/2514] | Loss: 0.0074
  Batch [1450/2514] | Loss: 0.0075
  Batch [1500/2514] | Loss: 0.0075
  Batch [1550/2514] | Loss: 0.0075
  Batch [1600/2514] | Loss: 0.0075
  Batch [1650/2514] | Loss: 0.0075
  Batch [1700/2514] | Loss: 0.0075
  Batch [1750/2514] | Loss: 0.0074
  Batch [1800/2514] | Loss: 0.0075
  Batch [1850/2514] | Loss: 0.0075
  Batch [1900/2514] | Loss: 0.0075
  Batch [1950/2514] | Loss: 0.0075
  Batch [2000/2514] | Loss: 0.0075
  Batch [2050/2514] | Loss: 0.0075
  Batch [2100/2514] | Loss: 0.0075
  Batch [2150/2514] | Loss: 0.0075
  Batch [2200/2514] | Loss: 0.0075
  Batch [2250/2514] | Loss: 0.0075
  Batch [2300/2514] | Loss: 0.0075
  Batch [2350/2514] | Loss: 0.0075
  Batch [2400/2514] | Loss: 0.0075
  Batch [2450/2514] | Loss: 0.0075
  Batch [2500/2514] | Loss: 0.0075

Train Results:
  Loss: 0.0075 | Dice: 0.7843 | Dice_pos: 0.6784 | Dice_neg: 0.9039 | IoU: 0.5607
  Per-Class Metrics:
    Class 1: Dice=0.9365, IoU=0.9280, Prec=0.9621, Recall=0.9595, ClsAcc=0.9633, ClsF1=0.8764
    Class 2: Dice=0.9781, IoU=0.9764, Prec=0.9888, Recall=0.9858, ClsAcc=0.9855, ClsF1=0.9452
    Class 3: Dice=0.8250, IoU=0.7767, Prec=0.8775, Recall=0.8753, ClsAcc=0.9300, ClsF1=0.8911
    Class 4: Dice=0.9780, IoU=0.9706, Prec=0.9837, Recall=0.9847, ClsAcc=0.9911, ClsF1=0.9761
  Time: 413.1s

================================================================================
Fold 1 | Epoch 25/25 | Phase: VALIDATION
================================================================================
  Batch [50/629] | Loss: 0.0116
  Batch [100/629] | Loss: 0.0102
  Batch [150/629] | Loss: 0.0105
  Batch [200/629] | Loss: 0.0097
  Batch [250/629] | Loss: 0.0104
  Batch [300/629] | Loss: 0.0106
  Batch [350/629] | Loss: 0.0108
  Batch [400/629] | Loss: 0.0108
  Batch [450/629] | Loss: 0.0114
  Batch [500/629] | Loss: 0.0120
  Batch [550/629] | Loss: 0.0120
  Batch [600/629] | Loss: 0.0120

Validation Results:
  Loss: 0.0121 | Dice: 0.7164 | Dice_pos: 0.6193 | Dice_neg: 0.8263 | IoU: 0.5082
  Per-Class Metrics:
    Class 1: Dice=0.9427, IoU=0.9364, Prec=0.9884, Recall=0.9448, ClsAcc=0.9718, ClsF1=0.9057
    Class 2: Dice=0.9776, IoU=0.9761, Prec=0.9901, Recall=0.9841, ClsAcc=0.9837, ClsF1=0.9380
    Class 3: Dice=0.7677, IoU=0.7173, Prec=0.8267, Recall=0.8605, ClsAcc=0.8875, ClsF1=0.8297
    Class 4: Dice=0.9551, IoU=0.9489, Prec=0.9655, Recall=0.9809, ClsAcc=0.9678, ClsF1=0.8895
  Time: 91.5s
  Saved checkpoint: outputs_20260112_044318/fold_1/checkpoint_epoch_25.pth

  Current LR: 2.50e-04 | Best Dice: 0.7590 | Best Loss: 0.0122
  Saved OOF predictions: outputs_20260112_044318/fold_1/oof_predictions.npy
  Saved training history: outputs_20260112_044318/fold_1/history.csv

################################################################################
# Finished training for Fold 1
# Best Dice: 0.7590 | Best Loss: 0.0122
################################################################################


================================================================================
TRAINING SUMMARY
================================================================================
Fold 1: Best Dice = 0.7590, Best Loss = 0.0122
================================================================================
